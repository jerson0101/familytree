{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/smsm/Desktop/Portafolio%20IA/arbol-genealogico-digital%202/packages/graph-engine/src/types.ts"],"sourcesContent":["/**\n * Graph Engine Types\n * Types for P-Graph genealogical visualization\n */\n\nimport type { Gender } from '@kintree/shared';\n\n// ============ Node Types ============\n\nexport interface GraphNode {\n  id: string;\n  type: 'person' | 'union';\n  x: number;\n  y: number;\n  width: number;\n  height: number;\n  generation: number;\n  data: PersonNodeData | UnionNodeData;\n}\n\nexport interface PersonNodeData {\n  personId: string;\n  firstName: string;\n  lastName: string;\n  gender: Gender;\n  birthDate?: string;\n  birthDateApproximate?: boolean;\n  deathDate?: string;\n  deathDateApproximate?: boolean;\n  photoUrl?: string;\n  isLiving: boolean;\n  medicalConditions?: MedicalCondition[];\n}\n\nexport interface UnionNodeData {\n  unionId: string;\n  partner1Id: string;\n  partner2Id: string;\n  unionType: 'marriage' | 'partnership' | 'divorced' | 'separated' | 'other';\n  startDate?: string;\n  endDate?: string;\n}\n\nexport interface MedicalCondition {\n  id: string;\n  name: string;\n  category: 'cardiovascular' | 'cancer' | 'metabolic' | 'neurological' | 'mental_health' | 'autoimmune' | 'genetic';\n  severity?: 'mild' | 'moderate' | 'severe';\n}\n\n// ============ Edge Types ============\n\nexport interface GraphEdge {\n  id: string;\n  sourceId: string;\n  targetId: string;\n  type: EdgeType;\n  sourceAnchor?: AnchorPoint;\n  targetAnchor?: AnchorPoint;\n  pathData?: string; // SVG path data\n  controlPoints?: Point[];\n}\n\nexport type EdgeType =\n  | 'parent-child'    // From union to child\n  | 'spouse'          // Between person and union\n  | 'sibling';        // Between siblings (usually implicit)\n\nexport type AnchorPoint = 'top' | 'bottom' | 'left' | 'right' | 'center';\n\n// ============ Layout Types ============\n\nexport interface Point {\n  x: number;\n  y: number;\n}\n\nexport interface Bounds {\n  minX: number;\n  minY: number;\n  maxX: number;\n  maxY: number;\n  width: number;\n  height: number;\n}\n\nexport interface LayoutConfig {\n  nodeWidth: number;        // Person node width (default: 180)\n  nodeHeight: number;       // Person node height (default: 100)\n  unionNodeSize: number;    // Union node diameter (default: 24)\n  horizontalSpacing: number; // Between nodes (default: 60)\n  verticalSpacing: number;  // Between generations (default: 120)\n  rootPersonId?: string;    // Optional root to center on\n  maxGenerations?: number;  // Limit generations to display\n  direction: 'TB' | 'BT';   // Top-to-bottom or bottom-to-top\n}\n\nexport interface LayoutResult {\n  nodes: GraphNode[];\n  edges: GraphEdge[];\n  bounds: Bounds;\n  generations: number;\n}\n\n// ============ Graph Data Types ============\n\nexport interface GraphData {\n  persons: GraphPerson[];\n  unions: GraphUnion[];\n  relationships: GraphRelationship[];\n}\n\nexport interface GraphPerson {\n  id: string;\n  firstName: string;\n  lastName: string;\n  gender: Gender;\n  birthDate?: string;\n  birthDateApproximate?: boolean;\n  deathDate?: string;\n  deathDateApproximate?: boolean;\n  photoUrl?: string;\n  isLiving: boolean;\n  medicalConditions?: MedicalCondition[];\n}\n\nexport interface GraphUnion {\n  id: string;\n  partner1Id: string;\n  partner2Id: string;\n  unionType: 'marriage' | 'partnership' | 'divorced' | 'separated' | 'other';\n  startDate?: string;\n  endDate?: string;\n  childrenIds: string[];\n}\n\nexport interface GraphRelationship {\n  id: string;\n  personId: string;\n  relatedPersonId: string;\n  type: 'parent' | 'child' | 'sibling';\n}\n\n// ============ Viewport Types ============\n\nexport interface Viewport {\n  x: number;\n  y: number;\n  scale: number;\n  width: number;\n  height: number;\n}\n\nexport interface ViewportBounds {\n  left: number;\n  top: number;\n  right: number;\n  bottom: number;\n}\n\n// ============ Interaction Types ============\n\nexport interface NodeInteraction {\n  nodeId: string;\n  type: 'click' | 'hover' | 'drag' | 'contextmenu';\n  position: Point;\n  originalEvent?: Event;\n}\n\nexport interface EdgeInteraction {\n  edgeId: string;\n  type: 'click' | 'hover';\n  position: Point;\n  originalEvent?: Event;\n}\n\nexport interface ViewportInteraction {\n  type: 'pan' | 'zoom' | 'pinch';\n  delta: Point;\n  scale?: number;\n  center?: Point;\n}\n\n// ============ Render Options ============\n\nexport interface RenderOptions {\n  showPhotos: boolean;\n  showDates: boolean;\n  showMedicalIcons: boolean;\n  showDeceased: boolean;\n  highlightedNodeId?: string;\n  selectedNodeId?: string;\n  focusedNodeId?: string;\n  animationsEnabled: boolean;\n}\n\n// ============ Genogram Types ============\n\nexport interface GenogramOptions extends RenderOptions {\n  showRelationshipLines: boolean;\n  showMedicalConditions: boolean;\n  conditionFilter?: string[];\n  legendVisible: boolean;\n}\n\nexport interface GenogramSymbol {\n  gender: Gender;\n  isDeceased: boolean;\n  conditions: MedicalCondition[];\n}\n\n// ============ Constants ============\n\nexport const DEFAULT_LAYOUT_CONFIG: LayoutConfig = {\n  nodeWidth: 180,\n  nodeHeight: 100,\n  unionNodeSize: 24,\n  horizontalSpacing: 60,\n  verticalSpacing: 120,\n  direction: 'TB',\n};\n\nexport const NODE_DIMENSIONS = {\n  person: { width: 180, height: 100 },\n  union: { width: 24, height: 24 },\n} as const;\n\nexport const ZOOM_LIMITS = {\n  min: 0.1,\n  max: 3,\n  step: 0.1,\n} as const;\n"],"names":[],"mappings":"AAAA;;;CAGC;;;;;;;;AAkNM,MAAM,wBAAsC;IACjD,WAAW;IACX,YAAY;IACZ,eAAe;IACf,mBAAmB;IACnB,iBAAiB;IACjB,WAAW;AACb;AAEO,MAAM,kBAAkB;IAC7B,QAAQ;QAAE,OAAO;QAAK,QAAQ;IAAI;IAClC,OAAO;QAAE,OAAO;QAAI,QAAQ;IAAG;AACjC;AAEO,MAAM,cAAc;IACzB,KAAK;IACL,KAAK;IACL,MAAM;AACR"}},
    {"offset": {"line": 42, "column": 0}, "map": {"version":3,"sources":["file:///Users/smsm/Desktop/Portafolio%20IA/arbol-genealogico-digital%202/packages/graph-engine/src/core/Graph.ts"],"sourcesContent":["/**\n * Graph Data Structure\n * Core graph operations for genealogical data\n */\n\nimport type {\n  GraphData,\n  GraphPerson,\n  GraphUnion,\n  GraphRelationship,\n  GraphNode,\n  GraphEdge,\n} from '../types';\n\nexport class Graph {\n  private persons: Map<string, GraphPerson> = new Map();\n  private unions: Map<string, GraphUnion> = new Map();\n  private relationships: GraphRelationship[] = [];\n\n  // Adjacency lists\n  private parentMap: Map<string, string[]> = new Map(); // personId -> parentIds\n  private childrenMap: Map<string, string[]> = new Map(); // personId -> childIds\n  private spouseMap: Map<string, string[]> = new Map(); // personId -> spouseIds\n  private unionsByPerson: Map<string, string[]> = new Map(); // personId -> unionIds\n\n  constructor(data?: GraphData) {\n    if (data) {\n      this.loadData(data);\n    }\n  }\n\n  /**\n   * Load graph data from a GraphData object\n   */\n  loadData(data: GraphData): void {\n    this.clear();\n\n    // Load persons\n    for (const person of data.persons) {\n      this.persons.set(person.id, person);\n    }\n\n    // Load unions\n    for (const union of data.unions) {\n      this.unions.set(union.id, union);\n\n      // Build spouse and union maps\n      this.addToMap(this.spouseMap, union.partner1Id, union.partner2Id);\n      this.addToMap(this.spouseMap, union.partner2Id, union.partner1Id);\n      this.addToMap(this.unionsByPerson, union.partner1Id, union.id);\n      this.addToMap(this.unionsByPerson, union.partner2Id, union.id);\n\n      // Build parent-child maps from union children\n      for (const childId of union.childrenIds) {\n        this.addToMap(this.parentMap, childId, union.partner1Id);\n        this.addToMap(this.parentMap, childId, union.partner2Id);\n        this.addToMap(this.childrenMap, union.partner1Id, childId);\n        this.addToMap(this.childrenMap, union.partner2Id, childId);\n      }\n    }\n\n    // Load explicit relationships\n    this.relationships = data.relationships;\n    for (const rel of data.relationships) {\n      if (rel.type === 'parent') {\n        this.addToMap(this.parentMap, rel.personId, rel.relatedPersonId);\n        this.addToMap(this.childrenMap, rel.relatedPersonId, rel.personId);\n      }\n    }\n  }\n\n  /**\n   * Clear all data\n   */\n  clear(): void {\n    this.persons.clear();\n    this.unions.clear();\n    this.relationships = [];\n    this.parentMap.clear();\n    this.childrenMap.clear();\n    this.spouseMap.clear();\n    this.unionsByPerson.clear();\n  }\n\n  // ============ Getters ============\n\n  getPerson(id: string): GraphPerson | undefined {\n    return this.persons.get(id);\n  }\n\n  getUnion(id: string): GraphUnion | undefined {\n    return this.unions.get(id);\n  }\n\n  getAllPersons(): GraphPerson[] {\n    return Array.from(this.persons.values());\n  }\n\n  getAllUnions(): GraphUnion[] {\n    return Array.from(this.unions.values());\n  }\n\n  getPersonCount(): number {\n    return this.persons.size;\n  }\n\n  getUnionCount(): number {\n    return this.unions.size;\n  }\n\n  // ============ Relationship Queries ============\n\n  getParents(personId: string): GraphPerson[] {\n    const parentIds = this.parentMap.get(personId) || [];\n    return parentIds\n      .map((id) => this.persons.get(id))\n      .filter((p): p is GraphPerson => p !== undefined);\n  }\n\n  getChildren(personId: string): GraphPerson[] {\n    const childIds = this.childrenMap.get(personId) || [];\n    return childIds\n      .map((id) => this.persons.get(id))\n      .filter((p): p is GraphPerson => p !== undefined);\n  }\n\n  getSpouses(personId: string): GraphPerson[] {\n    const spouseIds = this.spouseMap.get(personId) || [];\n    return spouseIds\n      .map((id) => this.persons.get(id))\n      .filter((p): p is GraphPerson => p !== undefined);\n  }\n\n  getSiblings(personId: string): GraphPerson[] {\n    const parents = this.getParents(personId);\n    if (parents.length === 0) return [];\n\n    const siblingIds = new Set<string>();\n    for (const parent of parents) {\n      const children = this.getChildren(parent.id);\n      for (const child of children) {\n        if (child.id !== personId) {\n          siblingIds.add(child.id);\n        }\n      }\n    }\n\n    return Array.from(siblingIds)\n      .map((id) => this.persons.get(id))\n      .filter((p): p is GraphPerson => p !== undefined);\n  }\n\n  getUnionsForPerson(personId: string): GraphUnion[] {\n    const unionIds = this.unionsByPerson.get(personId) || [];\n    return unionIds\n      .map((id) => this.unions.get(id))\n      .filter((u): u is GraphUnion => u !== undefined);\n  }\n\n  getChildrenOfUnion(unionId: string): GraphPerson[] {\n    const union = this.unions.get(unionId);\n    if (!union) return [];\n\n    return union.childrenIds\n      .map((id) => this.persons.get(id))\n      .filter((p): p is GraphPerson => p !== undefined);\n  }\n\n  // ============ Generation Calculation ============\n\n  /**\n   * Calculate generation numbers starting from a root person\n   * Generation 0 is the root, positive numbers are ancestors, negative are descendants\n   */\n  calculateGenerations(rootPersonId?: string): Map<string, number> {\n    const generations = new Map<string, number>();\n\n    if (this.persons.size === 0) return generations;\n\n    // If no root specified, find a person with no parents (oldest generation)\n    const root = rootPersonId || this.findOldestGeneration();\n    if (!root) return generations;\n\n    // BFS to assign generations\n    const visited = new Set<string>();\n    const queue: Array<{ id: string; generation: number }> = [\n      { id: root, generation: 0 },\n    ];\n\n    while (queue.length > 0) {\n      const { id, generation } = queue.shift()!;\n\n      if (visited.has(id)) continue;\n      visited.add(id);\n      generations.set(id, generation);\n\n      // Parents are one generation up (positive)\n      const parents = this.parentMap.get(id) || [];\n      for (const parentId of parents) {\n        if (!visited.has(parentId)) {\n          queue.push({ id: parentId, generation: generation + 1 });\n        }\n      }\n\n      // Children are one generation down (negative)\n      const children = this.childrenMap.get(id) || [];\n      for (const childId of children) {\n        if (!visited.has(childId)) {\n          queue.push({ id: childId, generation: generation - 1 });\n        }\n      }\n\n      // Spouses are same generation\n      const spouses = this.spouseMap.get(id) || [];\n      for (const spouseId of spouses) {\n        if (!visited.has(spouseId)) {\n          queue.push({ id: spouseId, generation });\n        }\n      }\n    }\n\n    // Normalize generations so minimum is 0\n    const minGen = Math.min(...Array.from(generations.values()));\n    if (minGen < 0) {\n      for (const [id, gen] of generations) {\n        generations.set(id, gen - minGen);\n      }\n    }\n\n    return generations;\n  }\n\n  /**\n   * Find a person with no parents (oldest generation)\n   */\n  private findOldestGeneration(): string | undefined {\n    for (const person of this.persons.values()) {\n      const parents = this.parentMap.get(person.id);\n      if (!parents || parents.length === 0) {\n        return person.id;\n      }\n    }\n    return this.persons.values().next().value?.id;\n  }\n\n  // ============ Traversal ============\n\n  /**\n   * Breadth-first search from a starting person\n   */\n  *bfs(startId: string): Generator<GraphPerson> {\n    const visited = new Set<string>();\n    const queue: string[] = [startId];\n\n    while (queue.length > 0) {\n      const id = queue.shift()!;\n      if (visited.has(id)) continue;\n\n      const person = this.persons.get(id);\n      if (!person) continue;\n\n      visited.add(id);\n      yield person;\n\n      // Add all connected persons\n      const connected = [\n        ...(this.parentMap.get(id) || []),\n        ...(this.childrenMap.get(id) || []),\n        ...(this.spouseMap.get(id) || []),\n      ];\n\n      for (const connectedId of connected) {\n        if (!visited.has(connectedId)) {\n          queue.push(connectedId);\n        }\n      }\n    }\n  }\n\n  /**\n   * Depth-first search from a starting person\n   */\n  *dfs(startId: string): Generator<GraphPerson> {\n    const visited = new Set<string>();\n    const stack: string[] = [startId];\n\n    while (stack.length > 0) {\n      const id = stack.pop()!;\n      if (visited.has(id)) continue;\n\n      const person = this.persons.get(id);\n      if (!person) continue;\n\n      visited.add(id);\n      yield person;\n\n      // Add all connected persons\n      const connected = [\n        ...(this.parentMap.get(id) || []),\n        ...(this.childrenMap.get(id) || []),\n        ...(this.spouseMap.get(id) || []),\n      ];\n\n      for (const connectedId of connected) {\n        if (!visited.has(connectedId)) {\n          stack.push(connectedId);\n        }\n      }\n    }\n  }\n\n  /**\n   * Get ancestors up to a certain depth\n   */\n  getAncestors(personId: string, maxDepth?: number): GraphPerson[] {\n    const ancestors: GraphPerson[] = [];\n    const visited = new Set<string>();\n    const queue: Array<{ id: string; depth: number }> = [];\n\n    // Start with parents\n    const parents = this.parentMap.get(personId) || [];\n    for (const parentId of parents) {\n      queue.push({ id: parentId, depth: 1 });\n    }\n\n    while (queue.length > 0) {\n      const { id, depth } = queue.shift()!;\n\n      if (visited.has(id)) continue;\n      if (maxDepth !== undefined && depth > maxDepth) continue;\n\n      const person = this.persons.get(id);\n      if (!person) continue;\n\n      visited.add(id);\n      ancestors.push(person);\n\n      // Add parents of this ancestor\n      const ancestorParents = this.parentMap.get(id) || [];\n      for (const parentId of ancestorParents) {\n        if (!visited.has(parentId)) {\n          queue.push({ id: parentId, depth: depth + 1 });\n        }\n      }\n    }\n\n    return ancestors;\n  }\n\n  /**\n   * Get descendants up to a certain depth\n   */\n  getDescendants(personId: string, maxDepth?: number): GraphPerson[] {\n    const descendants: GraphPerson[] = [];\n    const visited = new Set<string>();\n    const queue: Array<{ id: string; depth: number }> = [];\n\n    // Start with children\n    const children = this.childrenMap.get(personId) || [];\n    for (const childId of children) {\n      queue.push({ id: childId, depth: 1 });\n    }\n\n    while (queue.length > 0) {\n      const { id, depth } = queue.shift()!;\n\n      if (visited.has(id)) continue;\n      if (maxDepth !== undefined && depth > maxDepth) continue;\n\n      const person = this.persons.get(id);\n      if (!person) continue;\n\n      visited.add(id);\n      descendants.push(person);\n\n      // Add children of this descendant\n      const descendantChildren = this.childrenMap.get(id) || [];\n      for (const childId of descendantChildren) {\n        if (!visited.has(childId)) {\n          queue.push({ id: childId, depth: depth + 1 });\n        }\n      }\n    }\n\n    return descendants;\n  }\n\n  // ============ Helpers ============\n\n  private addToMap(map: Map<string, string[]>, key: string, value: string): void {\n    const existing = map.get(key);\n    if (existing) {\n      if (!existing.includes(value)) {\n        existing.push(value);\n      }\n    } else {\n      map.set(key, [value]);\n    }\n  }\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 379, "column": 0}, "map": {"version":3,"sources":["file:///Users/smsm/Desktop/Portafolio%20IA/arbol-genealogico-digital%202/packages/graph-engine/src/layout/GenerationAssigner.ts"],"sourcesContent":["/**\n * Generation Assigner\n * Assigns generation levels to nodes in the family tree\n */\n\nimport type { GraphPerson, GraphUnion } from '../types';\nimport { Graph } from '../core/Graph';\n\nexport interface GenerationAssignment {\n  personGenerations: Map<string, number>;\n  unionGenerations: Map<string, number>;\n  maxGeneration: number;\n  minGeneration: number;\n}\n\n/**\n * Assigns generation numbers to all persons and unions in the graph\n * Generations are numbered from 0 (youngest) going up to older generations\n */\nexport function assignGenerations(\n  graph: Graph,\n  rootPersonId?: string\n): GenerationAssignment {\n  const personGenerations = new Map<string, number>();\n  const unionGenerations = new Map<string, number>();\n\n  const persons = graph.getAllPersons();\n  if (persons.length === 0) {\n    return { personGenerations, unionGenerations, maxGeneration: 0, minGeneration: 0 };\n  }\n\n  // Calculate person generations using the graph's method\n  const rawGenerations = graph.calculateGenerations(rootPersonId);\n\n  // Copy to our result map\n  for (const [id, gen] of rawGenerations) {\n    personGenerations.set(id, gen);\n  }\n\n  // Calculate union generations (between the two partners' generations)\n  const unions = graph.getAllUnions();\n  for (const union of unions) {\n    const gen1 = personGenerations.get(union.partner1Id);\n    const gen2 = personGenerations.get(union.partner2Id);\n\n    if (gen1 !== undefined && gen2 !== undefined) {\n      // Union is at the same generation as partners (should be equal ideally)\n      // Add 0.5 to position union nodes visually between generations\n      unionGenerations.set(union.id, Math.max(gen1, gen2));\n    }\n  }\n\n  // Calculate min and max\n  const allGenerations = Array.from(personGenerations.values());\n  const maxGeneration = allGenerations.length > 0 ? Math.max(...allGenerations) : 0;\n  const minGeneration = allGenerations.length > 0 ? Math.min(...allGenerations) : 0;\n\n  return {\n    personGenerations,\n    unionGenerations,\n    maxGeneration,\n    minGeneration,\n  };\n}\n\n/**\n * Groups persons by their generation\n */\nexport function groupByGeneration(\n  persons: GraphPerson[],\n  generations: Map<string, number>\n): Map<number, GraphPerson[]> {\n  const groups = new Map<number, GraphPerson[]>();\n\n  for (const person of persons) {\n    const gen = generations.get(person.id) ?? 0;\n    const group = groups.get(gen);\n    if (group) {\n      group.push(person);\n    } else {\n      groups.set(gen, [person]);\n    }\n  }\n\n  return groups;\n}\n\n/**\n * Gets all generations as sorted array (oldest to youngest)\n */\nexport function getSortedGenerations(generations: Map<string, number>): number[] {\n  const uniqueGens = new Set(generations.values());\n  return Array.from(uniqueGens).sort((a, b) => b - a); // Descending (oldest first)\n}\n"],"names":[],"mappings":"AAAA;;;CAGC;;;;;;;;AAgBM,SAAS,kBACd,KAAY,EACZ,YAAqB;IAErB,MAAM,oBAAoB,IAAI;IAC9B,MAAM,mBAAmB,IAAI;IAE7B,MAAM,UAAU,MAAM,aAAa;IACnC,IAAI,QAAQ,MAAM,KAAK,GAAG;QACxB,OAAO;YAAE;YAAmB;YAAkB,eAAe;YAAG,eAAe;QAAE;IACnF;IAEA,wDAAwD;IACxD,MAAM,iBAAiB,MAAM,oBAAoB,CAAC;IAElD,yBAAyB;IACzB,KAAK,MAAM,CAAC,IAAI,IAAI,IAAI,eAAgB;QACtC,kBAAkB,GAAG,CAAC,IAAI;IAC5B;IAEA,sEAAsE;IACtE,MAAM,SAAS,MAAM,YAAY;IACjC,KAAK,MAAM,SAAS,OAAQ;QAC1B,MAAM,OAAO,kBAAkB,GAAG,CAAC,MAAM,UAAU;QACnD,MAAM,OAAO,kBAAkB,GAAG,CAAC,MAAM,UAAU;QAEnD,IAAI,SAAS,aAAa,SAAS,WAAW;YAC5C,wEAAwE;YACxE,+DAA+D;YAC/D,iBAAiB,GAAG,CAAC,MAAM,EAAE,EAAE,KAAK,GAAG,CAAC,MAAM;QAChD;IACF;IAEA,wBAAwB;IACxB,MAAM,iBAAiB,MAAM,IAAI,CAAC,kBAAkB,MAAM;IAC1D,MAAM,gBAAgB,eAAe,MAAM,GAAG,IAAI,KAAK,GAAG,IAAI,kBAAkB;IAChF,MAAM,gBAAgB,eAAe,MAAM,GAAG,IAAI,KAAK,GAAG,IAAI,kBAAkB;IAEhF,OAAO;QACL;QACA;QACA;QACA;IACF;AACF;AAKO,SAAS,kBACd,OAAsB,EACtB,WAAgC;IAEhC,MAAM,SAAS,IAAI;IAEnB,KAAK,MAAM,UAAU,QAAS;QAC5B,MAAM,MAAM,YAAY,GAAG,CAAC,OAAO,EAAE,KAAK;QAC1C,MAAM,QAAQ,OAAO,GAAG,CAAC;QACzB,IAAI,OAAO;YACT,MAAM,IAAI,CAAC;QACb,OAAO;YACL,OAAO,GAAG,CAAC,KAAK;gBAAC;aAAO;QAC1B;IACF;IAEA,OAAO;AACT;AAKO,SAAS,qBAAqB,WAAgC;IACnE,MAAM,aAAa,IAAI,IAAI,YAAY,MAAM;IAC7C,OAAO,MAAM,IAAI,CAAC,YAAY,IAAI,CAAC,CAAC,GAAG,IAAM,IAAI,IAAI,4BAA4B;AACnF"}},
    {"offset": {"line": 453, "column": 0}, "map": {"version":3,"sources":["file:///Users/smsm/Desktop/Portafolio%20IA/arbol-genealogico-digital%202/packages/graph-engine/src/layout/SugiyamaLayout.ts"],"sourcesContent":["/**\n * Sugiyama Layout Algorithm\n * Implements a hierarchical layout algorithm for P-graphs (genealogical graphs)\n *\n * The algorithm consists of four main phases:\n * 1. Layer assignment (generation assignment)\n * 2. Crossing reduction (minimize edge crossings)\n * 3. Node positioning (calculate X coordinates)\n * 4. Edge routing (create smooth paths)\n */\n\nimport type {\n  GraphData,\n  GraphNode,\n  GraphEdge,\n  LayoutConfig,\n  LayoutResult,\n  Bounds,\n  PersonNodeData,\n  UnionNodeData,\n  Point,\n} from '../types';\nimport { Graph } from '../core/Graph';\nimport { assignGenerations, groupByGeneration } from './GenerationAssigner';\nimport { DEFAULT_LAYOUT_CONFIG } from '../types';\n\nexport class SugiyamaLayout {\n  private config: LayoutConfig;\n  private graph: Graph;\n\n  constructor(config: Partial<LayoutConfig> = {}) {\n    this.config = { ...DEFAULT_LAYOUT_CONFIG, ...config };\n    this.graph = new Graph();\n  }\n\n  /**\n   * Main entry point - compute layout for graph data\n   */\n  compute(data: GraphData): LayoutResult {\n    this.graph.loadData(data);\n\n    if (data.persons.length === 0) {\n      return {\n        nodes: [],\n        edges: [],\n        bounds: { minX: 0, minY: 0, maxX: 0, maxY: 0, width: 0, height: 0 },\n        generations: 0,\n      };\n    }\n\n    // Phase 1: Assign generations (layers)\n    const { personGenerations, unionGenerations, maxGeneration } = assignGenerations(\n      this.graph,\n      this.config.rootPersonId\n    );\n\n    // Phase 2: Group by generation and order within generations\n    const persons = this.graph.getAllPersons();\n    const generationGroups = groupByGeneration(persons, personGenerations);\n\n    // Phase 3: Order nodes within each generation (minimize crossings)\n    const orderedGroups = this.orderNodesWithinGenerations(\n      generationGroups,\n      personGenerations\n    );\n\n    // Phase 4: Calculate positions\n    const nodes = this.calculatePositions(\n      orderedGroups,\n      personGenerations,\n      unionGenerations,\n      data.unions\n    );\n\n    // Phase 5: Create edges\n    const edges = this.createEdges(nodes, data.unions);\n\n    // Calculate bounds\n    const bounds = this.calculateBounds(nodes);\n\n    return {\n      nodes,\n      edges,\n      bounds,\n      generations: maxGeneration + 1,\n    };\n  }\n\n  /**\n   * Phase 2: Order nodes within each generation to minimize crossings\n   * Uses a barycenter heuristic\n   */\n  private orderNodesWithinGenerations(\n    groups: Map<number, import('../types').GraphPerson[]>,\n    generations: Map<string, number>\n  ): Map<number, import('../types').GraphPerson[]> {\n    const sortedGens = Array.from(groups.keys()).sort((a, b) => b - a);\n    const orderedGroups = new Map<number, import('../types').GraphPerson[]>();\n\n    // Start from oldest generation\n    for (let i = 0; i < sortedGens.length; i++) {\n      const gen = sortedGens[i];\n      const group = groups.get(gen) || [];\n\n      if (i === 0) {\n        // First generation: sort by family groups\n        orderedGroups.set(gen, this.sortByFamilyGroups(group));\n      } else {\n        // Use barycenter method based on parent positions\n        const prevGen = sortedGens[i - 1];\n        const prevGroup = orderedGroups.get(prevGen) || [];\n        const prevPositions = new Map<string, number>();\n        prevGroup.forEach((p, idx) => prevPositions.set(p.id, idx));\n\n        const sorted = this.barycenterSort(group, prevPositions);\n        orderedGroups.set(gen, sorted);\n      }\n    }\n\n    return orderedGroups;\n  }\n\n  /**\n   * Sort persons by their family groups (spouses together)\n   */\n  private sortByFamilyGroups(persons: import('../types').GraphPerson[]): import('../types').GraphPerson[] {\n    const sorted: import('../types').GraphPerson[] = [];\n    const added = new Set<string>();\n\n    for (const person of persons) {\n      if (added.has(person.id)) continue;\n\n      // Add person\n      sorted.push(person);\n      added.add(person.id);\n\n      // Add spouses\n      const spouses = this.graph.getSpouses(person.id);\n      for (const spouse of spouses) {\n        if (!added.has(spouse.id)) {\n          sorted.push(spouse);\n          added.add(spouse.id);\n        }\n      }\n    }\n\n    return sorted;\n  }\n\n  /**\n   * Barycenter sorting - order children based on average parent position\n   */\n  private barycenterSort(\n    persons: import('../types').GraphPerson[],\n    parentPositions: Map<string, number>\n  ): import('../types').GraphPerson[] {\n    const barycenters: Array<{ person: import('../types').GraphPerson; value: number }> = [];\n\n    for (const person of persons) {\n      const parents = this.graph.getParents(person.id);\n      if (parents.length === 0) {\n        barycenters.push({ person, value: Infinity });\n        continue;\n      }\n\n      // Calculate average position of parents\n      let sum = 0;\n      let count = 0;\n      for (const parent of parents) {\n        const pos = parentPositions.get(parent.id);\n        if (pos !== undefined) {\n          sum += pos;\n          count++;\n        }\n      }\n\n      const barycenter = count > 0 ? sum / count : Infinity;\n      barycenters.push({ person, value: barycenter });\n    }\n\n    // Sort by barycenter value\n    barycenters.sort((a, b) => a.value - b.value);\n    return barycenters.map((b) => b.person);\n  }\n\n  /**\n   * Phase 3 & 4: Calculate node positions\n   */\n  private calculatePositions(\n    orderedGroups: Map<number, import('../types').GraphPerson[]>,\n    personGenerations: Map<string, number>,\n    unionGenerations: Map<string, number>,\n    unions: import('../types').GraphUnion[]\n  ): GraphNode[] {\n    const nodes: GraphNode[] = [];\n    const nodePositions = new Map<string, { x: number; y: number }>();\n\n    const {\n      nodeWidth,\n      nodeHeight,\n      unionNodeSize,\n      horizontalSpacing,\n      verticalSpacing,\n      direction,\n    } = this.config;\n\n    // Sort generations\n    const sortedGens = Array.from(orderedGroups.keys()).sort((a, b) =>\n      direction === 'TB' ? b - a : a - b\n    );\n\n    // Calculate positions for each generation\n    sortedGens.forEach((gen, genIndex) => {\n      const persons = orderedGroups.get(gen) || [];\n      const y = genIndex * (nodeHeight + verticalSpacing);\n\n      // Calculate total width of this generation\n      const totalWidth =\n        persons.length * nodeWidth + (persons.length - 1) * horizontalSpacing;\n      let startX = -totalWidth / 2;\n\n      persons.forEach((person, idx) => {\n        const x = startX + idx * (nodeWidth + horizontalSpacing) + nodeWidth / 2;\n\n        const node: GraphNode = {\n          id: `person-${person.id}`,\n          type: 'person',\n          x,\n          y,\n          width: nodeWidth,\n          height: nodeHeight,\n          generation: gen,\n          data: {\n            personId: person.id,\n            firstName: person.firstName,\n            lastName: person.lastName,\n            gender: person.gender,\n            birthDate: person.birthDate,\n            birthDateApproximate: person.birthDateApproximate,\n            deathDate: person.deathDate,\n            deathDateApproximate: person.deathDateApproximate,\n            photoUrl: person.photoUrl,\n            isLiving: person.isLiving,\n            medicalConditions: person.medicalConditions,\n          } as PersonNodeData,\n        };\n\n        nodes.push(node);\n        nodePositions.set(person.id, { x, y });\n      });\n    });\n\n    // Create union nodes positioned between partners\n    for (const union of unions) {\n      const pos1 = nodePositions.get(union.partner1Id);\n      const pos2 = nodePositions.get(union.partner2Id);\n\n      if (pos1 && pos2) {\n        const x = (pos1.x + pos2.x) / 2;\n        const y = pos1.y + nodeHeight / 2 + verticalSpacing / 4;\n        const gen = unionGenerations.get(union.id) ?? 0;\n\n        const unionNode: GraphNode = {\n          id: `union-${union.id}`,\n          type: 'union',\n          x,\n          y,\n          width: unionNodeSize,\n          height: unionNodeSize,\n          generation: gen,\n          data: {\n            unionId: union.id,\n            partner1Id: union.partner1Id,\n            partner2Id: union.partner2Id,\n            unionType: union.unionType,\n            startDate: union.startDate,\n            endDate: union.endDate,\n          } as UnionNodeData,\n        };\n\n        nodes.push(unionNode);\n        nodePositions.set(`union-${union.id}`, { x, y });\n      }\n    }\n\n    return nodes;\n  }\n\n  /**\n   * Phase 5: Create edges between nodes\n   */\n  private createEdges(\n    nodes: GraphNode[],\n    unions: import('../types').GraphUnion[]\n  ): GraphEdge[] {\n    const edges: GraphEdge[] = [];\n    const nodeMap = new Map<string, GraphNode>();\n\n    for (const node of nodes) {\n      nodeMap.set(node.id, node);\n    }\n\n    // Create edges for each union\n    for (const union of unions) {\n      const partner1Node = nodeMap.get(`person-${union.partner1Id}`);\n      const partner2Node = nodeMap.get(`person-${union.partner2Id}`);\n      const unionNode = nodeMap.get(`union-${union.id}`);\n\n      if (partner1Node && unionNode) {\n        // Edge from partner1 to union\n        edges.push(this.createEdge(\n          `edge-${union.partner1Id}-${union.id}`,\n          partner1Node,\n          unionNode,\n          'spouse'\n        ));\n      }\n\n      if (partner2Node && unionNode) {\n        // Edge from partner2 to union\n        edges.push(this.createEdge(\n          `edge-${union.partner2Id}-${union.id}`,\n          partner2Node,\n          unionNode,\n          'spouse'\n        ));\n      }\n\n      // Edges from union to children\n      if (unionNode) {\n        for (const childId of union.childrenIds) {\n          const childNode = nodeMap.get(`person-${childId}`);\n          if (childNode) {\n            edges.push(this.createEdge(\n              `edge-${union.id}-${childId}`,\n              unionNode,\n              childNode,\n              'parent-child'\n            ));\n          }\n        }\n      }\n    }\n\n    return edges;\n  }\n\n  /**\n   * Create a single edge with path data\n   */\n  private createEdge(\n    id: string,\n    source: GraphNode,\n    target: GraphNode,\n    type: 'spouse' | 'parent-child'\n  ): GraphEdge {\n    const sourcePoint: Point = {\n      x: source.x,\n      y: source.y + (type === 'spouse' ? source.height / 2 : source.height / 2),\n    };\n\n    const targetPoint: Point = {\n      x: target.x,\n      y: target.y - target.height / 2,\n    };\n\n    // Create bezier curve path\n    const pathData = this.createBezierPath(sourcePoint, targetPoint, type);\n\n    return {\n      id,\n      sourceId: source.id,\n      targetId: target.id,\n      type: type,\n      pathData,\n      controlPoints: [sourcePoint, targetPoint],\n    };\n  }\n\n  /**\n   * Create a smooth bezier curve path between two points\n   */\n  private createBezierPath(\n    start: Point,\n    end: Point,\n    type: 'spouse' | 'parent-child'\n  ): string {\n    if (type === 'spouse') {\n      // Horizontal line for spouse connections\n      const midX = (start.x + end.x) / 2;\n      return `M ${start.x} ${start.y} L ${midX} ${start.y} L ${midX} ${end.y} L ${end.x} ${end.y}`;\n    }\n\n    // Vertical bezier curve for parent-child\n    const midY = (start.y + end.y) / 2;\n    return `M ${start.x} ${start.y} C ${start.x} ${midY}, ${end.x} ${midY}, ${end.x} ${end.y}`;\n  }\n\n  /**\n   * Calculate the bounding box of all nodes\n   */\n  private calculateBounds(nodes: GraphNode[]): Bounds {\n    if (nodes.length === 0) {\n      return { minX: 0, minY: 0, maxX: 0, maxY: 0, width: 0, height: 0 };\n    }\n\n    let minX = Infinity;\n    let minY = Infinity;\n    let maxX = -Infinity;\n    let maxY = -Infinity;\n\n    for (const node of nodes) {\n      const left = node.x - node.width / 2;\n      const right = node.x + node.width / 2;\n      const top = node.y - node.height / 2;\n      const bottom = node.y + node.height / 2;\n\n      minX = Math.min(minX, left);\n      minY = Math.min(minY, top);\n      maxX = Math.max(maxX, right);\n      maxY = Math.max(maxY, bottom);\n    }\n\n    return {\n      minX,\n      minY,\n      maxX,\n      maxY,\n      width: maxX - minX,\n      height: maxY - minY,\n    };\n  }\n\n  /**\n   * Update configuration\n   */\n  setConfig(config: Partial<LayoutConfig>): void {\n    this.config = { ...this.config, ...config };\n  }\n\n  /**\n   * Get current configuration\n   */\n  getConfig(): LayoutConfig {\n    return { ...this.config };\n  }\n}\n\n/**\n * Factory function for creating a Sugiyama layout\n */\nexport function createSugiyamaLayout(config?: Partial<LayoutConfig>): SugiyamaLayout {\n  return new SugiyamaLayout(config);\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 811, "column": 0}, "map": {"version":3,"sources":["file:///Users/smsm/Desktop/Portafolio%20IA/arbol-genealogico-digital%202/packages/graph-engine/src/renderer/PersonNode.tsx"],"sourcesContent":["'use client';\n\nimport type { MouseEvent } from 'react';\nimport type { GraphNode, PersonNodeData, RenderOptions } from '../types';\n\nexport interface PersonNodeProps {\n  node: GraphNode;\n  isSelected?: boolean;\n  isHighlighted?: boolean;\n  isHovered?: boolean;\n  options: RenderOptions;\n  onClick?: (e: MouseEvent) => void;\n  onMouseEnter?: (e: MouseEvent) => void;\n  onMouseLeave?: () => void;\n}\n\nexport function PersonNode({\n  node,\n  isSelected = false,\n  isHighlighted = false,\n  isHovered = false,\n  options,\n  onClick,\n  onMouseEnter,\n  onMouseLeave,\n}: PersonNodeProps) {\n  const data = node.data as PersonNodeData;\n  const { width, height, x, y } = node;\n\n  const isDeceased = !data.isLiving || !!data.deathDate;\n  const fullName = `${data.firstName} ${data.lastName}`;\n  const initials = `${data.firstName[0] || ''}${data.lastName[0] || ''}`.toUpperCase();\n\n  // Calculate colors based on gender\n  const genderColors = {\n    male: { bg: '#dbeafe', border: '#3b82f6', text: '#1e40af' },\n    female: { bg: '#fce7f3', border: '#ec4899', text: '#9d174d' },\n    other: { bg: '#e5e7eb', border: '#6b7280', text: '#374151' },\n    unknown: { bg: '#e5e7eb', border: '#6b7280', text: '#374151' },\n  };\n\n  const colors = genderColors[data.gender];\n\n  // Border and shadow styles based on state\n  const strokeWidth = isSelected ? 3 : isHighlighted ? 2.5 : isHovered ? 2 : 1.5;\n  const strokeColor = isSelected\n    ? '#0ea5e9'\n    : isHighlighted\n    ? '#f59e0b'\n    : colors.border;\n\n  // Format dates\n  const formatYear = (date?: string) => {\n    if (!date) return '';\n    return new Date(date).getFullYear().toString();\n  };\n\n  const birthYear = formatYear(data.birthDate);\n  const deathYear = formatYear(data.deathDate);\n  const dateDisplay = isDeceased\n    ? `${birthYear}${birthYear && deathYear ? ' - ' : ''}${deathYear}`\n    : birthYear;\n\n  return (\n    <g\n      transform={`translate(${x - width / 2}, ${y - height / 2})`}\n      onClick={onClick}\n      onMouseEnter={onMouseEnter}\n      onMouseLeave={onMouseLeave}\n      style={{ cursor: 'pointer' }}\n      className={options.animationsEnabled ? 'transition-transform duration-200' : ''}\n    >\n      {/* Card background */}\n      <rect\n        x={0}\n        y={0}\n        width={width}\n        height={height}\n        rx={12}\n        ry={12}\n        fill={isDeceased ? '#f5f5f5' : 'white'}\n        stroke={strokeColor}\n        strokeWidth={strokeWidth}\n        filter=\"url(#node-shadow)\"\n        opacity={isDeceased && !options.showDeceased ? 0.5 : 1}\n      />\n\n      {/* Deceased overlay line */}\n      {isDeceased && (\n        <line\n          x1={0}\n          y1={0}\n          x2={width}\n          y2={height}\n          stroke=\"#9ca3af\"\n          strokeWidth={1.5}\n          strokeLinecap=\"round\"\n        />\n      )}\n\n      {/* Avatar circle */}\n      <g transform={`translate(${16}, ${height / 2 - 24})`}>\n        {options.showPhotos && data.photoUrl ? (\n          <clipPath id={`avatar-clip-${node.id}`}>\n            <circle cx={24} cy={24} r={24} />\n          </clipPath>\n        ) : null}\n\n        <circle\n          cx={24}\n          cy={24}\n          r={24}\n          fill={colors.bg}\n          stroke={colors.border}\n          strokeWidth={2}\n        />\n\n        {options.showPhotos && data.photoUrl ? (\n          <image\n            href={data.photoUrl}\n            x={0}\n            y={0}\n            width={48}\n            height={48}\n            clipPath={`url(#avatar-clip-${node.id})`}\n            preserveAspectRatio=\"xMidYMid slice\"\n          />\n        ) : (\n          <text\n            x={24}\n            y={24}\n            textAnchor=\"middle\"\n            dominantBaseline=\"central\"\n            fill={colors.text}\n            fontSize={16}\n            fontWeight={600}\n          >\n            {initials}\n          </text>\n        )}\n      </g>\n\n      {/* Name and info */}\n      <g transform={`translate(${72}, ${20})`}>\n        <text\n          x={0}\n          y={0}\n          fill={isDeceased ? '#6b7280' : '#171717'}\n          fontSize={14}\n          fontWeight={600}\n          dominantBaseline=\"hanging\"\n        >\n          {truncateText(data.firstName, 12)}\n        </text>\n        <text\n          x={0}\n          y={18}\n          fill={isDeceased ? '#9ca3af' : '#525252'}\n          fontSize={13}\n          dominantBaseline=\"hanging\"\n        >\n          {truncateText(data.lastName, 14)}\n        </text>\n\n        {options.showDates && dateDisplay && (\n          <text\n            x={0}\n            y={40}\n            fill=\"#a3a3a3\"\n            fontSize={11}\n            dominantBaseline=\"hanging\"\n          >\n            {dateDisplay}\n          </text>\n        )}\n      </g>\n\n      {/* Gender indicator */}\n      <GenderIndicator\n        gender={data.gender}\n        x={width - 20}\n        y={12}\n      />\n\n      {/* Medical condition indicators */}\n      {options.showMedicalIcons && data.medicalConditions && data.medicalConditions.length > 0 && (\n        <g transform={`translate(${width - 36}, ${height - 24})`}>\n          <MedicalIndicator conditions={data.medicalConditions} />\n        </g>\n      )}\n\n      {/* Selection/highlight ring */}\n      {(isSelected || isHighlighted) && (\n        <rect\n          x={-4}\n          y={-4}\n          width={width + 8}\n          height={height + 8}\n          rx={16}\n          ry={16}\n          fill=\"none\"\n          stroke={isSelected ? '#0ea5e9' : '#f59e0b'}\n          strokeWidth={2}\n          strokeDasharray={isHighlighted && !isSelected ? '4 2' : 'none'}\n          opacity={0.5}\n        />\n      )}\n    </g>\n  );\n}\n\nfunction GenderIndicator({ gender, x, y }: { gender: string; x: number; y: number }) {\n  const size = 12;\n\n  if (gender === 'male') {\n    // Square for male\n    return (\n      <rect\n        x={x}\n        y={y}\n        width={size}\n        height={size}\n        fill=\"none\"\n        stroke=\"#3b82f6\"\n        strokeWidth={2}\n      />\n    );\n  }\n\n  if (gender === 'female') {\n    // Circle for female\n    return (\n      <circle\n        cx={x + size / 2}\n        cy={y + size / 2}\n        r={size / 2}\n        fill=\"none\"\n        stroke=\"#ec4899\"\n        strokeWidth={2}\n      />\n    );\n  }\n\n  // Diamond for other\n  return (\n    <polygon\n      points={`${x + size / 2},${y} ${x + size},${y + size / 2} ${x + size / 2},${y + size} ${x},${y + size / 2}`}\n      fill=\"none\"\n      stroke=\"#6b7280\"\n      strokeWidth={2}\n    />\n  );\n}\n\nfunction MedicalIndicator({\n  conditions,\n}: {\n  conditions: Array<{ category: string }>;\n}) {\n  const count = conditions.length;\n\n  return (\n    <g>\n      <circle\n        cx={12}\n        cy={12}\n        r={10}\n        fill=\"#fef3c7\"\n        stroke=\"#f59e0b\"\n        strokeWidth={1.5}\n      />\n      <text\n        x={12}\n        y={12}\n        textAnchor=\"middle\"\n        dominantBaseline=\"central\"\n        fill=\"#92400e\"\n        fontSize={10}\n        fontWeight={600}\n      >\n        {count}\n      </text>\n    </g>\n  );\n}\n\nfunction truncateText(text: string, maxLength: number): string {\n  if (text.length <= maxLength) return text;\n  return text.slice(0, maxLength - 1) + '...';\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1145, "column": 0}, "map": {"version":3,"sources":["file:///Users/smsm/Desktop/Portafolio%20IA/arbol-genealogico-digital%202/packages/graph-engine/src/renderer/UnionNode.tsx"],"sourcesContent":["'use client';\n\nimport type { MouseEvent } from 'react';\nimport type { GraphNode, UnionNodeData } from '../types';\n\nexport interface UnionNodeProps {\n  node: GraphNode;\n  isSelected?: boolean;\n  onClick?: (e: MouseEvent) => void;\n}\n\nexport function UnionNode({ node, isSelected = false, onClick }: UnionNodeProps) {\n  const data = node.data as UnionNodeData;\n  const { width, height, x, y } = node;\n\n  // Color based on union type\n  const getUnionStyle = () => {\n    switch (data.unionType) {\n      case 'marriage':\n        return { fill: '#22c55e', stroke: '#16a34a' };\n      case 'partnership':\n        return { fill: '#3b82f6', stroke: '#2563eb' };\n      case 'divorced':\n        return { fill: '#ef4444', stroke: '#dc2626' };\n      case 'separated':\n        return { fill: '#f59e0b', stroke: '#d97706' };\n      default:\n        return { fill: '#6b7280', stroke: '#4b5563' };\n    }\n  };\n\n  const style = getUnionStyle();\n  const radius = width / 2;\n\n  return (\n    <g\n      transform={`translate(${x}, ${y})`}\n      onClick={onClick}\n      style={{ cursor: 'pointer' }}\n    >\n      {/* Union circle */}\n      <circle\n        cx={0}\n        cy={0}\n        r={radius}\n        fill={style.fill}\n        stroke={isSelected ? '#0ea5e9' : style.stroke}\n        strokeWidth={isSelected ? 3 : 2}\n      />\n\n      {/* Union type indicator */}\n      <UnionTypeIndicator type={data.unionType} radius={radius} />\n\n      {/* Selection ring */}\n      {isSelected && (\n        <circle\n          cx={0}\n          cy={0}\n          r={radius + 4}\n          fill=\"none\"\n          stroke=\"#0ea5e9\"\n          strokeWidth={2}\n          opacity={0.5}\n        />\n      )}\n    </g>\n  );\n}\n\nfunction UnionTypeIndicator({\n  type,\n  radius,\n}: {\n  type: string;\n  radius: number;\n}) {\n  const iconSize = radius * 0.8;\n\n  switch (type) {\n    case 'marriage':\n      // Heart or rings icon\n      return (\n        <g transform={`translate(${-iconSize / 2}, ${-iconSize / 2})`}>\n          <path\n            d={`M${iconSize / 2} ${iconSize * 0.3}\n                C${iconSize * 0.2} 0, 0 ${iconSize * 0.3}, ${iconSize / 2} ${iconSize * 0.8}\n                C${iconSize} ${iconSize * 0.3}, ${iconSize * 0.8} 0, ${iconSize / 2} ${iconSize * 0.3}`}\n            fill=\"white\"\n            stroke=\"none\"\n          />\n        </g>\n      );\n\n    case 'divorced':\n      // X mark\n      return (\n        <g>\n          <line\n            x1={-iconSize / 2}\n            y1={-iconSize / 2}\n            x2={iconSize / 2}\n            y2={iconSize / 2}\n            stroke=\"white\"\n            strokeWidth={2}\n            strokeLinecap=\"round\"\n          />\n          <line\n            x1={iconSize / 2}\n            y1={-iconSize / 2}\n            x2={-iconSize / 2}\n            y2={iconSize / 2}\n            stroke=\"white\"\n            strokeWidth={2}\n            strokeLinecap=\"round\"\n          />\n        </g>\n      );\n\n    case 'separated':\n      // Single line\n      return (\n        <line\n          x1={-iconSize / 2}\n          y1={0}\n          x2={iconSize / 2}\n          y2={0}\n          stroke=\"white\"\n          strokeWidth={2}\n          strokeLinecap=\"round\"\n        />\n      );\n\n    case 'partnership':\n      // Two dots\n      return (\n        <g>\n          <circle cx={-iconSize / 4} cy={0} r={iconSize / 5} fill=\"white\" />\n          <circle cx={iconSize / 4} cy={0} r={iconSize / 5} fill=\"white\" />\n        </g>\n      );\n\n    default:\n      return null;\n  }\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1346, "column": 0}, "map": {"version":3,"sources":["file:///Users/smsm/Desktop/Portafolio%20IA/arbol-genealogico-digital%202/packages/graph-engine/src/renderer/EdgeRenderer.tsx"],"sourcesContent":["'use client';\n\nimport type { GraphEdge } from '../types';\n\nexport interface EdgeRendererProps {\n  edge: GraphEdge;\n  isHighlighted?: boolean;\n  color?: string;\n}\n\nexport function EdgeRenderer({\n  edge,\n  isHighlighted = false,\n  color,\n}: EdgeRendererProps) {\n  const strokeColor = color || (isHighlighted ? '#0ea5e9' : '#d4d4d4');\n  const strokeWidth = isHighlighted ? 2.5 : 2;\n\n  return (\n    <g>\n      <path\n        d={edge.pathData}\n        fill=\"none\"\n        stroke={strokeColor}\n        strokeWidth={strokeWidth}\n        strokeLinecap=\"round\"\n        strokeLinejoin=\"round\"\n        className=\"transition-all duration-200\"\n      />\n    </g>\n  );\n}\n\n/**\n * Render multiple edges with the same styling\n */\nexport function EdgeGroup({\n  edges,\n  isHighlighted = false,\n  color,\n}: {\n  edges: GraphEdge[];\n  isHighlighted?: boolean;\n  color?: string;\n}) {\n  return (\n    <g>\n      {edges.map((edge) => (\n        <EdgeRenderer\n          key={edge.id}\n          edge={edge}\n          isHighlighted={isHighlighted}\n          color={color}\n        />\n      ))}\n    </g>\n  );\n}\n"],"names":[],"mappings":";;;;;;;AAAA;;AAUO,SAAS,aAAa,EAC3B,IAAI,EACJ,gBAAgB,KAAK,EACrB,KAAK,EACa;IAClB,MAAM,cAAc,SAAS,CAAC,gBAAgB,YAAY,SAAS;IACnE,MAAM,cAAc,gBAAgB,MAAM;IAE1C,qBACE,8OAAC;kBACC,cAAA,8OAAC;YACC,GAAG,KAAK,QAAQ;YAChB,MAAK;YACL,QAAQ;YACR,aAAa;YACb,eAAc;YACd,gBAAe;YACf,WAAU;;;;;;;;;;;AAIlB;AAKO,SAAS,UAAU,EACxB,KAAK,EACL,gBAAgB,KAAK,EACrB,KAAK,EAKN;IACC,qBACE,8OAAC;kBACE,MAAM,GAAG,CAAC,CAAC,qBACV,8OAAC;gBAEC,MAAM;gBACN,eAAe;gBACf,OAAO;eAHF,KAAK,EAAE;;;;;;;;;;AAQtB"}},
    {"offset": {"line": 1399, "column": 0}, "map": {"version":3,"sources":["file:///Users/smsm/Desktop/Portafolio%20IA/arbol-genealogico-digital%202/packages/graph-engine/src/renderer/GraphCanvas.tsx"],"sourcesContent":["'use client';\n\nimport {\n  useRef,\n  useEffect,\n  useState,\n  useCallback,\n  type ReactNode,\n  type MouseEvent,\n  type WheelEvent,\n  type TouchEvent,\n} from 'react';\nimport type {\n  GraphNode,\n  GraphEdge,\n  Viewport,\n  Bounds,\n  NodeInteraction,\n  RenderOptions,\n} from '../types';\nimport { ZOOM_LIMITS } from '../types';\nimport { PersonNode } from './PersonNode';\nimport { UnionNode } from './UnionNode';\nimport { EdgeRenderer } from './EdgeRenderer';\n\nexport interface GraphCanvasProps {\n  nodes: GraphNode[];\n  edges: GraphEdge[];\n  bounds: Bounds;\n  viewport: Viewport;\n  onViewportChange: (viewport: Viewport) => void;\n  onNodeClick?: (interaction: NodeInteraction) => void;\n  onNodeHover?: (interaction: NodeInteraction | null) => void;\n  options?: Partial<RenderOptions>;\n  className?: string;\n  children?: ReactNode;\n}\n\nconst DEFAULT_OPTIONS: RenderOptions = {\n  showPhotos: true,\n  showDates: true,\n  showMedicalIcons: false,\n  showDeceased: true,\n  animationsEnabled: true,\n};\n\nexport function GraphCanvas({\n  nodes,\n  edges,\n  bounds,\n  viewport,\n  onViewportChange,\n  onNodeClick,\n  onNodeHover,\n  options = {},\n  className = '',\n  children,\n}: GraphCanvasProps) {\n  const containerRef = useRef<HTMLDivElement>(null);\n  const svgRef = useRef<SVGSVGElement>(null);\n\n  const [isPanning, setIsPanning] = useState(false);\n  const [lastPanPoint, setLastPanPoint] = useState<{ x: number; y: number } | null>(null);\n  const [hoveredNodeId, setHoveredNodeId] = useState<string | null>(null);\n\n  const renderOptions = { ...DEFAULT_OPTIONS, ...options };\n\n  // Handle container resize\n  useEffect(() => {\n    const container = containerRef.current;\n    if (!container) return;\n\n    const resizeObserver = new ResizeObserver((entries) => {\n      for (const entry of entries) {\n        const { width, height } = entry.contentRect;\n        onViewportChange({ ...viewport, width, height });\n      }\n    });\n\n    resizeObserver.observe(container);\n    return () => resizeObserver.disconnect();\n  }, [viewport, onViewportChange]);\n\n  // Pan handlers\n  const handleMouseDown = useCallback((e: MouseEvent) => {\n    if (e.button === 0) {\n      setIsPanning(true);\n      setLastPanPoint({ x: e.clientX, y: e.clientY });\n    }\n  }, []);\n\n  const handleMouseMove = useCallback(\n    (e: MouseEvent) => {\n      if (!isPanning || !lastPanPoint) return;\n\n      const dx = e.clientX - lastPanPoint.x;\n      const dy = e.clientY - lastPanPoint.y;\n\n      onViewportChange({\n        ...viewport,\n        x: viewport.x - dx / viewport.scale,\n        y: viewport.y - dy / viewport.scale,\n      });\n\n      setLastPanPoint({ x: e.clientX, y: e.clientY });\n    },\n    [isPanning, lastPanPoint, viewport, onViewportChange]\n  );\n\n  const handleMouseUp = useCallback(() => {\n    setIsPanning(false);\n    setLastPanPoint(null);\n  }, []);\n\n  // Zoom handler\n  const handleWheel = useCallback(\n    (e: WheelEvent) => {\n      e.preventDefault();\n\n      const rect = containerRef.current?.getBoundingClientRect();\n      if (!rect) return;\n\n      const mouseX = e.clientX - rect.left;\n      const mouseY = e.clientY - rect.top;\n\n      // Calculate zoom\n      const delta = e.deltaY > 0 ? 0.9 : 1.1;\n      const newScale = Math.min(\n        Math.max(viewport.scale * delta, ZOOM_LIMITS.min),\n        ZOOM_LIMITS.max\n      );\n\n      // Zoom towards mouse position\n      const scaleRatio = newScale / viewport.scale;\n      const newX = viewport.x + (mouseX / viewport.scale) * (1 - 1 / scaleRatio);\n      const newY = viewport.y + (mouseY / viewport.scale) * (1 - 1 / scaleRatio);\n\n      onViewportChange({\n        ...viewport,\n        x: newX,\n        y: newY,\n        scale: newScale,\n      });\n    },\n    [viewport, onViewportChange]\n  );\n\n  // Touch handlers for mobile\n  const handleTouchStart = useCallback((e: TouchEvent) => {\n    if (e.touches.length === 1) {\n      setIsPanning(true);\n      setLastPanPoint({\n        x: e.touches[0].clientX,\n        y: e.touches[0].clientY,\n      });\n    }\n  }, []);\n\n  const handleTouchMove = useCallback(\n    (e: TouchEvent) => {\n      if (!isPanning || !lastPanPoint || e.touches.length !== 1) return;\n\n      const dx = e.touches[0].clientX - lastPanPoint.x;\n      const dy = e.touches[0].clientY - lastPanPoint.y;\n\n      onViewportChange({\n        ...viewport,\n        x: viewport.x - dx / viewport.scale,\n        y: viewport.y - dy / viewport.scale,\n      });\n\n      setLastPanPoint({\n        x: e.touches[0].clientX,\n        y: e.touches[0].clientY,\n      });\n    },\n    [isPanning, lastPanPoint, viewport, onViewportChange]\n  );\n\n  const handleTouchEnd = useCallback(() => {\n    setIsPanning(false);\n    setLastPanPoint(null);\n  }, []);\n\n  // Node interaction handlers\n  const handleNodeClick = useCallback(\n    (node: GraphNode, e: MouseEvent) => {\n      e.stopPropagation();\n      onNodeClick?.({\n        nodeId: node.id,\n        type: 'click',\n        position: { x: e.clientX, y: e.clientY },\n        originalEvent: e.nativeEvent,\n      });\n    },\n    [onNodeClick]\n  );\n\n  const handleNodeHover = useCallback(\n    (node: GraphNode | null, e?: MouseEvent) => {\n      setHoveredNodeId(node?.id ?? null);\n      if (node && e) {\n        onNodeHover?.({\n          nodeId: node.id,\n          type: 'hover',\n          position: { x: e.clientX, y: e.clientY },\n          originalEvent: e.nativeEvent,\n        });\n      } else {\n        onNodeHover?.(null);\n      }\n    },\n    [onNodeHover]\n  );\n\n  // Calculate transform\n  const transform = `translate(${viewport.width / 2 - viewport.x * viewport.scale}, ${\n    viewport.height / 2 - viewport.y * viewport.scale\n  }) scale(${viewport.scale})`;\n\n  // Viewport culling - only render visible nodes\n  const visibleNodes = nodes.filter((node) => {\n    const screenX = (node.x - viewport.x) * viewport.scale + viewport.width / 2;\n    const screenY = (node.y - viewport.y) * viewport.scale + viewport.height / 2;\n    const margin = Math.max(node.width, node.height) * viewport.scale;\n\n    return (\n      screenX > -margin &&\n      screenX < viewport.width + margin &&\n      screenY > -margin &&\n      screenY < viewport.height + margin\n    );\n  });\n\n  // Filter edges to only those connected to visible nodes\n  const visibleNodeIds = new Set(visibleNodes.map((n) => n.id));\n  const visibleEdges = edges.filter(\n    (edge) =>\n      visibleNodeIds.has(edge.sourceId) || visibleNodeIds.has(edge.targetId)\n  );\n\n  return (\n    <div\n      ref={containerRef}\n      className={`relative w-full h-full overflow-hidden bg-neutral-50 ${className}`}\n      onMouseDown={handleMouseDown}\n      onMouseMove={handleMouseMove}\n      onMouseUp={handleMouseUp}\n      onMouseLeave={handleMouseUp}\n      onWheel={handleWheel}\n      onTouchStart={handleTouchStart}\n      onTouchMove={handleTouchMove}\n      onTouchEnd={handleTouchEnd}\n      style={{ cursor: isPanning ? 'grabbing' : 'grab' }}\n    >\n      <svg\n        ref={svgRef}\n        width={viewport.width}\n        height={viewport.height}\n        className=\"absolute inset-0\"\n      >\n        <defs>\n          {/* Drop shadow filter */}\n          <filter id=\"node-shadow\" x=\"-20%\" y=\"-20%\" width=\"140%\" height=\"140%\">\n            <feDropShadow\n              dx=\"0\"\n              dy=\"2\"\n              stdDeviation=\"4\"\n              floodColor=\"#000\"\n              floodOpacity=\"0.1\"\n            />\n          </filter>\n\n          {/* Gradient for edges */}\n          <linearGradient id=\"edge-gradient\" x1=\"0%\" y1=\"0%\" x2=\"0%\" y2=\"100%\">\n            <stop offset=\"0%\" stopColor=\"#a3a3a3\" />\n            <stop offset=\"100%\" stopColor=\"#d4d4d4\" />\n          </linearGradient>\n        </defs>\n\n        <g transform={transform}>\n          {/* Render edges first (below nodes) */}\n          {visibleEdges.map((edge) => (\n            <EdgeRenderer key={edge.id} edge={edge} />\n          ))}\n\n          {/* Render nodes */}\n          {visibleNodes.map((node) => {\n            const isSelected = options.selectedNodeId === node.id;\n            const isHighlighted = options.highlightedNodeId === node.id;\n            const isHovered = hoveredNodeId === node.id;\n\n            if (node.type === 'person') {\n              return (\n                <PersonNode\n                  key={node.id}\n                  node={node}\n                  isSelected={isSelected}\n                  isHighlighted={isHighlighted}\n                  isHovered={isHovered}\n                  options={renderOptions}\n                  onClick={(e) => handleNodeClick(node, e)}\n                  onMouseEnter={(e) => handleNodeHover(node, e)}\n                  onMouseLeave={() => handleNodeHover(null)}\n                />\n              );\n            }\n\n            if (node.type === 'union') {\n              return (\n                <UnionNode\n                  key={node.id}\n                  node={node}\n                  isSelected={isSelected}\n                  onClick={(e) => handleNodeClick(node, e)}\n                />\n              );\n            }\n\n            return null;\n          })}\n        </g>\n      </svg>\n\n      {children}\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1735, "column": 0}, "map": {"version":3,"sources":["file:///Users/smsm/Desktop/Portafolio%20IA/arbol-genealogico-digital%202/packages/graph-engine/src/renderer/MiniMap.tsx"],"sourcesContent":["'use client';\n\nimport type { GraphNode, Viewport, Bounds } from '../types';\n\nexport interface MiniMapProps {\n  nodes: GraphNode[];\n  bounds: Bounds;\n  viewport: Viewport;\n  onViewportChange: (viewport: Viewport) => void;\n  width?: number;\n  height?: number;\n  className?: string;\n}\n\nexport function MiniMap({\n  nodes,\n  bounds,\n  viewport,\n  onViewportChange,\n  width = 200,\n  height = 150,\n  className = '',\n}: MiniMapProps) {\n  // Calculate scale to fit bounds in minimap\n  const padding = 10;\n  const availableWidth = width - padding * 2;\n  const availableHeight = height - padding * 2;\n\n  const scaleX = bounds.width > 0 ? availableWidth / bounds.width : 1;\n  const scaleY = bounds.height > 0 ? availableHeight / bounds.height : 1;\n  const scale = Math.min(scaleX, scaleY, 1);\n\n  // Calculate viewport rectangle in minimap coordinates\n  const viewportRect = {\n    x: padding + ((viewport.x - bounds.minX) * scale),\n    y: padding + ((viewport.y - bounds.minY) * scale),\n    width: (viewport.width / viewport.scale) * scale,\n    height: (viewport.height / viewport.scale) * scale,\n  };\n\n  // Handle click on minimap to pan\n  const handleClick = (e: React.MouseEvent<SVGSVGElement>) => {\n    const rect = e.currentTarget.getBoundingClientRect();\n    const clickX = e.clientX - rect.left;\n    const clickY = e.clientY - rect.top;\n\n    // Convert click to graph coordinates\n    const graphX = bounds.minX + (clickX - padding) / scale;\n    const graphY = bounds.minY + (clickY - padding) / scale;\n\n    onViewportChange({\n      ...viewport,\n      x: graphX,\n      y: graphY,\n    });\n  };\n\n  return (\n    <div\n      className={`absolute bottom-4 right-4 bg-white rounded-lg shadow-lg border border-neutral-200 overflow-hidden ${className}`}\n    >\n      <svg\n        width={width}\n        height={height}\n        onClick={handleClick}\n        style={{ cursor: 'crosshair' }}\n      >\n        {/* Background */}\n        <rect x={0} y={0} width={width} height={height} fill=\"#fafafa\" />\n\n        {/* Nodes */}\n        <g transform={`translate(${padding - bounds.minX * scale}, ${padding - bounds.minY * scale}) scale(${scale})`}>\n          {nodes.map((node) => {\n            const nodeColor = node.type === 'person'\n              ? (node.data as any).gender === 'male'\n                ? '#3b82f6'\n                : (node.data as any).gender === 'female'\n                ? '#ec4899'\n                : '#6b7280'\n              : '#22c55e';\n\n            return (\n              <rect\n                key={node.id}\n                x={node.x - node.width / 2}\n                y={node.y - node.height / 2}\n                width={node.width}\n                height={node.height}\n                rx={node.type === 'person' ? 4 : node.width / 2}\n                fill={nodeColor}\n                opacity={0.7}\n              />\n            );\n          })}\n        </g>\n\n        {/* Viewport indicator */}\n        <rect\n          x={viewportRect.x}\n          y={viewportRect.y}\n          width={Math.max(viewportRect.width, 20)}\n          height={Math.max(viewportRect.height, 15)}\n          fill=\"rgba(14, 165, 233, 0.2)\"\n          stroke=\"#0ea5e9\"\n          strokeWidth={2}\n          rx={2}\n        />\n\n        {/* Border */}\n        <rect\n          x={0.5}\n          y={0.5}\n          width={width - 1}\n          height={height - 1}\n          fill=\"none\"\n          stroke=\"#e5e5e5\"\n          rx={8}\n        />\n      </svg>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAAA;;AAcO,SAAS,QAAQ,EACtB,KAAK,EACL,MAAM,EACN,QAAQ,EACR,gBAAgB,EAChB,QAAQ,GAAG,EACX,SAAS,GAAG,EACZ,YAAY,EAAE,EACD;IACb,2CAA2C;IAC3C,MAAM,UAAU;IAChB,MAAM,iBAAiB,QAAQ,UAAU;IACzC,MAAM,kBAAkB,SAAS,UAAU;IAE3C,MAAM,SAAS,OAAO,KAAK,GAAG,IAAI,iBAAiB,OAAO,KAAK,GAAG;IAClE,MAAM,SAAS,OAAO,MAAM,GAAG,IAAI,kBAAkB,OAAO,MAAM,GAAG;IACrE,MAAM,QAAQ,KAAK,GAAG,CAAC,QAAQ,QAAQ;IAEvC,sDAAsD;IACtD,MAAM,eAAe;QACnB,GAAG,UAAW,CAAC,SAAS,CAAC,GAAG,OAAO,IAAI,IAAI;QAC3C,GAAG,UAAW,CAAC,SAAS,CAAC,GAAG,OAAO,IAAI,IAAI;QAC3C,OAAO,AAAC,SAAS,KAAK,GAAG,SAAS,KAAK,GAAI;QAC3C,QAAQ,AAAC,SAAS,MAAM,GAAG,SAAS,KAAK,GAAI;IAC/C;IAEA,iCAAiC;IACjC,MAAM,cAAc,CAAC;QACnB,MAAM,OAAO,EAAE,aAAa,CAAC,qBAAqB;QAClD,MAAM,SAAS,EAAE,OAAO,GAAG,KAAK,IAAI;QACpC,MAAM,SAAS,EAAE,OAAO,GAAG,KAAK,GAAG;QAEnC,qCAAqC;QACrC,MAAM,SAAS,OAAO,IAAI,GAAG,CAAC,SAAS,OAAO,IAAI;QAClD,MAAM,SAAS,OAAO,IAAI,GAAG,CAAC,SAAS,OAAO,IAAI;QAElD,iBAAiB;YACf,GAAG,QAAQ;YACX,GAAG;YACH,GAAG;QACL;IACF;IAEA,qBACE,8OAAC;QACC,WAAW,CAAC,kGAAkG,EAAE,WAAW;kBAE3H,cAAA,8OAAC;YACC,OAAO;YACP,QAAQ;YACR,SAAS;YACT,OAAO;gBAAE,QAAQ;YAAY;;8BAG7B,8OAAC;oBAAK,GAAG;oBAAG,GAAG;oBAAG,OAAO;oBAAO,QAAQ;oBAAQ,MAAK;;;;;;8BAGrD,8OAAC;oBAAE,WAAW,CAAC,UAAU,EAAE,UAAU,OAAO,IAAI,GAAG,MAAM,EAAE,EAAE,UAAU,OAAO,IAAI,GAAG,MAAM,QAAQ,EAAE,MAAM,CAAC,CAAC;8BAC1G,MAAM,GAAG,CAAC,CAAC;wBACV,MAAM,YAAY,KAAK,IAAI,KAAK,WAC5B,AAAC,KAAK,IAAI,CAAS,MAAM,KAAK,SAC5B,YACA,AAAC,KAAK,IAAI,CAAS,MAAM,KAAK,WAC9B,YACA,YACF;wBAEJ,qBACE,8OAAC;4BAEC,GAAG,KAAK,CAAC,GAAG,KAAK,KAAK,GAAG;4BACzB,GAAG,KAAK,CAAC,GAAG,KAAK,MAAM,GAAG;4BAC1B,OAAO,KAAK,KAAK;4BACjB,QAAQ,KAAK,MAAM;4BACnB,IAAI,KAAK,IAAI,KAAK,WAAW,IAAI,KAAK,KAAK,GAAG;4BAC9C,MAAM;4BACN,SAAS;2BAPJ,KAAK,EAAE;;;;;oBAUlB;;;;;;8BAIF,8OAAC;oBACC,GAAG,aAAa,CAAC;oBACjB,GAAG,aAAa,CAAC;oBACjB,OAAO,KAAK,GAAG,CAAC,aAAa,KAAK,EAAE;oBACpC,QAAQ,KAAK,GAAG,CAAC,aAAa,MAAM,EAAE;oBACtC,MAAK;oBACL,QAAO;oBACP,aAAa;oBACb,IAAI;;;;;;8BAIN,8OAAC;oBACC,GAAG;oBACH,GAAG;oBACH,OAAO,QAAQ;oBACf,QAAQ,SAAS;oBACjB,MAAK;oBACL,QAAO;oBACP,IAAI;;;;;;;;;;;;;;;;;AAKd"}},
    {"offset": {"line": 1858, "column": 0}, "map": {"version":3,"sources":["file:///Users/smsm/Desktop/Portafolio%20IA/arbol-genealogico-digital%202/packages/graph-engine/src/renderer/index.ts"],"sourcesContent":["export { GraphCanvas, type GraphCanvasProps } from './GraphCanvas';\nexport { PersonNode, type PersonNodeProps } from './PersonNode';\nexport { UnionNode, type UnionNodeProps } from './UnionNode';\nexport { EdgeRenderer, EdgeGroup, type EdgeRendererProps } from './EdgeRenderer';\nexport { MiniMap, type MiniMapProps } from './MiniMap';\n"],"names":[],"mappings":";AAAA;AACA;AACA;AACA;AACA"}},
    {"offset": {"line": 1873, "column": 0}, "map": {"version":3,"sources":["file:///Users/smsm/Desktop/Portafolio%20IA/arbol-genealogico-digital%202/packages/graph-engine/src/genogram/GenogramView.tsx"],"sourcesContent":["'use client';\n\nimport { useMemo } from 'react';\nimport type {\n  GraphData,\n  GraphNode,\n  Viewport,\n  GenogramOptions,\n  MedicalCondition,\n} from '../types';\nimport { createSugiyamaLayout } from '../layout/SugiyamaLayout';\nimport { GraphCanvas } from '../renderer/GraphCanvas';\n\nexport interface GenogramViewProps {\n  data: GraphData;\n  viewport: Viewport;\n  onViewportChange: (viewport: Viewport) => void;\n  onNodeClick?: (nodeId: string) => void;\n  options?: Partial<GenogramOptions>;\n  className?: string;\n}\n\nconst DEFAULT_OPTIONS: GenogramOptions = {\n  showPhotos: false,\n  showDates: true,\n  showMedicalIcons: true,\n  showDeceased: true,\n  animationsEnabled: true,\n  showRelationshipLines: true,\n  showMedicalConditions: true,\n  legendVisible: true,\n};\n\nconst CONDITION_COLORS: Record<string, string> = {\n  cardiovascular: '#ef4444',\n  cancer: '#8b5cf6',\n  metabolic: '#f59e0b',\n  neurological: '#3b82f6',\n  mental_health: '#10b981',\n  autoimmune: '#ec4899',\n  genetic: '#6366f1',\n};\n\nexport function GenogramView({\n  data,\n  viewport,\n  onViewportChange,\n  onNodeClick,\n  options = {},\n  className = '',\n}: GenogramViewProps) {\n  const genogramOptions = { ...DEFAULT_OPTIONS, ...options };\n\n  // Compute layout\n  const layout = useMemo(() => {\n    const layoutEngine = createSugiyamaLayout({\n      nodeWidth: 120,\n      nodeHeight: 80,\n      horizontalSpacing: 80,\n      verticalSpacing: 100,\n    });\n    return layoutEngine.compute(data);\n  }, [data]);\n\n  // Extract all medical conditions for legend\n  const allConditions = useMemo(() => {\n    const conditions = new Map<string, { category: string; count: number }>();\n\n    for (const person of data.persons) {\n      if (person.medicalConditions) {\n        for (const condition of person.medicalConditions) {\n          const existing = conditions.get(condition.category);\n          if (existing) {\n            existing.count++;\n          } else {\n            conditions.set(condition.category, {\n              category: condition.category,\n              count: 1,\n            });\n          }\n        }\n      }\n    }\n\n    return Array.from(conditions.values());\n  }, [data.persons]);\n\n  const handleNodeClick = (interaction: { nodeId: string }) => {\n    // Extract person ID from node ID\n    const personId = interaction.nodeId.replace('person-', '');\n    onNodeClick?.(personId);\n  };\n\n  return (\n    <div className={`relative w-full h-full ${className}`}>\n      <GraphCanvas\n        nodes={layout.nodes}\n        edges={layout.edges}\n        bounds={layout.bounds}\n        viewport={viewport}\n        onViewportChange={onViewportChange}\n        onNodeClick={handleNodeClick}\n        options={{\n          ...genogramOptions,\n          showPhotos: false, // Genograms use symbols, not photos\n        }}\n      />\n\n      {/* Medical condition legend */}\n      {genogramOptions.legendVisible && allConditions.length > 0 && (\n        <div className=\"absolute top-4 left-4 bg-white rounded-lg shadow-lg border border-neutral-200 p-4\">\n          <h4 className=\"text-sm font-semibold text-neutral-700 mb-3\">\n            Medical Conditions\n          </h4>\n          <div className=\"space-y-2\">\n            {allConditions.map(({ category, count }) => (\n              <div key={category} className=\"flex items-center gap-2\">\n                <span\n                  className=\"w-3 h-3 rounded-full\"\n                  style={{ backgroundColor: CONDITION_COLORS[category] }}\n                />\n                <span className=\"text-sm text-neutral-600 capitalize\">\n                  {category.replace('_', ' ')}\n                </span>\n                <span className=\"text-xs text-neutral-400\">({count})</span>\n              </div>\n            ))}\n          </div>\n        </div>\n      )}\n\n      {/* Symbol legend */}\n      {genogramOptions.legendVisible && (\n        <div className=\"absolute bottom-4 left-4 bg-white rounded-lg shadow-lg border border-neutral-200 p-4\">\n          <h4 className=\"text-sm font-semibold text-neutral-700 mb-3\">Symbols</h4>\n          <div className=\"space-y-2\">\n            <div className=\"flex items-center gap-2\">\n              <svg width=\"20\" height=\"20\" viewBox=\"0 0 20 20\">\n                <rect x=\"2\" y=\"2\" width=\"16\" height=\"16\" fill=\"none\" stroke=\"#3b82f6\" strokeWidth=\"2\" />\n              </svg>\n              <span className=\"text-sm text-neutral-600\">Male</span>\n            </div>\n            <div className=\"flex items-center gap-2\">\n              <svg width=\"20\" height=\"20\" viewBox=\"0 0 20 20\">\n                <circle cx=\"10\" cy=\"10\" r=\"8\" fill=\"none\" stroke=\"#ec4899\" strokeWidth=\"2\" />\n              </svg>\n              <span className=\"text-sm text-neutral-600\">Female</span>\n            </div>\n            <div className=\"flex items-center gap-2\">\n              <svg width=\"20\" height=\"20\" viewBox=\"0 0 20 20\">\n                <polygon points=\"10,2 18,10 10,18 2,10\" fill=\"none\" stroke=\"#6b7280\" strokeWidth=\"2\" />\n              </svg>\n              <span className=\"text-sm text-neutral-600\">Other</span>\n            </div>\n            <div className=\"flex items-center gap-2\">\n              <svg width=\"20\" height=\"20\" viewBox=\"0 0 20 20\">\n                <rect x=\"2\" y=\"2\" width=\"16\" height=\"16\" fill=\"#f5f5f5\" stroke=\"#9ca3af\" strokeWidth=\"2\" />\n                <line x1=\"2\" y1=\"2\" x2=\"18\" y2=\"18\" stroke=\"#9ca3af\" strokeWidth=\"1.5\" />\n              </svg>\n              <span className=\"text-sm text-neutral-600\">Deceased</span>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2234, "column": 0}, "map": {"version":3,"sources":["file:///Users/smsm/Desktop/Portafolio%20IA/arbol-genealogico-digital%202/packages/graph-engine/src/index.ts"],"sourcesContent":["// Types\nexport * from './types';\n\n// Core\nexport { Graph } from './core/Graph';\n\n// Layout\nexport {\n  SugiyamaLayout,\n  createSugiyamaLayout,\n} from './layout/SugiyamaLayout';\nexport {\n  assignGenerations,\n  groupByGeneration,\n  getSortedGenerations,\n  type GenerationAssignment,\n} from './layout/GenerationAssigner';\n\n// Renderer\nexport {\n  GraphCanvas,\n  type GraphCanvasProps,\n  PersonNode,\n  type PersonNodeProps,\n  UnionNode,\n  type UnionNodeProps,\n  EdgeRenderer,\n  EdgeGroup,\n  type EdgeRendererProps,\n  MiniMap,\n  type MiniMapProps,\n} from './renderer';\n\n// Genogram\nexport { GenogramView, type GenogramViewProps } from './genogram/GenogramView';\n"],"names":[],"mappings":";AAAA,QAAQ;AACR;AAEA,OAAO;AACP;AAEA,SAAS;AACT;AAIA;AAOA,WAAW;AACX;AAcA,WAAW;AACX"}},
    {"offset": {"line": 2256, "column": 0}, "map": {"version":3,"sources":["file:///Users/smsm/Desktop/Portafolio%20IA/arbol-genealogico-digital%202/apps/web/src/hooks/useTreeLayout.ts"],"sourcesContent":["'use client';\n\nimport { useMemo } from 'react';\nimport {\n  createSugiyamaLayout,\n  type GraphData,\n  type GraphNode,\n  type GraphEdge,\n  type Bounds,\n  type LayoutConfig,\n} from '@kintree/graph-engine';\n\nexport interface UseTreeLayoutOptions {\n  config?: Partial<LayoutConfig>;\n  rootPersonId?: string;\n}\n\nexport interface UseTreeLayoutResult {\n  nodes: GraphNode[];\n  edges: GraphEdge[];\n  bounds: Bounds;\n  generations: number;\n  isLoading: boolean;\n}\n\n/**\n * Hook to compute tree layout using Sugiyama algorithm\n */\nexport function useTreeLayout(\n  data: GraphData | null,\n  options: UseTreeLayoutOptions = {}\n): UseTreeLayoutResult {\n  const { config, rootPersonId } = options;\n\n  const result = useMemo(() => {\n    if (!data || !data.persons || data.persons.length === 0) {\n      return {\n        nodes: [],\n        edges: [],\n        bounds: { minX: 0, minY: 0, maxX: 0, maxY: 0, width: 0, height: 0 },\n        generations: 0,\n        isLoading: false,\n      };\n    }\n\n    const layout = createSugiyamaLayout({\n      ...config,\n      rootPersonId,\n    });\n\n    const layoutResult = layout.compute(data);\n\n    return {\n      ...layoutResult,\n      generations: (layoutResult as any).generations || 0,\n      isLoading: false,\n    };\n  }, [data, config, rootPersonId]);\n\n  return result;\n}\n\n/**\n * Create mock graph data for testing\n */\nexport function createMockGraphData(): GraphData {\n  return {\n    persons: [\n      // Grandparents - Paternal\n      {\n        id: 'gp1',\n        firstName: 'Roberto',\n        lastName: 'Garca',\n        gender: 'male',\n        birthDate: '1940-05-12',\n        isLiving: false,\n      },\n      {\n        id: 'gp2',\n        firstName: 'Mara',\n        lastName: 'Lpez',\n        gender: 'female',\n        birthDate: '1945-08-23',\n        isLiving: false,\n      },\n      // Grandparents - Maternal\n      {\n        id: 'gp3',\n        firstName: 'Jos',\n        lastName: 'Martnez',\n        gender: 'male',\n        birthDate: '1942-03-15',\n        isLiving: false,\n      },\n      {\n        id: 'gp4',\n        firstName: 'Carmen',\n        lastName: 'Hernndez',\n        gender: 'female',\n        birthDate: '1948-11-30',\n        isLiving: true,\n      },\n      // Parents\n      {\n        id: 'p1',\n        firstName: 'Juan',\n        lastName: 'Garca',\n        gender: 'male',\n        birthDate: '1970-02-28',\n        isLiving: true,\n      },\n      {\n        id: 'p2',\n        firstName: 'Ana',\n        lastName: 'Martnez',\n        gender: 'female',\n        birthDate: '1972-07-14',\n        isLiving: true,\n      },\n      // Children\n      {\n        id: 'c1',\n        firstName: 'Carlos',\n        lastName: 'Garca',\n        gender: 'male',\n        birthDate: '1998-12-05',\n        isLiving: true,\n      },\n      {\n        id: 'c2',\n        firstName: 'Sofa',\n        lastName: 'Garca',\n        gender: 'female',\n        birthDate: '2002-03-18',\n        isLiving: true,\n      },\n    ],\n    unions: [\n      // Paternal grandparents union\n      {\n        id: 'u1',\n        partner1Id: 'gp1',\n        partner2Id: 'gp2',\n        unionType: 'marriage',\n        startDate: '1965-06-20',\n        childrenIds: ['p1'],\n      },\n      // Maternal grandparents union\n      {\n        id: 'u2',\n        partner1Id: 'gp3',\n        partner2Id: 'gp4',\n        unionType: 'marriage',\n        startDate: '1968-09-15',\n        childrenIds: ['p2'],\n      },\n      // Parents union\n      {\n        id: 'u3',\n        partner1Id: 'p1',\n        partner2Id: 'p2',\n        unionType: 'marriage',\n        startDate: '1995-04-10',\n        childrenIds: ['c1', 'c2'],\n      },\n    ],\n    relationships: [\n      // Parent-child relationships for p1\n      { id: 'r1', personId: 'gp1', relatedPersonId: 'p1', type: 'parent' },\n      { id: 'r2', personId: 'gp2', relatedPersonId: 'p1', type: 'parent' },\n      // Parent-child relationships for p2\n      { id: 'r3', personId: 'gp3', relatedPersonId: 'p2', type: 'parent' },\n      { id: 'r4', personId: 'gp4', relatedPersonId: 'p2', type: 'parent' },\n      // Parent-child relationships for children\n      { id: 'r5', personId: 'p1', relatedPersonId: 'c1', type: 'parent' },\n      { id: 'r6', personId: 'p2', relatedPersonId: 'c1', type: 'parent' },\n      { id: 'r7', personId: 'p1', relatedPersonId: 'c2', type: 'parent' },\n      { id: 'r8', personId: 'p2', relatedPersonId: 'c2', type: 'parent' },\n      // Sibling relationship\n      { id: 'r9', personId: 'c1', relatedPersonId: 'c2', type: 'sibling' },\n    ],\n  };\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2478, "column": 0}, "map": {"version":3,"sources":["file:///Users/smsm/Desktop/Portafolio%20IA/arbol-genealogico-digital%202/apps/web/src/hooks/useFamilyTree.ts"],"sourcesContent":["'use client';\n\nimport { useEffect, useCallback, useState, useMemo } from 'react';\nimport { useFamilyStore } from '@/stores/familyStore';\nimport { createClient } from '@/lib/supabase';\nimport type { GraphData, GraphPerson, GraphUnion, GraphRelationship } from '@kintree/graph-engine';\nimport type { Gender } from '@kintree/shared';\n\nexport interface Person {\n  id: string;\n  familyId: string;\n  firstName: string;\n  middleNames?: string[];\n  lastName?: string;\n  maidenName?: string;\n  nicknames?: string[];\n  birthDate?: string;\n  birthDateApproximate?: boolean;\n  birthPlace?: string;\n  deathDate?: string;\n  deathDateApproximate?: boolean;\n  deathPlace?: string;\n  gender: Gender;\n  isLiving: boolean;\n  biography?: string;\n  photoUrl?: string;\n  medicalConditions?: any[];\n  linkedUserId?: string;\n  createdAt: string;\n}\n\nexport interface Union {\n  id: string;\n  familyId: string;\n  partner1Id: string;\n  partner2Id?: string;\n  unionType: string;\n  startDate?: string;\n  endDate?: string;\n  location?: string;\n  children: string[];\n}\n\nexport interface Relationship {\n  id: string;\n  familyId: string;\n  person1Id: string;\n  person2Id: string;\n  relationshipType: string;\n  isBiological: boolean;\n}\n\nexport interface MedicalCondition {\n  id: string;\n  name: string;\n  severity?: 'mild' | 'moderate' | 'severe';\n  diagnosed?: string; // Date of diagnosis\n  notes?: string;\n}\n\nexport interface CreatePersonInput {\n  firstName: string;\n  lastName?: string;\n  gender: Gender;\n  birthDate?: string;\n  isLiving?: boolean;\n  photoUrl?: string;\n  medicalConditions?: MedicalCondition[];\n}\n\nexport type RelationshipTypeOption =\n  | 'self'           // Root person (me)\n  | 'father'\n  | 'mother'\n  | 'spouse'\n  | 'son'\n  | 'daughter'\n  | 'brother'\n  | 'sister'\n  | 'grandfather_paternal'\n  | 'grandmother_paternal'\n  | 'grandfather_maternal'\n  | 'grandmother_maternal'\n  | 'uncle'\n  | 'aunt'\n  | 'cousin';\n\nexport interface CreatePersonWithRelationshipInput extends CreatePersonInput {\n  relationshipType: RelationshipTypeOption;\n  relatedToPersonId?: string; // The person this new person is related to\n}\n\nexport function useFamilyTree() {\n  const currentFamily = useFamilyStore((state) => state.currentFamily);\n  const supabase = useMemo(() => createClient(), []);\n  const [persons, setPersons] = useState<Person[]>([]);\n  const [unions, setUnions] = useState<Union[]>([]);\n  const [relationships, setRelationships] = useState<Relationship[]>([]);\n  const [isLoading, setIsLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n\n  // Fetch all data when family changes\n  useEffect(() => {\n    if (currentFamily?.id) {\n      fetchTreeData(currentFamily.id);\n    } else {\n      setPersons([]);\n      setUnions([]);\n      setRelationships([]);\n      setIsLoading(false);\n    }\n  }, [currentFamily?.id]);\n\n  const fetchTreeData = useCallback(async (familyId: string) => {\n    setIsLoading(true);\n    setError(null);\n\n    try {\n      // Fetch persons\n      const { data: personsData, error: personsError } = await supabase\n        .from('persons')\n        .select('*')\n        .eq('family_id', familyId)\n        .order('created_at', { ascending: true });\n\n      if (personsError) throw personsError;\n\n      // Fetch unions\n      const { data: unionsData, error: unionsError } = await supabase\n        .from('unions')\n        .select('*')\n        .eq('family_id', familyId);\n\n      if (unionsError) throw unionsError;\n\n      // Fetch union children\n      const { data: childrenData, error: childrenError } = await supabase\n        .from('union_children')\n        .select('union_id, child_id')\n        .in('union_id', (unionsData || []).map((u: any) => u.id));\n\n      if (childrenError) throw childrenError;\n\n      // Fetch relationships\n      const { data: relationshipsData, error: relError } = await supabase\n        .from('relationships')\n        .select('*')\n        .eq('family_id', familyId);\n\n      if (relError) throw relError;\n\n      // Map data\n      const personsList: Person[] = (personsData || []).map((p: any) => ({\n        id: p.id,\n        familyId: p.family_id,\n        firstName: p.first_name,\n        middleNames: p.middle_names,\n        lastName: p.last_name,\n        maidenName: p.maiden_name,\n        nicknames: p.nicknames,\n        birthDate: p.birth_date,\n        birthDateApproximate: p.birth_date_approximate,\n        birthPlace: p.birth_place,\n        deathDate: p.death_date,\n        deathDateApproximate: p.death_date_approximate,\n        deathPlace: p.death_place,\n        gender: p.gender as Gender,\n        isLiving: p.is_living,\n        biography: p.biography,\n        photoUrl: p.photo_url,\n        medicalConditions: p.medical_conditions,\n        linkedUserId: p.linked_user_id,\n        createdAt: p.created_at,\n      }));\n\n      // Group children by union\n      const childrenByUnion = new Map<string, string[]>();\n      (childrenData || []).forEach((c: any) => {\n        const existing = childrenByUnion.get(c.union_id) || [];\n        existing.push(c.child_id);\n        childrenByUnion.set(c.union_id, existing);\n      });\n\n      const unionsList: Union[] = (unionsData || []).map((u: any) => ({\n        id: u.id,\n        familyId: u.family_id,\n        partner1Id: u.partner1_id,\n        partner2Id: u.partner2_id,\n        unionType: u.union_type,\n        startDate: u.start_date,\n        endDate: u.end_date,\n        location: u.location,\n        children: childrenByUnion.get(u.id) || [],\n      }));\n\n      const relationshipsList: Relationship[] = (relationshipsData || []).map((r: any) => ({\n        id: r.id,\n        familyId: r.family_id,\n        person1Id: r.person1_id,\n        person2Id: r.person2_id,\n        relationshipType: r.relationship_type,\n        isBiological: r.is_biological,\n      }));\n\n      setPersons(personsList);\n      setUnions(unionsList);\n      setRelationships(relationshipsList);\n    } catch (err) {\n      console.error('Error fetching tree data:', err);\n      setError('Error loading family tree');\n    } finally {\n      setIsLoading(false);\n    }\n  }, []);\n\n  // Convert to GraphData format for the layout engine\n  const graphData: GraphData = useMemo(() => {\n    const graphPersons: GraphPerson[] = persons.map(p => ({\n      id: p.id,\n      firstName: p.firstName,\n      lastName: p.lastName || '',\n      gender: p.gender,\n      birthDate: p.birthDate,\n      birthDateApproximate: p.birthDateApproximate,\n      deathDate: p.deathDate,\n      deathDateApproximate: p.deathDateApproximate,\n      photoUrl: p.photoUrl,\n      isLiving: p.isLiving,\n      medicalConditions: p.medicalConditions,\n    }));\n\n    const graphUnions: GraphUnion[] = unions.map(u => ({\n      id: u.id,\n      partner1Id: u.partner1Id,\n      partner2Id: u.partner2Id || '',\n      unionType: u.unionType as any,\n      startDate: u.startDate,\n      endDate: u.endDate,\n      childrenIds: u.children,\n    }));\n\n    const graphRelationships: GraphRelationship[] = relationships.map(r => ({\n      id: r.id,\n      personId: r.person1Id,\n      relatedPersonId: r.person2Id,\n      type: r.relationshipType === 'parent_child' ? 'parent' : r.relationshipType as any,\n    }));\n\n    return {\n      persons: graphPersons,\n      unions: graphUnions,\n      relationships: graphRelationships,\n    };\n  }, [persons, unions, relationships]);\n\n  // CRUD operations\n  const createPerson = useCallback(async (input: CreatePersonInput): Promise<Person | null> => {\n    if (!currentFamily?.id) return null;\n\n    const { data: userData } = await supabase.auth.getUser();\n    if (!userData.user) return null;\n\n    try {\n      const { data, error } = await supabase\n        .from('persons')\n        .insert({\n          family_id: currentFamily.id,\n          first_name: input.firstName,\n          last_name: input.lastName,\n          gender: input.gender,\n          birth_date: input.birthDate,\n          is_living: input.isLiving ?? true,\n          photo_url: input.photoUrl,\n          created_by: userData.user.id,\n        })\n        .select()\n        .single();\n\n      if (error) throw error;\n\n      const newPerson: Person = {\n        id: data.id,\n        familyId: data.family_id,\n        firstName: data.first_name,\n        lastName: data.last_name,\n        gender: data.gender as Gender,\n        birthDate: data.birth_date,\n        isLiving: data.is_living,\n        photoUrl: data.photo_url,\n        createdAt: data.created_at,\n      };\n\n      setPersons(prev => [...prev, newPerson]);\n      return newPerson;\n    } catch (err) {\n      console.error('Error creating person:', err);\n      setError('Error creating person');\n      return null;\n    }\n  }, [currentFamily?.id]);\n\n  const updatePerson = useCallback(async (personId: string, updates: Partial<CreatePersonInput>): Promise<boolean> => {\n    try {\n      const updateData: Record<string, any> = {};\n      if (updates.firstName !== undefined) updateData.first_name = updates.firstName;\n      if (updates.lastName !== undefined) updateData.last_name = updates.lastName;\n      if (updates.gender !== undefined) updateData.gender = updates.gender;\n      if (updates.birthDate !== undefined) updateData.birth_date = updates.birthDate;\n      if (updates.isLiving !== undefined) updateData.is_living = updates.isLiving;\n      if (updates.photoUrl !== undefined) updateData.photo_url = updates.photoUrl;\n\n      const { error } = await supabase\n        .from('persons')\n        .update(updateData)\n        .eq('id', personId);\n\n      if (error) throw error;\n\n      // Refresh data\n      if (currentFamily?.id) {\n        await fetchTreeData(currentFamily.id);\n      }\n\n      return true;\n    } catch (err) {\n      console.error('Error updating person:', err);\n      return false;\n    }\n  }, [currentFamily?.id, fetchTreeData]);\n\n  const deletePerson = useCallback(async (personId: string): Promise<boolean> => {\n    try {\n      const { error } = await supabase\n        .from('persons')\n        .delete()\n        .eq('id', personId);\n\n      if (error) throw error;\n\n      setPersons(prev => prev.filter(p => p.id !== personId));\n      return true;\n    } catch (err) {\n      console.error('Error deleting person:', err);\n      return false;\n    }\n  }, []);\n\n  const createUnion = useCallback(async (\n    partner1Id: string,\n    partner2Id: string | null,\n    type: string = 'marriage'\n  ): Promise<Union | null> => {\n    if (!currentFamily?.id) return null;\n\n    const { data: userData } = await supabase.auth.getUser();\n    if (!userData.user) return null;\n\n    try {\n      const { data, error } = await supabase\n        .from('unions')\n        .insert({\n          family_id: currentFamily.id,\n          partner1_id: partner1Id,\n          partner2_id: partner2Id,\n          union_type: type,\n          created_by: userData.user.id,\n        })\n        .select()\n        .single();\n\n      if (error) throw error;\n\n      const newUnion: Union = {\n        id: data.id,\n        familyId: data.family_id,\n        partner1Id: data.partner1_id,\n        partner2Id: data.partner2_id,\n        unionType: data.union_type,\n        startDate: data.start_date,\n        endDate: data.end_date,\n        location: data.location,\n        children: [],\n      };\n\n      setUnions(prev => [...prev, newUnion]);\n      return newUnion;\n    } catch (err) {\n      console.error('Error creating union:', err);\n      return null;\n    }\n  }, [currentFamily?.id]);\n\n  const addChildToUnion = useCallback(async (unionId: string, childId: string): Promise<boolean> => {\n    try {\n      const { error } = await supabase\n        .from('union_children')\n        .insert({\n          union_id: unionId,\n          child_id: childId,\n        });\n\n      if (error) throw error;\n\n      // Update local state\n      setUnions(prev => prev.map(u =>\n        u.id === unionId\n          ? { ...u, children: [...u.children, childId] }\n          : u\n      ));\n\n      return true;\n    } catch (err) {\n      console.error('Error adding child to union:', err);\n      return false;\n    }\n  }, []);\n\n  const createRelationship = useCallback(async (\n    person1Id: string,\n    person2Id: string,\n    type: string,\n    isBiological: boolean = true\n  ): Promise<boolean> => {\n    if (!currentFamily?.id) return false;\n\n    const { data: userData } = await supabase.auth.getUser();\n    if (!userData.user) return false;\n\n    try {\n      const { error } = await supabase\n        .from('relationships')\n        .insert({\n          family_id: currentFamily.id,\n          person1_id: person1Id,\n          person2_id: person2Id,\n          relationship_type: type,\n          is_biological: isBiological,\n          created_by: userData.user.id,\n        });\n\n      if (error) throw error;\n\n      // Refresh data\n      await fetchTreeData(currentFamily.id);\n      return true;\n    } catch (err) {\n      console.error('Error creating relationship:', err);\n      return false;\n    }\n  }, [currentFamily?.id, fetchTreeData]);\n\n  const getPersonById = useCallback((personId: string): Person | undefined => {\n    return persons.find(p => p.id === personId);\n  }, [persons]);\n\n  const refresh = useCallback(async () => {\n    if (currentFamily?.id) {\n      await fetchTreeData(currentFamily.id);\n    }\n  }, [currentFamily?.id, fetchTreeData]);\n\n  // Get root person (first person added or self-marked person)\n  const getRootPerson = useCallback((): Person | null => {\n    if (persons.length === 0) return null;\n    // For now, return the first person created\n    return persons[0];\n  }, [persons]);\n\n  // Find or create a union between two people\n  const findOrCreateUnion = useCallback(async (\n    partner1Id: string,\n    partner2Id: string | null,\n    type: string = 'marriage'\n  ): Promise<string | null> => {\n    // Look for existing union\n    const existingUnion = unions.find(u =>\n      (u.partner1Id === partner1Id && u.partner2Id === partner2Id) ||\n      (u.partner1Id === partner2Id && u.partner2Id === partner1Id)\n    );\n\n    if (existingUnion) {\n      return existingUnion.id;\n    }\n\n    // Create new union\n    const newUnion = await createUnion(partner1Id, partner2Id, type);\n    return newUnion?.id || null;\n  }, [unions, createUnion]);\n\n  // Get parents of a person\n  const getParentsOfPerson = useCallback((personId: string): { fatherId?: string; motherId?: string; unionId?: string } => {\n    // Find union where this person is a child\n    for (const union of unions) {\n      if (union.children.includes(personId)) {\n        const partner1 = persons.find(p => p.id === union.partner1Id);\n        const partner2 = persons.find(p => p.id === union.partner2Id);\n\n        let fatherId: string | undefined;\n        let motherId: string | undefined;\n\n        if (partner1?.gender === 'male') fatherId = partner1.id;\n        else if (partner1?.gender === 'female') motherId = partner1.id;\n\n        if (partner2?.gender === 'male') fatherId = partner2.id;\n        else if (partner2?.gender === 'female') motherId = partner2.id;\n\n        return { fatherId, motherId, unionId: union.id };\n      }\n    }\n    return {};\n  }, [unions, persons]);\n\n  // Get spouse of a person\n  const getSpouseOfPerson = useCallback((personId: string): Person | null => {\n    for (const union of unions) {\n      if (union.partner1Id === personId && union.partner2Id) {\n        return persons.find(p => p.id === union.partner2Id) || null;\n      }\n      if (union.partner2Id === personId) {\n        return persons.find(p => p.id === union.partner1Id) || null;\n      }\n    }\n    return null;\n  }, [unions, persons]);\n\n  // Create person with relationship - the main function for adding family members\n  const createPersonWithRelationship = useCallback(async (\n    input: CreatePersonWithRelationshipInput\n  ): Promise<Person | null> => {\n    if (!currentFamily?.id) return null;\n\n    const { data: userData } = await supabase.auth.getUser();\n    if (!userData.user) return null;\n\n    try {\n      // First, create the person\n      const { data: personData, error: personError } = await supabase\n        .from('persons')\n        .insert({\n          family_id: currentFamily.id,\n          first_name: input.firstName,\n          last_name: input.lastName,\n          gender: input.gender,\n          birth_date: input.birthDate,\n          is_living: input.isLiving ?? true,\n          photo_url: input.photoUrl,\n          medical_conditions: input.medicalConditions || null,\n          created_by: userData.user.id,\n        })\n        .select()\n        .single();\n\n      if (personError) throw personError;\n\n      const newPersonId = personData.id;\n      const relatedToId = input.relatedToPersonId;\n\n      // Now handle the relationship based on type\n      switch (input.relationshipType) {\n        case 'self':\n          // This is the root person, no relationship needed\n          break;\n\n        case 'father':\n        case 'mother': {\n          // Adding a parent to the related person\n          if (!relatedToId) break;\n\n          // Get existing parents of the related person\n          const existingParents = getParentsOfPerson(relatedToId);\n\n          if (existingParents.unionId) {\n            // Union exists, update it to add this parent as the second partner\n            if (input.relationshipType === 'father' && !existingParents.fatherId) {\n              // If partner1 is already the mother, add father as partner2\n              // Otherwise update partner1\n              const currentUnion = unions.find(u => u.id === existingParents.unionId);\n              if (currentUnion?.partner1Id && !currentUnion?.partner2Id) {\n                await supabase.from('unions').update({ partner2_id: newPersonId }).eq('id', existingParents.unionId);\n              } else {\n                await supabase.from('unions').update({ partner1_id: newPersonId }).eq('id', existingParents.unionId);\n              }\n            } else if (input.relationshipType === 'mother' && !existingParents.motherId) {\n              const currentUnion = unions.find(u => u.id === existingParents.unionId);\n              if (currentUnion?.partner1Id && !currentUnion?.partner2Id) {\n                await supabase.from('unions').update({ partner2_id: newPersonId }).eq('id', existingParents.unionId);\n              } else {\n                await supabase.from('unions').update({ partner1_id: newPersonId }).eq('id', existingParents.unionId);\n              }\n            }\n          } else {\n            // Create new union with new parent and add related person as child\n            // The new parent is always partner1, partner2 will be added later\n            const union = await createUnion(newPersonId, null, 'marriage');\n            if (union) {\n              await addChildToUnion(union.id, relatedToId);\n            }\n          }\n\n          // Create parent-child relationship\n          await createRelationship(newPersonId, relatedToId, 'parent_child', true);\n          break;\n        }\n\n        case 'spouse': {\n          // Adding a spouse to the related person\n          if (!relatedToId) break;\n\n          // Create or find union between them\n          await findOrCreateUnion(relatedToId, newPersonId, 'marriage');\n\n          // Create spouse relationship\n          await createRelationship(relatedToId, newPersonId, 'spouse', false);\n          break;\n        }\n\n        case 'son':\n        case 'daughter': {\n          // Adding a child to the related person\n          if (!relatedToId) break;\n\n          // Find or create union for the parent\n          const spouse = getSpouseOfPerson(relatedToId);\n          let unionId: string | null = null;\n\n          if (spouse) {\n            // Find existing union with spouse\n            unionId = await findOrCreateUnion(relatedToId, spouse.id, 'marriage');\n          } else {\n            // Create single-parent union\n            const union = await createUnion(relatedToId, null, 'other');\n            unionId = union?.id || null;\n          }\n\n          if (unionId) {\n            await addChildToUnion(unionId, newPersonId);\n          }\n\n          // Create parent-child relationship\n          await createRelationship(relatedToId, newPersonId, 'parent_child', true);\n          break;\n        }\n\n        case 'brother':\n        case 'sister': {\n          // Adding a sibling to the related person\n          if (!relatedToId) break;\n\n          // Find the parents union of the related person\n          const existingParents = getParentsOfPerson(relatedToId);\n\n          if (existingParents.unionId) {\n            // Add to same union as sibling (they share the same parents)\n            await addChildToUnion(existingParents.unionId, newPersonId);\n          }\n          // If no parents exist yet, we just create the sibling relationship\n          // Parents can be added later, and both siblings will be linked to them\n\n          // Create sibling relationship\n          await createRelationship(relatedToId, newPersonId, 'sibling', true);\n          break;\n        }\n\n        case 'grandfather_paternal':\n        case 'grandmother_paternal': {\n          // Adding paternal grandparent\n          if (!relatedToId) break;\n\n          const parents = getParentsOfPerson(relatedToId);\n          if (parents.fatherId) {\n            // Add as parent of the father\n            const fatherParents = getParentsOfPerson(parents.fatherId);\n\n            if (fatherParents.unionId) {\n              // Update existing grandparents union - add as second partner\n              const currentUnion = unions.find(u => u.id === fatherParents.unionId);\n              if (currentUnion?.partner1Id && !currentUnion?.partner2Id) {\n                await supabase.from('unions').update({ partner2_id: newPersonId }).eq('id', fatherParents.unionId);\n              } else if (!currentUnion?.partner1Id) {\n                await supabase.from('unions').update({ partner1_id: newPersonId }).eq('id', fatherParents.unionId);\n              }\n            } else {\n              // Create new union and add father as child\n              const union = await createUnion(newPersonId, null, 'marriage');\n              if (union) {\n                await addChildToUnion(union.id, parents.fatherId);\n              }\n            }\n\n            await createRelationship(newPersonId, parents.fatherId, 'parent_child', true);\n          }\n          break;\n        }\n\n        case 'grandfather_maternal':\n        case 'grandmother_maternal': {\n          // Adding maternal grandparent\n          if (!relatedToId) break;\n\n          const parents = getParentsOfPerson(relatedToId);\n          if (parents.motherId) {\n            // Add as parent of the mother\n            const motherParents = getParentsOfPerson(parents.motherId);\n\n            if (motherParents.unionId) {\n              // Update existing grandparents union - add as second partner\n              const currentUnion = unions.find(u => u.id === motherParents.unionId);\n              if (currentUnion?.partner1Id && !currentUnion?.partner2Id) {\n                await supabase.from('unions').update({ partner2_id: newPersonId }).eq('id', motherParents.unionId);\n              } else if (!currentUnion?.partner1Id) {\n                await supabase.from('unions').update({ partner1_id: newPersonId }).eq('id', motherParents.unionId);\n              }\n            } else {\n              // Create new union and add mother as child\n              const union = await createUnion(newPersonId, null, 'marriage');\n              if (union) {\n                await addChildToUnion(union.id, parents.motherId);\n              }\n            }\n\n            await createRelationship(newPersonId, parents.motherId, 'parent_child', true);\n          }\n          break;\n        }\n\n        case 'uncle':\n        case 'aunt': {\n          // Adding uncle/aunt (sibling of parent)\n          if (!relatedToId) break;\n\n          const parents = getParentsOfPerson(relatedToId);\n          const parentId = input.gender === 'male'\n            ? (parents.fatherId || parents.motherId)\n            : (parents.motherId || parents.fatherId);\n\n          if (parentId) {\n            // Find grandparents union\n            const grandparents = getParentsOfPerson(parentId);\n\n            if (grandparents.unionId) {\n              // Add new person as child of grandparents\n              await addChildToUnion(grandparents.unionId, newPersonId);\n              await createRelationship(parentId, newPersonId, 'sibling', true);\n            }\n          }\n          break;\n        }\n\n        case 'cousin': {\n          // Adding a cousin is complex - need to find uncle/aunt first\n          // For now, just add as a person without automatic relationship\n          console.log('Cousin relationship requires manual setup');\n          break;\n        }\n      }\n\n      // Refresh all data\n      await fetchTreeData(currentFamily.id);\n\n      // Return the created person (constructed from the insert response)\n      const createdPerson: Person = {\n        id: personData.id,\n        familyId: personData.family_id,\n        firstName: personData.first_name,\n        lastName: personData.last_name,\n        gender: personData.gender as Gender,\n        birthDate: personData.birth_date,\n        isLiving: personData.is_living,\n        photoUrl: personData.photo_url,\n        medicalConditions: personData.medical_conditions,\n        createdAt: personData.created_at,\n      };\n\n      return createdPerson;\n    } catch (err) {\n      console.error('Error creating person with relationship:', err);\n      setError('Error creating person');\n      return null;\n    }\n  }, [\n    currentFamily?.id,\n    supabase,\n    createUnion,\n    addChildToUnion,\n    createRelationship,\n    getParentsOfPerson,\n    getSpouseOfPerson,\n    findOrCreateUnion,\n    fetchTreeData,\n    persons,\n  ]);\n\n  // Calculate the relationship role of a person relative to the root person\n  const getPersonRole = useCallback((personId: string): string | null => {\n    const root = getRootPerson();\n    if (!root) return null;\n    if (personId === root.id) return 'Me';\n\n    const person = persons.find(p => p.id === personId);\n    if (!person) return null;\n\n    // Get parents of root person\n    const rootParents = getParentsOfPerson(root.id);\n\n    // Check if person is parent of root\n    if (rootParents.fatherId === personId) return 'Father';\n    if (rootParents.motherId === personId) return 'Mother';\n\n    // Check if person is spouse of root\n    const rootSpouse = getSpouseOfPerson(root.id);\n    if (rootSpouse?.id === personId) {\n      return person.gender === 'male' ? 'Husband' : 'Wife';\n    }\n\n    // Check if person is child of root (root is parent in a union)\n    for (const union of unions) {\n      if (union.partner1Id === root.id || union.partner2Id === root.id) {\n        if (union.children.includes(personId)) {\n          return person.gender === 'male' ? 'Son' : 'Daughter';\n        }\n      }\n    }\n\n    // Check if person is sibling (shares same parents as root)\n    if (rootParents.unionId) {\n      const rootUnion = unions.find(u => u.id === rootParents.unionId);\n      if (rootUnion && rootUnion.children.includes(personId)) {\n        return person.gender === 'male' ? 'Brother' : 'Sister';\n      }\n    }\n\n    // Also check sibling relationship in relationships table\n    const siblingRelationship = relationships.find(r =>\n    (r.relationshipType === 'sibling' &&\n      ((r.person1Id === root.id && r.person2Id === personId) ||\n        (r.person1Id === personId && r.person2Id === root.id)))\n    );\n    if (siblingRelationship) {\n      return person.gender === 'male' ? 'Brother' : 'Sister';\n    }\n\n    // Check if they share at least one parent (alternative sibling check)\n    const personParents = getParentsOfPerson(personId);\n    if ((rootParents.fatherId && rootParents.fatherId === personParents.fatherId) ||\n      (rootParents.motherId && rootParents.motherId === personParents.motherId)) {\n      return person.gender === 'male' ? 'Brother' : 'Sister';\n    }\n\n    // Check if person is grandparent\n    if (rootParents.fatherId) {\n      const fatherParents = getParentsOfPerson(rootParents.fatherId);\n      if (fatherParents.fatherId === personId) return 'Paternal Grandfather';\n      if (fatherParents.motherId === personId) return 'Paternal Grandmother';\n    }\n    if (rootParents.motherId) {\n      const motherParents = getParentsOfPerson(rootParents.motherId);\n      if (motherParents.fatherId === personId) return 'Maternal Grandfather';\n      if (motherParents.motherId === personId) return 'Maternal Grandmother';\n    }\n\n    // Check if person is uncle/aunt (sibling of root's parents)\n    if (rootParents.fatherId) {\n      const fatherParents = getParentsOfPerson(rootParents.fatherId);\n      if (fatherParents.unionId) {\n        const fatherSiblingsUnion = unions.find(u => u.id === fatherParents.unionId);\n        if (fatherSiblingsUnion) {\n          // Filter out the root's father himself from the siblings\n          const siblingsOfFather = fatherSiblingsUnion.children.filter(id => id !== rootParents.fatherId);\n          if (siblingsOfFather.includes(personId)) {\n            return person.gender === 'male' ? 'Uncle' : 'Aunt';\n          }\n        }\n      }\n    }\n    if (rootParents.motherId) {\n      const motherParents = getParentsOfPerson(rootParents.motherId);\n      if (motherParents.unionId) {\n        const motherSiblingsUnion = unions.find(u => u.id === motherParents.unionId);\n        if (motherSiblingsUnion) {\n          // Filter out the root's mother herself from the siblings\n          const siblingsOfMother = motherSiblingsUnion.children.filter(id => id !== rootParents.motherId);\n          if (siblingsOfMother.includes(personId)) {\n            return person.gender === 'male' ? 'Uncle' : 'Aunt';\n          }\n        }\n      }\n    }\n\n    // Check if person is grandchild\n    for (const union of unions) {\n      if (union.partner1Id === root.id || union.partner2Id === root.id) {\n        for (const childId of union.children) {\n          // Check if this child has children that include the person\n          for (const childUnion of unions) {\n            if (childUnion.partner1Id === childId || childUnion.partner2Id === childId) {\n              if (childUnion.children.includes(personId)) {\n                return person.gender === 'male' ? 'Grandson' : 'Granddaughter';\n              }\n            }\n          }\n        }\n      }\n    }\n\n    // Check if person is nephew/niece (child of sibling)\n    if (rootParents.unionId) {\n      const rootUnion = unions.find(u => u.id === rootParents.unionId);\n      if (rootUnion) {\n        for (const siblingId of rootUnion.children) {\n          if (siblingId === root.id) continue; // Skip the root person themselves\n          // Check if person is child of this sibling\n          for (const siblingUnion of unions) {\n            if (siblingUnion.partner1Id === siblingId || siblingUnion.partner2Id === siblingId) {\n              if (siblingUnion.children.includes(personId)) {\n                return person.gender === 'male' ? 'Nephew' : 'Niece';\n              }\n            }\n          }\n        }\n      }\n    }\n\n    // Check if person is cousin (child of uncle/aunt)\n    // First get uncles/aunts\n    const unclesAunts: string[] = [];\n    if (rootParents.fatherId) {\n      const fatherParents = getParentsOfPerson(rootParents.fatherId);\n      if (fatherParents.unionId) {\n        const fatherSiblingsUnion = unions.find(u => u.id === fatherParents.unionId);\n        if (fatherSiblingsUnion) {\n          unclesAunts.push(...fatherSiblingsUnion.children.filter(id => id !== rootParents.fatherId));\n        }\n      }\n    }\n    if (rootParents.motherId) {\n      const motherParents = getParentsOfPerson(rootParents.motherId);\n      if (motherParents.unionId) {\n        const motherSiblingsUnion = unions.find(u => u.id === motherParents.unionId);\n        if (motherSiblingsUnion) {\n          unclesAunts.push(...motherSiblingsUnion.children.filter(id => id !== rootParents.motherId));\n        }\n      }\n    }\n\n    // Check if person is child of any uncle/aunt\n    for (const uncleAuntId of unclesAunts) {\n      for (const uncleAuntUnion of unions) {\n        if (uncleAuntUnion.partner1Id === uncleAuntId || uncleAuntUnion.partner2Id === uncleAuntId) {\n          if (uncleAuntUnion.children.includes(personId)) {\n            return 'Cousin';\n          }\n        }\n      }\n    }\n\n    return 'Relative';\n  }, [persons, unions, relationships, getRootPerson, getParentsOfPerson, getSpouseOfPerson]);\n\n  return {\n    persons,\n    unions,\n    relationships,\n    graphData,\n    isLoading,\n    error,\n    createPerson,\n    createPersonWithRelationship,\n    updatePerson,\n    deletePerson,\n    createUnion,\n    addChildToUnion,\n    createRelationship,\n    getPersonById,\n    getRootPerson,\n    getParentsOfPerson,\n    getSpouseOfPerson,\n    getPersonRole,\n    refresh,\n  };\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 3282, "column": 0}, "map": {"version":3,"sources":["file:///Users/smsm/Desktop/Portafolio%20IA/arbol-genealogico-digital%202/apps/web/src/app/%28dashboard%29/tree/page.tsx"],"sourcesContent":["'use client';\n\nimport { useState, useCallback, useRef, useEffect } from 'react';\nimport Link from 'next/link';\nimport { useRouter } from 'next/navigation';\nimport {\n  Container,\n  Card,\n  Button,\n  SearchInput,\n  Tabs,\n  TabList,\n  TabTrigger,\n  TabContent,\n  Avatar,\n  Skeleton,\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  Input,\n  Badge,\n} from '@kintree/ui';\nimport { useTreeLayout } from '@/hooks/useTreeLayout';\nimport { useFamilyTree, type RelationshipTypeOption, type MedicalCondition } from '@/hooks/useFamilyTree';\nimport { useFamilyInvitations } from '@/hooks/useFamilyInvitations';\nimport type { GraphNode, Viewport, PersonNodeData } from '@kintree/graph-engine';\nimport type { Gender } from '@kintree/shared';\n\n// Common medical conditions for family history\nconst COMMON_MEDICAL_CONDITIONS = [\n  { id: 'diabetes', name: 'Diabetes', icon: <BloodIcon /> },\n  { id: 'hypertension', name: 'Hypertension', icon: <HeartIcon /> },\n  { id: 'heart_disease', name: 'Heart Disease', icon: <HeartAnatomyIcon /> },\n  { id: 'cancer', name: 'Cancer', icon: <RibbonIcon /> },\n  { id: 'asthma', name: 'Asthma', icon: <LungsIcon /> },\n  { id: 'alzheimers', name: 'Alzheimer\\'s', icon: <BrainIcon /> },\n  { id: 'depression', name: 'Depression', icon: <BrainIcon /> },\n  { id: 'arthritis', name: 'Arthritis', icon: <BoneIcon /> },\n  { id: 'thyroid', name: 'Thyroid', icon: <ButterflyIcon /> },\n  { id: 'obesity', name: 'Obesity', icon: <ScaleIcon /> },\n];\n\n// Relationship options for the dropdown\nconst RELATIONSHIP_OPTIONS: { value: RelationshipTypeOption; label: string; requiresRelatedPerson: boolean }[] = [\n  { value: 'self', label: 'Myself (Main Person)', requiresRelatedPerson: false },\n  { value: 'father', label: 'Father', requiresRelatedPerson: true },\n  { value: 'mother', label: 'Mother', requiresRelatedPerson: true },\n  { value: 'spouse', label: 'Spouse', requiresRelatedPerson: true },\n  { value: 'son', label: 'Son', requiresRelatedPerson: true },\n  { value: 'daughter', label: 'Daughter', requiresRelatedPerson: true },\n  { value: 'brother', label: 'Brother', requiresRelatedPerson: true },\n  { value: 'sister', label: 'Sister', requiresRelatedPerson: true },\n  { value: 'grandfather_paternal', label: 'Paternal Grandfather', requiresRelatedPerson: true },\n  { value: 'grandmother_paternal', label: 'Paternal Grandmother', requiresRelatedPerson: true },\n  { value: 'grandfather_maternal', label: 'Maternal Grandfather', requiresRelatedPerson: true },\n  { value: 'grandmother_maternal', label: 'Maternal Grandmother', requiresRelatedPerson: true },\n  { value: 'uncle', label: 'Uncle', requiresRelatedPerson: true },\n  { value: 'aunt', label: 'Aunt', requiresRelatedPerson: true },\n  { value: 'cousin', label: 'Cousin', requiresRelatedPerson: true },\n];\n\n// Initial viewport state\nconst INITIAL_VIEWPORT: Viewport = {\n  x: 0,\n  y: 0,\n  scale: 0.8,\n  width: 800,\n  height: 600,\n};\n\nexport default function TreePage() {\n  const router = useRouter();\n  const containerRef = useRef<HTMLDivElement>(null);\n  const [viewMode, setViewMode] = useState('tree');\n  const [searchQuery, setSearchQuery] = useState('');\n  const [viewport, setViewport] = useState<Viewport>(INITIAL_VIEWPORT);\n  const [selectedNodeId, setSelectedNodeId] = useState<string | null>(null);\n  const [isPanning, setIsPanning] = useState(false);\n  const [lastPanPoint, setLastPanPoint] = useState<{ x: number; y: number } | null>(null);\n\n  // Modal state for adding person\n  const [isAddModalOpen, setIsAddModalOpen] = useState(false);\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const [invitationSent, setInvitationSent] = useState(false);\n  const [invitationError, setInvitationError] = useState<string | null>(null);\n  const [newPerson, setNewPerson] = useState({\n    firstName: '',\n    lastName: '',\n    gender: 'male' as Gender,\n    birthDate: '',\n    birthPlace: '',\n    isLiving: true,\n    email: '',\n    sendInvitation: false,\n    relationshipType: 'self' as RelationshipTypeOption,\n    relatedToPersonId: '',\n    medicalConditions: [] as MedicalCondition[],\n  });\n\n  // Get real data from Supabase\n  const { graphData, persons, isLoading: dataLoading, createPersonWithRelationship, getRootPerson, getPersonRole } = useFamilyTree();\n  const { sendInvitation } = useFamilyInvitations();\n\n  // Get the root person for default \"related to\" selection\n  const rootPerson = getRootPerson();\n\n  // Handle adding a new person\n  const handleAddPerson = async () => {\n    if (!newPerson.firstName.trim() || !newPerson.birthPlace.trim()) {\n      setInvitationError('Name and birth place are required');\n      return;\n    }\n\n    // Validate: if not \"self\", must select a related person\n    const requiresRelated = RELATIONSHIP_OPTIONS.find(o => o.value === newPerson.relationshipType)?.requiresRelatedPerson;\n    if (requiresRelated && !newPerson.relatedToPersonId) {\n      setInvitationError('You must select who they are related to');\n      return;\n    }\n\n    setIsSubmitting(true);\n    setInvitationError(null);\n    setInvitationSent(false);\n\n    try {\n      const result = await createPersonWithRelationship({\n        firstName: newPerson.firstName.trim(),\n        lastName: newPerson.lastName.trim() || undefined,\n        gender: newPerson.gender,\n        birthDate: newPerson.birthDate || undefined,\n        birthPlace: newPerson.birthPlace,\n        isLiving: newPerson.isLiving,\n        relationshipType: newPerson.relationshipType,\n        relatedToPersonId: newPerson.relatedToPersonId || undefined,\n        medicalConditions: newPerson.medicalConditions.length > 0 ? newPerson.medicalConditions : undefined,\n      });\n\n      if (result) {\n        // Send invitation if email provided\n        if (newPerson.sendInvitation && newPerson.email.trim()) {\n          const invResult = await sendInvitation(\n            result.id,\n            newPerson.email.trim(),\n            `I invite you to join our family tree as ${newPerson.firstName}`\n          );\n\n          if (invResult.success) {\n            setInvitationSent(true);\n          } else {\n            setInvitationError(invResult.error || 'Error sending invitation');\n          }\n        }\n\n        // Reset form and close modal\n        setNewPerson({\n          firstName: '',\n          lastName: '',\n          gender: 'male',\n          birthDate: '',\n          birthPlace: '',\n          isLiving: true,\n          email: '',\n          sendInvitation: false,\n          relationshipType: persons.length === 0 ? 'self' : 'son',\n          relatedToPersonId: rootPerson?.id || '',\n          medicalConditions: [],\n        });\n        setIsAddModalOpen(false);\n      }\n    } catch (error) {\n      console.error('Error creating person:', error);\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n\n  // Compute layout from real data with root person\n  const { nodes, edges, bounds, generations } = useTreeLayout(\n    graphData?.persons?.length > 0 ? graphData : null,\n    { rootPersonId: rootPerson?.id }\n  );\n\n  // Update viewport size on mount and resize\n  useEffect(() => {\n    const updateSize = () => {\n      if (containerRef.current) {\n        const rect = containerRef.current.getBoundingClientRect();\n        setViewport((v) => ({ ...v, width: rect.width, height: rect.height }));\n      }\n    };\n    updateSize();\n    window.addEventListener('resize', updateSize);\n    return () => window.removeEventListener('resize', updateSize);\n  }, []);\n\n  // Center the tree on initial load\n  useEffect(() => {\n    if (bounds.width > 0 && bounds.height > 0) {\n      const centerX = (bounds.minX + bounds.maxX) / 2;\n      const centerY = (bounds.minY + bounds.maxY) / 2;\n      setViewport((v) => ({\n        ...v,\n        x: centerX,\n        y: centerY,\n        scale: Math.min(\n          v.width / (bounds.width + 100),\n          v.height / (bounds.height + 100),\n          1\n        ),\n      }));\n    }\n  }, [bounds]);\n\n  // Handle node click\n  const handleNodeClick = useCallback(\n    (node: GraphNode) => {\n      if (node.type === 'person') {\n        const data = node.data as PersonNodeData;\n        setSelectedNodeId(node.id);\n        router.push(`/tree/${data.personId}`);\n      }\n    },\n    [router]\n  );\n\n  // Pan handlers\n  const handleMouseDown = useCallback((e: React.MouseEvent) => {\n    if (e.button === 0) {\n      setIsPanning(true);\n      setLastPanPoint({ x: e.clientX, y: e.clientY });\n    }\n  }, []);\n\n  const handleMouseMove = useCallback(\n    (e: React.MouseEvent) => {\n      if (!isPanning || !lastPanPoint) return;\n      const dx = e.clientX - lastPanPoint.x;\n      const dy = e.clientY - lastPanPoint.y;\n      setViewport((v) => ({\n        ...v,\n        x: v.x - dx / v.scale,\n        y: v.y - dy / v.scale,\n      }));\n      setLastPanPoint({ x: e.clientX, y: e.clientY });\n    },\n    [isPanning, lastPanPoint]\n  );\n\n  const handleMouseUp = useCallback(() => {\n    setIsPanning(false);\n    setLastPanPoint(null);\n  }, []);\n\n  // Zoom handlers\n  const handleWheel = useCallback((e: React.WheelEvent) => {\n    e.preventDefault();\n    const rect = containerRef.current?.getBoundingClientRect();\n    if (!rect) return;\n\n    const mouseX = e.clientX - rect.left;\n    const mouseY = e.clientY - rect.top;\n    const delta = e.deltaY > 0 ? 0.9 : 1.1;\n\n    setViewport((v) => {\n      const newScale = Math.min(Math.max(v.scale * delta, 0.1), 3);\n      const scaleRatio = newScale / v.scale;\n      return {\n        ...v,\n        x: v.x + (mouseX / v.scale - v.width / 2 / v.scale) * (1 - 1 / scaleRatio),\n        y: v.y + (mouseY / v.scale - v.height / 2 / v.scale) * (1 - 1 / scaleRatio),\n        scale: newScale,\n      };\n    });\n  }, []);\n\n  const handleZoomIn = useCallback(() => {\n    setViewport((v) => ({ ...v, scale: Math.min(v.scale * 1.2, 3) }));\n  }, []);\n\n  const handleZoomOut = useCallback(() => {\n    setViewport((v) => ({ ...v, scale: Math.max(v.scale / 1.2, 0.1) }));\n  }, []);\n\n  const handleFitToScreen = useCallback(() => {\n    if (bounds.width > 0) {\n      const centerX = (bounds.minX + bounds.maxX) / 2;\n      const centerY = (bounds.minY + bounds.maxY) / 2;\n      setViewport((v) => ({\n        ...v,\n        x: centerX,\n        y: centerY,\n        scale: Math.min(v.width / (bounds.width + 100), v.height / (bounds.height + 100), 1),\n      }));\n    }\n  }, [bounds]);\n\n  // Transform for SVG\n  const transform = `translate(${viewport.width / 2 - viewport.x * viewport.scale}, ${viewport.height / 2 - viewport.y * viewport.scale\n    }) scale(${viewport.scale})`;\n\n  // Show loading state\n  if (dataLoading) {\n    return (\n      <Container size=\"full\" padding={false}>\n        <div className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-4 mb-6\">\n          <div>\n            <Skeleton width={250} height={32} />\n            <Skeleton width={150} height={20} className=\"mt-2\" />\n          </div>\n        </div>\n        <Skeleton height={500} className=\"rounded-2xl\" />\n      </Container>\n    );\n  }\n\n  const personCount = persons.length;\n\n  return (\n    <Container size=\"full\" padding={false}>\n      {/* Header with gradient text */}\n      <div className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-4 mb-6\">\n        <div>\n          <h1 className=\"text-2xl font-bold text-gradient-primary\">Family Tree</h1>\n          <div className=\"flex items-center gap-3 mt-2\">\n            <Badge variant=\"primary\" glow>\n              <UsersSmallIcon className=\"w-3 h-3 mr-1\" />\n              {personCount} people\n            </Badge>\n            <Badge variant=\"secondary\">\n              <LayersIcon className=\"w-3 h-3 mr-1\" />\n              {generations || 0} generations\n            </Badge>\n          </div>\n        </div>\n        <div className=\"flex items-center gap-3\">\n          <SearchInput\n            placeholder=\"Search family...\"\n            onChange={setSearchQuery}\n            onSearch={(q) => console.log('Search:', q)}\n            className=\"w-64\"\n          />\n          <Button leftIcon={<PlusIcon />} onClick={() => setIsAddModalOpen(true)}>\n            Add Person\n          </Button>\n        </div>\n      </div>\n\n      {/* View Tabs */}\n      <Tabs value={viewMode} onChange={setViewMode}>\n        <TabList variant=\"default\" className=\"mb-6\">\n          <TabTrigger value=\"tree\" icon={<TreeIcon />}>\n            Tree View\n          </TabTrigger>\n          <TabTrigger value=\"genogram\" icon={<GenogramIcon />}>\n            Genogram\n          </TabTrigger>\n          <TabTrigger value=\"list\" icon={<ListIcon />}>\n            List View\n          </TabTrigger>\n        </TabList>\n\n        <TabContent value=\"tree\">\n          {/* Tree container - Clean and Premium */}\n          <div className=\"relative h-[calc(100vh-280px)] min-h-[500px] rounded-3xl border border-neutral-200 bg-neutral-50/30 overflow-hidden shadow-sm\">\n            {/* SVG Canvas */}\n            <div\n              ref={containerRef}\n              className=\"w-full h-full bg-neutral-50/50 relative z-10\"\n              onMouseDown={handleMouseDown}\n              onMouseMove={handleMouseMove}\n              onMouseUp={handleMouseUp}\n              onMouseLeave={handleMouseUp}\n              onWheel={handleWheel}\n              style={{ cursor: isPanning ? 'grabbing' : 'grab' }}\n            >\n              <svg width={viewport.width} height={viewport.height} className=\"absolute inset-0\">\n                <defs>\n                  {/* Enhanced shadow filter */}\n                  <filter id=\"shadow\" x=\"-30%\" y=\"-30%\" width=\"160%\" height=\"160%\">\n                    <feDropShadow dx=\"0\" dy=\"4\" stdDeviation=\"6\" floodColor=\"#000\" floodOpacity=\"0.08\" />\n                    <feDropShadow dx=\"0\" dy=\"2\" stdDeviation=\"3\" floodColor=\"#000\" floodOpacity=\"0.06\" />\n                  </filter>\n                  {/* Gradient for male nodes */}\n                  <linearGradient id=\"maleGradient\" x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"100%\">\n                    <stop offset=\"0%\" stopColor=\"#60a5fa\" />\n                    <stop offset=\"100%\" stopColor=\"#3b82f6\" />\n                  </linearGradient>\n                  {/* Gradient for female nodes */}\n                  <linearGradient id=\"femaleGradient\" x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"100%\">\n                    <stop offset=\"0%\" stopColor=\"#f472b6\" />\n                    <stop offset=\"100%\" stopColor=\"#ec4899\" />\n                  </linearGradient>\n                  {/* Gradient for selected state */}\n                  <linearGradient id=\"selectedGradient\" x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"100%\">\n                    <stop offset=\"0%\" stopColor=\"#ff6b47\" />\n                    <stop offset=\"100%\" stopColor=\"#f59e0b\" />\n                  </linearGradient>\n                  {/* Edge gradient */}\n                  <linearGradient id=\"edgeGradient\" x1=\"0%\" y1=\"0%\" x2=\"0%\" y2=\"100%\">\n                    <stop offset=\"0%\" stopColor=\"#d4d4d4\" />\n                    <stop offset=\"100%\" stopColor=\"#a3a3a3\" />\n                  </linearGradient>\n                </defs>\n\n                <g transform={transform}>\n                  {/* Render edges with gradient */}\n                  {edges.map((edge) => (\n                    <path\n                      key={edge.id}\n                      d={edge.pathData || ''}\n                      fill=\"none\"\n                      stroke=\"url(#edgeGradient)\"\n                      strokeWidth={2.5}\n                      className=\"transition-colors\"\n                      strokeLinecap=\"round\"\n                    />\n                  ))}\n\n                  {/* Render nodes */}\n                  {nodes.map((node) => {\n                    if (node.type === 'person') {\n                      const data = node.data as PersonNodeData;\n                      const isSelected = selectedNodeId === node.id;\n                      const gradientId = isSelected ? 'selectedGradient' : data.gender === 'male' ? 'maleGradient' : 'femaleGradient';\n                      const personRole = getPersonRole(data.personId);\n\n                      return (\n                        <g\n                          key={node.id}\n                          transform={`translate(${node.x - node.width / 2}, ${node.y - node.height / 2})`}\n                          onClick={() => handleNodeClick(node)}\n                          className=\"cursor-pointer transition-transform hover:scale-105\"\n                          style={{ transformOrigin: 'center' }}\n                        >\n                          {/* Card background with gradient border */}\n                          <rect\n                            width={node.width}\n                            height={node.height}\n                            rx={16}\n                            fill=\"white\"\n                            filter=\"url(#shadow)\"\n                          />\n                          {/* Gradient border overlay */}\n                          <rect\n                            width={node.width}\n                            height={node.height}\n                            rx={16}\n                            fill=\"none\"\n                            stroke={`url(#${gradientId})`}\n                            strokeWidth={isSelected ? 3 : 2}\n                            className=\"transition-all\"\n                          />\n                          {/* Deceased indicator */}\n                          {!data.isLiving && (\n                            <line\n                              x1={0}\n                              y1={0}\n                              x2={node.width}\n                              y2={node.height}\n                              stroke=\"#9ca3af\"\n                              strokeWidth={1}\n                              opacity={0.4}\n                            />\n                          )}\n                          {/* Role badge at top */}\n                          {personRole && (\n                            <>\n                              <rect\n                                x={node.width / 2 - 30}\n                                y={-10}\n                                width={60}\n                                height={18}\n                                rx={9}\n                                fill={personRole === 'Me' ? '#ff6b47' : data.gender === 'male' ? '#3b82f6' : '#ec4899'}\n                              />\n                              <text\n                                x={node.width / 2}\n                                y={3}\n                                textAnchor=\"middle\"\n                                fontSize={10}\n                                fontWeight={600}\n                                fill=\"white\"\n                              >\n                                {personRole}\n                              </text>\n                            </>\n                          )}\n                          {/* Avatar circle with gradient */}\n                          <circle\n                            cx={node.width / 2}\n                            cy={35}\n                            r={22}\n                            fill={`url(#${data.gender === 'male' ? 'maleGradient' : 'femaleGradient'})`}\n                            opacity={0.15}\n                          />\n                          <circle\n                            cx={node.width / 2}\n                            cy={35}\n                            r={20}\n                            fill={`url(#${data.gender === 'male' ? 'maleGradient' : 'femaleGradient'})`}\n                            opacity={0.2}\n                          />\n                          {/* Initials */}\n                          <text\n                            x={node.width / 2}\n                            y={40}\n                            textAnchor=\"middle\"\n                            fontSize={14}\n                            fontWeight={700}\n                            fill={data.gender === 'male' ? '#1e40af' : '#9d174d'}\n                          >\n                            {data.firstName?.[0] || ''}{data.lastName?.[0] || ''}\n                          </text>\n                          {/* Name */}\n                          <text\n                            x={node.width / 2}\n                            y={68}\n                            textAnchor=\"middle\"\n                            fontSize={12}\n                            fontWeight={600}\n                            fill=\"#1f2937\"\n                          >\n                            {data.firstName}\n                          </text>\n                          <text\n                            x={node.width / 2}\n                            y={83}\n                            textAnchor=\"middle\"\n                            fontSize={10}\n                            fill=\"#6b7280\"\n                          >\n                            {data.lastName}\n                          </text>\n                          {/* Birth year */}\n                          {data.birthDate && (\n                            <text\n                              x={node.width / 2}\n                              y={96}\n                              textAnchor=\"middle\"\n                              fontSize={9}\n                              fill=\"#9ca3af\"\n                            >\n                              {data.birthDate.split('-')[0]}\n                              {!data.isLiving && ' '}\n                            </text>\n                          )}\n                        </g>\n                      );\n                    }\n\n                    if (node.type === 'union') {\n                      return (\n                        <g key={node.id}>\n                          <circle\n                            cx={node.x}\n                            cy={node.y}\n                            r={node.width / 2 + 2}\n                            fill=\"url(#selectedGradient)\"\n                            opacity={0.3}\n                          />\n                          <circle\n                            cx={node.x}\n                            cy={node.y}\n                            r={node.width / 2}\n                            fill=\"#f5f5f5\"\n                            stroke=\"#d4d4d4\"\n                            strokeWidth={1.5}\n                          />\n                        </g>\n                      );\n                    }\n\n                    return null;\n                  })}\n                </g>\n              </svg>\n            </div>\n\n            {/* Floating glass controls */}\n            <div className=\"absolute bottom-4 right-4 flex gap-2 glass rounded-xl p-1\">\n              <Button variant=\"ghost\" size=\"sm\" onClick={handleZoomOut} className=\"hover:bg-white/50\">\n                <MinusIcon />\n              </Button>\n              <Button variant=\"ghost\" size=\"sm\" onClick={handleZoomIn} className=\"hover:bg-white/50\">\n                <PlusSmallIcon />\n              </Button>\n              <div className=\"w-px bg-neutral-200 my-1\" />\n              <Button variant=\"ghost\" size=\"sm\" onClick={handleFitToScreen} className=\"hover:bg-white/50\">\n                <FitIcon />\n              </Button>\n            </div>\n\n            {/* Zoom level indicator with glass effect */}\n            <div className=\"absolute bottom-4 left-4 glass px-3 py-1.5 rounded-lg\">\n              <span className=\"text-xs font-medium text-neutral-600\">\n                {Math.round(viewport.scale * 100)}%\n              </span>\n            </div>\n          </div>\n        </TabContent>\n\n        <TabContent value=\"genogram\">\n          <Card variant=\"bordered\" padding=\"none\" className=\"h-[calc(100vh-280px)] min-h-[500px]\">\n            <div className=\"w-full h-full flex items-center justify-center bg-gradient-to-br from-neutral-50 to-primary-50/30\">\n              <div className=\"text-center\">\n                <div className=\"w-20 h-20 mx-auto mb-4 rounded-2xl bg-gradient-to-br from-primary-100 to-secondary-100 flex items-center justify-center\">\n                  <GenogramIcon className=\"w-10 h-10 text-primary-500\" />\n                </div>\n                <h3 className=\"text-lg font-semibold text-neutral-800 mb-2\">\n                  Medical Genogram\n                </h3>\n                <p className=\"text-neutral-500 max-w-sm mx-auto mb-6\">\n                  Visualize family tree with hereditary medical conditions.\n                </p>\n                <Link href=\"/tree/genogram\">\n                  <Button>View Full Genogram</Button>\n                </Link>\n              </div>\n            </div>\n          </Card>\n        </TabContent>\n\n        <TabContent value=\"list\">\n          <Card variant=\"bordered\" padding=\"lg\">\n            <div className=\"space-y-2\">\n              {nodes\n                .filter((n) => n.type === 'person')\n                .map((node, index) => {\n                  const data = node.data as PersonNodeData;\n                  const personRole = getPersonRole(data.personId);\n                  return (\n                    <button\n                      key={node.id}\n                      onClick={() => handleNodeClick(node)}\n                      className=\"w-full flex items-center gap-4 p-4 rounded-xl hover:bg-gradient-to-r hover:from-primary-50/50 hover:to-transparent border border-transparent hover:border-primary-100 transition-all text-left group animate-slide-up\"\n                      style={{ animationDelay: `${index * 50}ms` }}\n                    >\n                      <Avatar name={`${data.firstName} ${data.lastName}`} size=\"md\" ringColor=\"primary\" />\n                      <div className=\"flex-1\">\n                        <div className=\"flex items-center gap-2\">\n                          <p className=\"font-medium text-neutral-900 group-hover:text-primary-700 transition-colors\">\n                            {data.firstName} {data.lastName}\n                          </p>\n                          {personRole && (\n                            <span className={`px-2 py-0.5 text-xs font-medium rounded-full text-white ${personRole === 'Me' ? 'bg-primary-500' : data.gender === 'male' ? 'bg-blue-500' : 'bg-pink-500'\n                              }`}>\n                              {personRole}\n                            </span>\n                          )}\n                        </div>\n                        <p className=\"text-sm text-neutral-500\">\n                          {data.birthDate?.split('-')[0]}\n                          {!data.isLiving && ' - Deceased'}\n                        </p>\n                      </div>\n                      <div className=\"opacity-0 group-hover:opacity-100 transition-opacity\">\n                        <ChevronRightIcon />\n                      </div>\n                    </button>\n                  );\n                })}\n            </div>\n          </Card>\n        </TabContent>\n      </Tabs>\n\n      {/* Footer controls */}\n      <div className=\"flex items-center justify-between mt-4\">\n        <div className=\"text-sm text-neutral-400 flex items-center gap-2\">\n          <span className=\"inline-flex items-center gap-1\">\n            <MouseIcon className=\"w-4 h-4\" />\n            Drag to pan\n          </span>\n          <span className=\"text-neutral-300\"></span>\n          <span className=\"inline-flex items-center gap-1\">\n            <ScrollIcon className=\"w-4 h-4\" />\n            Scroll to zoom\n          </span>\n        </div>\n        <div className=\"flex items-center gap-2\">\n          <Button variant=\"ghost\" size=\"sm\" leftIcon={<DownloadIcon />}>\n            Export\n          </Button>\n          <Button variant=\"ghost\" size=\"sm\" leftIcon={<ShareIcon />}>\n            Share\n          </Button>\n        </div>\n      </div>\n\n      {/* Add Person Modal */}\n      <Dialog open={isAddModalOpen} onClose={() => setIsAddModalOpen(false)} className=\"max-h-[85vh] flex flex-col\">\n        <DialogHeader title=\"Add Family Member\" onClose={() => setIsAddModalOpen(false)} />\n        <DialogContent className=\"overflow-y-auto flex-1\">\n          <div className=\"space-y-4\">\n            {/* Relationship Type - FIRST and most important */}\n            <div className=\"bg-gradient-to-br from-primary-50 to-secondary-50 rounded-xl p-4\">\n              <label className=\"block text-sm font-semibold text-neutral-800 mb-2\">\n                Relationship Type *\n              </label>\n              <select\n                className=\"w-full px-4 py-2 bg-neutral-50 border border-neutral-200 rounded-xl focus:ring-2 focus:ring-primary focus:border-transparent transition-all outline-none\"\n                value={newPerson.relationshipType}\n                onChange={(e) => {\n                  const relType = e.target.value as RelationshipTypeOption;\n                  // Auto-set gender based on relationship type\n                  let autoGender = newPerson.gender;\n                  if (['father', 'grandfather_paternal', 'grandfather_maternal', 'son', 'brother', 'uncle'].includes(relType)) {\n                    autoGender = 'male';\n                  } else if (['mother', 'grandmother_paternal', 'grandmother_maternal', 'daughter', 'sister', 'aunt'].includes(relType)) {\n                    autoGender = 'female';\n                  }\n                  setNewPerson({\n                    ...newPerson,\n                    relationshipType: relType,\n                    gender: autoGender,\n                    relatedToPersonId: relType === 'self' ? '' : (rootPerson?.id || ''),\n                  });\n                }}\n              >\n                {persons.length === 0 ? (\n                  <option value=\"self\">Myself (create root person)</option>\n                ) : (\n                  <>\n                    <option value=\"\" disabled>Select relationship</option>\n                    <optgroup label=\"Immediate Family\">\n                      <option value=\"father\">Father</option>\n                      <option value=\"mother\">Mother</option>\n                      <option value=\"spouse\">Spouse</option>\n                      <option value=\"son\">Son</option>\n                      <option value=\"daughter\">Daughter</option>\n                      <option value=\"brother\">Brother</option>\n                      <option value=\"sister\">Sister</option>\n                    </optgroup>\n                    <optgroup label=\"Grandparents\">\n                      <option value=\"grandfather_paternal\">Paternal Grandfather</option>\n                      <option value=\"grandmother_paternal\">Paternal Grandmother</option>\n                      <option value=\"grandfather_maternal\">Maternal Grandfather</option>\n                      <option value=\"grandmother_maternal\">Maternal Grandmother</option>\n                    </optgroup>\n                    <optgroup label=\"Other Relatives\">\n                      <option value=\"uncle\">Uncle</option>\n                      <option value=\"aunt\">Aunt</option>\n                      <option value=\"cousin\">Cousin</option>\n                    </optgroup>\n                  </>\n                )}\n              </select>\n            </div>\n\n            {/* Related to Person - only show if needed */}\n            {newPerson.relationshipType !== 'self' && persons.length > 0 && (\n              <div>\n                <label className=\"block text-sm font-medium text-neutral-700 mb-1.5\">\n                  Related to *\n                </label>\n                <select\n                  value={newPerson.relatedToPersonId}\n                  onChange={(e) => setNewPerson({ ...newPerson, relatedToPersonId: e.target.value })}\n                  className=\"w-full px-4 py-2.5 rounded-xl border border-neutral-200 bg-white text-neutral-900 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all\"\n                >\n                  <option value=\"\">Select person...</option>\n                  {persons.map((person) => (\n                    <option key={person.id} value={person.id}>\n                      {person.firstName} {person.lastName || ''}\n                    </option>\n                  ))}\n                </select>\n                <p className=\"text-xs text-neutral-500 mt-1\">\n                  Select the person you want to add this relative to\n                </p>\n              </div>\n            )}\n\n            <div className=\"border-t border-neutral-100 pt-4\">\n              <p className=\"text-xs font-medium text-neutral-500 uppercase tracking-wide mb-3\">Personal Details</p>\n\n              <div className=\"grid grid-cols-2 gap-3\">\n                <Input\n                  label=\"First Name\"\n                  value={newPerson.firstName}\n                  onChange={(e) => setNewPerson({ ...newPerson, firstName: e.target.value })}\n                  placeholder=\"John\"\n                  required\n                  fullWidth\n                />\n                <Input\n                  label=\"Last Name\"\n                  value={newPerson.lastName}\n                  onChange={(e) => setNewPerson({ ...newPerson, lastName: e.target.value })}\n                  placeholder=\"Doe\"\n                  fullWidth\n                />\n              </div>\n            </div>\n\n            <div className=\"grid grid-cols-2 gap-3\">\n              <div>\n                <label className=\"block text-sm font-medium text-neutral-700 mb-1.5\">\n                  Gnero\n                </label>\n                <select\n                  value={newPerson.gender}\n                  onChange={(e) => setNewPerson({ ...newPerson, gender: e.target.value as Gender })}\n                  className=\"w-full px-4 py-2.5 rounded-xl border border-neutral-200 bg-white text-neutral-900 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all\"\n                >\n                  <option value=\"male\">Male</option>\n                  <option value=\"female\">Female</option>\n                  <option value=\"other\">Other</option>\n                </select>\n              </div>\n\n              <Input\n                label=\"Birth Date\"\n                type=\"date\"\n                value={newPerson.birthDate}\n                onChange={(e) => setNewPerson({ ...newPerson, birthDate: e.target.value })}\n                fullWidth\n              />\n              <Input\n                label=\"Birth Place\"\n                value={newPerson.birthPlace}\n                onChange={(e) => setNewPerson({ ...newPerson, birthPlace: e.target.value })}\n                placeholder=\"City, Country\"\n                required\n                fullWidth\n                className=\"col-span-2\"\n              />\n            </div>\n\n            <label className=\"flex items-center gap-2 cursor-pointer\">\n              <input\n                type=\"checkbox\"\n                checked={newPerson.isLiving}\n                onChange={(e) => setNewPerson({ ...newPerson, isLiving: e.target.checked })}\n                className=\"w-4 h-4 rounded border-neutral-300 text-primary-600 focus:ring-primary-500\"\n              />\n              <span className=\"text-sm text-neutral-700\">Living Person</span>\n            </label>\n\n            {/* Medical conditions section */}\n            <div className=\"border-t border-neutral-100 pt-4 mt-2\">\n              <p className=\"text-xs font-medium text-neutral-500 uppercase tracking-wide mb-3\">\n                Medical Conditions (Family History)\n              </p>\n              <p className=\"text-xs text-neutral-400 mb-3\">\n                Select known medical conditions for the genogram\n              </p>\n              <div className=\"grid grid-cols-2 gap-2\">\n                {COMMON_MEDICAL_CONDITIONS.map((condition) => {\n                  const isSelected = newPerson.medicalConditions.some(c => c.id === condition.id);\n                  return (\n                    <label\n                      key={condition.id}\n                      className={`flex items-center gap-2 p-2.5 rounded-lg border cursor-pointer transition-all ${isSelected\n                        ? 'bg-primary-50 border-primary-300 text-primary-800'\n                        : 'bg-white border-neutral-200 hover:border-neutral-300 text-neutral-700'\n                        }`}\n                    >\n                      <input\n                        type=\"checkbox\"\n                        checked={isSelected}\n                        onChange={(e) => {\n                          if (e.target.checked) {\n                            setNewPerson({\n                              ...newPerson,\n                              medicalConditions: [\n                                ...newPerson.medicalConditions,\n                                { id: condition.id, name: condition.name }\n                              ]\n                            });\n                          } else {\n                            setNewPerson({\n                              ...newPerson,\n                              medicalConditions: newPerson.medicalConditions.filter(c => c.id !== condition.id)\n                            });\n                          }\n                        }}\n                        className=\"w-4 h-4 rounded border-neutral-300 text-primary-600 focus:ring-primary-500\"\n                      />\n                      <span className=\"text-sm\">\n                        {condition.icon} {condition.name}\n                      </span>\n                    </label>\n                  );\n                })}\n              </div>\n            </div>\n\n            {/* Invitation section */}\n            <div className=\"border-t border-neutral-100 pt-4 mt-2\">\n              <label className=\"flex items-center gap-2 cursor-pointer mb-3\">\n                <input\n                  type=\"checkbox\"\n                  checked={newPerson.sendInvitation}\n                  onChange={(e) => setNewPerson({ ...newPerson, sendInvitation: e.target.checked })}\n                  className=\"w-4 h-4 rounded border-neutral-300 text-primary-600 focus:ring-primary-500\"\n                />\n                <span className=\"text-sm text-neutral-700\">Send invitation to confirm kinship</span>\n              </label>\n\n              {newPerson.sendInvitation && (\n                <div className=\"bg-gradient-to-br from-primary-50 to-secondary-50 rounded-xl p-4 mb-3\">\n                  <p className=\"text-xs text-primary-700 mb-3\">\n                    A notification will be sent to confirm they are your relative and to connect their social networks.\n                  </p>\n                  <Input\n                    label=\"Relative's Email\"\n                    type=\"email\"\n                    value={newPerson.email}\n                    onChange={(e) => setNewPerson({ ...newPerson, email: e.target.value })}\n                    placeholder=\"relative@email.com\"\n                    fullWidth\n                  />\n                </div>\n              )}\n\n              {invitationError && (\n                <p className=\"text-sm text-red-600 mb-2\">{invitationError}</p>\n              )}\n            </div>\n          </div>\n        </DialogContent>\n        {/* Footer buttons - fixed at bottom */}\n        <div className=\"flex gap-3 p-6 pt-4 border-t border-neutral-100 flex-shrink-0\">\n          <Button\n            variant=\"outline\"\n            fullWidth\n            onClick={() => setIsAddModalOpen(false)}\n            disabled={isSubmitting}\n          >\n            Cancel\n          </Button>\n          <Button\n            fullWidth\n            onClick={handleAddPerson}\n            loading={isSubmitting}\n            disabled={!newPerson.firstName.trim()}\n          >\n            Add\n          </Button>\n        </div>\n      </Dialog>\n    </Container >\n  );\n}\n\n// Icons\nfunction PlusIcon() {\n  return (\n    <svg className=\"w-5 h-5\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n      <path d=\"M12 5v14M5 12h14\" />\n    </svg>\n  );\n}\n\nfunction PlusSmallIcon() {\n  return (\n    <svg className=\"w-4 h-4\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n      <path d=\"M12 5v14M5 12h14\" />\n    </svg>\n  );\n}\n\nfunction MinusIcon() {\n  return (\n    <svg className=\"w-4 h-4\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n      <path d=\"M5 12h14\" />\n    </svg>\n  );\n}\n\nfunction TreeIcon() {\n  return (\n    <svg className=\"w-4 h-4\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n      <path d=\"M12 22V8M12 8C9 8 6 5 6 2h12c0 3-3 6-6 6z\" />\n      <path d=\"M9 22h6\" />\n    </svg>\n  );\n}\n\nfunction GenogramIcon({ className }: { className?: string }) {\n  return (\n    <svg className={className || 'w-4 h-4'} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n      <rect x=\"2\" y=\"2\" width=\"8\" height=\"8\" />\n      <circle cx=\"18\" cy=\"6\" r=\"4\" />\n      <rect x=\"2\" y=\"14\" width=\"8\" height=\"8\" />\n      <circle cx=\"18\" cy=\"18\" r=\"4\" />\n      <path d=\"M10 6h4M6 10v4M18 10v4\" />\n    </svg>\n  );\n}\n\nfunction ListIcon({ className }: { className?: string }) {\n  return (\n    <svg className={className || 'w-4 h-4'} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n      <path d=\"M8 6h13M8 12h13M8 18h13M3 6h.01M3 12h.01M3 18h.01\" />\n    </svg>\n  );\n}\n\nfunction FitIcon() {\n  return (\n    <svg className=\"w-4 h-4\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n      <path d=\"M8 3H5a2 2 0 00-2 2v3M21 8V5a2 2 0 00-2-2h-3M3 16v3a2 2 0 002 2h3M16 21h3a2 2 0 002-2v-3\" />\n    </svg>\n  );\n}\n\nfunction DownloadIcon() {\n  return (\n    <svg className=\"w-4 h-4\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n      <path d=\"M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4M7 10l5 5 5-5M12 15V3\" />\n    </svg>\n  );\n}\n\nfunction ShareIcon() {\n  return (\n    <svg className=\"w-4 h-4\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n      <circle cx=\"18\" cy=\"5\" r=\"3\" />\n      <circle cx=\"6\" cy=\"12\" r=\"3\" />\n      <circle cx=\"18\" cy=\"19\" r=\"3\" />\n      <path d=\"M8.59 13.51l6.83 3.98M15.41 6.51l-6.82 3.98\" />\n    </svg>\n  );\n}\n\nfunction ChevronRightIcon() {\n  return (\n    <svg className=\"w-5 h-5 text-primary-400\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n      <path d=\"M9 18l6-6-6-6\" />\n    </svg>\n  );\n}\n\nfunction UsersSmallIcon({ className }: { className?: string }) {\n  return (\n    <svg className={className || 'w-4 h-4'} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n      <path d=\"M16 21v-2a4 4 0 00-4-4H6a4 4 0 00-4 4v2\" />\n      <circle cx=\"9\" cy=\"7\" r=\"4\" />\n      <path d=\"M22 21v-2a4 4 0 00-3-3.87M16 3.13a4 4 0 010 7.75\" />\n    </svg>\n  );\n}\n\nfunction LayersIcon({ className }: { className?: string }) {\n  return (\n    <svg className={className || 'w-4 h-4'} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n      <polygon points=\"12 2 2 7 12 12 22 7 12 2\" />\n      <polyline points=\"2 17 12 22 22 17\" />\n      <polyline points=\"2 12 12 17 22 12\" />\n    </svg>\n  );\n}\n\nfunction MouseIcon({ className }: { className?: string }) {\n  return (\n    <svg className={className || 'w-4 h-4'} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n      <rect x=\"6\" y=\"3\" width=\"12\" height=\"18\" rx=\"6\" />\n      <path d=\"M12 7v4\" />\n    </svg>\n  );\n}\n\nfunction ScrollIcon({ className }: { className?: string }) {\n  return (\n    <svg className={className || 'w-4 h-4'} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n      <path d=\"M12 3v18M5 10l7-7 7 7M5 14l7 7 7-7\" />\n    </svg>\n  );\n}\n\nfunction BloodIcon() {\n  return (\n    <svg className=\"w-4 h-4 inline-block text-red-500\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n      <path d=\"M12 22a7 7 0 0 0 7-7c0-2-1-3.9-3-5.5s-3.5-4-4-6.5c-.5 2.5-2 4.9-4 6.5C6 11.1 5 13 5 15a7 7 0 0 0 7 7z\" />\n    </svg>\n  );\n}\n\nfunction HeartIcon() {\n  return (\n    <svg className=\"w-4 h-4 inline-block text-red-500\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n      <path d=\"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z\" />\n    </svg>\n  );\n}\n\nfunction HeartAnatomyIcon() {\n  return (\n    <svg className=\"w-4 h-4 inline-block text-red-600\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n      <path d=\"M12.5 3.5v5M18.5 7v4M8.5 4v6M12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0-7.78-7.78L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23z\" />\n    </svg>\n  );\n}\n\nfunction RibbonIcon() {\n  return (\n    <svg className=\"w-4 h-4 inline-block text-purple-500\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n      <path d=\"M12 18s-7-5.5-7-10a5 5 0 0 1 10 0c0 4.5-7 10-7 10z\" />\n      <path d=\"m19 21-5-6M5 21l5-6\" />\n    </svg>\n  );\n}\n\nfunction LungsIcon() {\n  return (\n    <svg className=\"w-4 h-4 inline-block text-blue-400\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n      <path d=\"M12 3v9M7 6v6a5 5 0 1 0 10 0V6\" />\n    </svg>\n  );\n}\n\nfunction BrainIcon() {\n  return (\n    <svg className=\"w-4 h-4 inline-block text-pink-400\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n      <path d=\"M9.5 2h5M5 6.5a4.5 4.5 0 0 1 14 0c0 1.25-.5 2.5-1.5 3.5a4.5 4.5 0 0 1-5.5 1 4.5 4.5 0 0 1-5.5-1C5.5 9 5 7.75 5 6.5z\" />\n      <path d=\"M9.5 11v6a4.5 4.5 0 0 0 9 0M5.5 11v6a4.5 4.5 0 0 0 9 0\" />\n    </svg>\n  );\n}\n\nfunction BoneIcon() {\n  return (\n    <svg className=\"w-4 h-4 inline-block text-orange-200\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n      <path d=\"M17 10c.8-.8 2-.6 2.8.2.8.8.8 2 0 2.8l-1.4 1.4-2.8-2.8L17 10Z\" />\n      <path d=\"M15.6 11.4 8.6 18.4M4.2 17c-.8.8-1 2-.2 2.8.8.8 2 1 2.8.2l1.4-1.4-2.8-2.8L4.2 17Z\" />\n      <path d=\"M7 14c-.8-.8-2-.6-2.8.2-.8.8-.8 2 0 2.8l1.4-1.4 2.8 2.8L7 14Z\" />\n      <path d=\"M19.8 7c.8-.8 1-2 .2-2.8C19.2 3.4 18 3.2 17.2 4l-1.4 1.4 2.8 2.8L19.8 7Z\" />\n    </svg>\n  );\n}\n\nfunction ButterflyIcon() {\n  return (\n    <svg className=\"w-4 h-4 inline-block text-blue-500\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n      <path d=\"M12 2v20M8 6a4 4 0 0 1 8 0c0 2.5-4 6-4 6s-4-3.5-4-6M6 14a4 4 0 0 1 12 0c0 2.5-6 6-6 6s-6-3.5-6-6\" />\n    </svg>\n  );\n}\n\nfunction ScaleIcon() {\n  return (\n    <svg className=\"w-4 h-4 inline-block text-neutral-500\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n      <path d=\"M12 3v18M5 10l7-7 7 7M5 14l7 7 7-7\" />\n    </svg>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}