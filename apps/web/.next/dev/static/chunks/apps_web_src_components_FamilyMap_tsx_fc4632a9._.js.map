{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/smsm/Desktop/Portafolio%20IA/arbol-genealogico-digital%202/apps/web/src/components/FamilyMap.tsx"],"sourcesContent":["'use client';\n\nimport { useEffect, useState } from 'react';\nimport dynamic from 'next/dynamic';\n\n// Types for family member location\nexport interface FamilyMemberMarker {\n  id: string;\n  name: string;\n  photoUrl: string | null;\n  status: 'online' | 'away' | 'offline';\n  location: { lat: number; lng: number; address: string } | null;\n  isSelected?: boolean;\n}\n\ninterface FamilyMapProps {\n  members: FamilyMemberMarker[];\n  selectedMemberId: string | null;\n  onMemberSelect: (memberId: string) => void;\n  className?: string;\n}\n\n// Dynamically import the map to avoid SSR issues with Leaflet\nconst MapContainer = dynamic(\n  () => import('react-leaflet').then((mod) => mod.MapContainer),\n  { ssr: false }\n);\n\nconst TileLayer = dynamic(\n  () => import('react-leaflet').then((mod) => mod.TileLayer),\n  { ssr: false }\n);\n\nconst Marker = dynamic(\n  () => import('react-leaflet').then((mod) => mod.Marker),\n  { ssr: false }\n);\n\nconst Popup = dynamic(\n  () => import('react-leaflet').then((mod) => mod.Popup),\n  { ssr: false }\n);\n\n// Custom marker icons\nfunction createCustomIcon(status: 'online' | 'away' | 'offline', isSelected: boolean) {\n  if (typeof window === 'undefined') return undefined;\n\n  const L = require('leaflet');\n\n  const color = status === 'online' ? '#10b981' : status === 'away' ? '#f59e0b' : '#9ca3af';\n  const size = isSelected ? 48 : 40;\n  const borderColor = isSelected ? '#ff6b47' : color;\n  const borderWidth = isSelected ? 4 : 3;\n\n  const svgIcon = `\n    <svg width=\"${size}\" height=\"${size + 12}\" viewBox=\"0 0 ${size} ${size + 12}\" xmlns=\"http://www.w3.org/2000/svg\">\n      <defs>\n        <filter id=\"shadow\" x=\"-20%\" y=\"-20%\" width=\"140%\" height=\"140%\">\n          <feDropShadow dx=\"0\" dy=\"2\" stdDeviation=\"3\" flood-color=\"#000\" flood-opacity=\"0.3\"/>\n        </filter>\n        <linearGradient id=\"pinGrad\" x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"100%\">\n          <stop offset=\"0%\" style=\"stop-color:${color};stop-opacity:1\" />\n          <stop offset=\"100%\" style=\"stop-color:${color};stop-opacity:0.8\" />\n        </linearGradient>\n      </defs>\n      <path d=\"M${size / 2} ${size + 8} L${size / 2 - 8} ${size - 4} Q0 ${size / 2} 0 ${size / 2 - 4}\n               A${size / 2} ${size / 2} 0 1 1 ${size} ${size / 2 - 4}\n               Q${size} ${size / 2} ${size / 2 + 8} ${size - 4} Z\"\n            fill=\"url(#pinGrad)\" filter=\"url(#shadow)\"/>\n      <circle cx=\"${size / 2}\" cy=\"${size / 2 - 4}\" r=\"${size / 2 - 6}\" fill=\"white\"/>\n      <circle cx=\"${size / 2}\" cy=\"${size / 2 - 4}\" r=\"${size / 2 - 8}\" fill=\"${color}\" opacity=\"0.2\"/>\n      <circle cx=\"${size / 2}\" cy=\"${size / 2 - 4}\" r=\"${size / 4}\" fill=\"${borderColor}\" stroke=\"white\" stroke-width=\"2\"/>\n    </svg>\n  `;\n\n  return L.divIcon({\n    html: svgIcon,\n    className: 'custom-marker',\n    iconSize: [size, size + 12],\n    iconAnchor: [size / 2, size + 8],\n    popupAnchor: [0, -size],\n  });\n}\n\nexport default function FamilyMap({ members, selectedMemberId, onMemberSelect, className }: FamilyMapProps) {\n  const [isClient, setIsClient] = useState(false);\n  const [mapReady, setMapReady] = useState(false);\n\n  useEffect(() => {\n    setIsClient(true);\n    // Load Leaflet CSS\n    const link = document.createElement('link');\n    link.rel = 'stylesheet';\n    link.href = 'https://unpkg.com/leaflet@1.9.4/dist/leaflet.css';\n    document.head.appendChild(link);\n\n    // Add custom styles for markers\n    const style = document.createElement('style');\n    style.textContent = `\n      .custom-marker {\n        background: transparent !important;\n        border: none !important;\n      }\n      .leaflet-popup-content-wrapper {\n        border-radius: 16px;\n        box-shadow: 0 4px 20px rgba(0,0,0,0.15);\n      }\n      .leaflet-popup-content {\n        margin: 12px 16px;\n      }\n    `;\n    document.head.appendChild(style);\n\n    setMapReady(true);\n\n    return () => {\n      document.head.removeChild(link);\n      document.head.removeChild(style);\n    };\n  }, []);\n\n  // Get members with valid locations\n  const membersWithLocation = members.filter(m => m.location !== null);\n\n  // Calculate center from members or default to a location\n  const center = membersWithLocation.length > 0\n    ? {\n      lat: membersWithLocation.reduce((sum, m) => sum + (m.location?.lat || 0), 0) / membersWithLocation.length,\n      lng: membersWithLocation.reduce((sum, m) => sum + (m.location?.lng || 0), 0) / membersWithLocation.length,\n    }\n    : { lat: -12.0464, lng: -77.0428 }; // Default to Lima, Peru\n\n  if (!isClient || !mapReady) {\n    return (\n      <div className={`flex items-center justify-center bg-gradient-to-br from-neutral-50 to-primary-50/30 ${className}`}>\n        <div className=\"text-center\">\n          <div className=\"w-12 h-12 mx-auto mb-4 rounded-full border-4 border-primary-200 border-t-primary-500 animate-spin\" />\n          <p className=\"text-neutral-500\">Cargando mapa...</p>\n        </div>\n      </div>\n    );\n  }\n\n  // If no members have locations, show empty state\n  if (membersWithLocation.length === 0) {\n    return (\n      <div className={`flex items-center justify-center bg-gradient-to-br from-neutral-50 via-primary-50/20 to-secondary-50/20 relative ${className}`}>\n        <div className=\"absolute top-10 right-10 w-32 h-32 rounded-full bg-primary-100/50 animate-float\" />\n        <div className=\"absolute bottom-20 left-20 w-24 h-24 rounded-full bg-secondary-100/50 animate-float\" style={{ animationDelay: '1s' }} />\n\n        <div className=\"text-center p-8 relative z-10\">\n          <div className=\"w-24 h-24 mx-auto mb-6 rounded-2xl bg-gradient-to-br from-primary-500 to-secondary-500 flex items-center justify-center shadow-lg shadow-primary-200\">\n            <MapPinIcon className=\"w-12 h-12 text-white\" />\n          </div>\n          <h3 className=\"text-xl font-semibold text-neutral-800 mb-3\">\n            Mapa Interactivo\n          </h3>\n          <p className=\"text-neutral-500 max-w-md mx-auto mb-6\">\n            {members.length === 0\n              ? 'Agrega miembros a tu familia para ver sus ubicaciones en el mapa.'\n              : 'Los miembros de tu familia aún no han compartido su ubicación. Invítalos a vincularse para ver su ubicación en tiempo real.'}\n          </p>\n          <div className=\"inline-flex items-center gap-6 px-6 py-3 rounded-xl bg-white/70 backdrop-blur-sm border border-neutral-100 text-sm\">\n            <span className=\"flex items-center gap-2\">\n              <span className=\"w-3 h-3 rounded-full bg-gradient-to-br from-green-400 to-emerald-500\" />\n              <span className=\"text-neutral-600\">En línea</span>\n            </span>\n            <span className=\"flex items-center gap-2\">\n              <span className=\"w-3 h-3 rounded-full bg-gradient-to-br from-amber-400 to-orange-500\" />\n              <span className=\"text-neutral-600\">Ausente</span>\n            </span>\n            <span className=\"flex items-center gap-2\">\n              <span className=\"w-3 h-3 rounded-full bg-neutral-300\" />\n              <span className=\"text-neutral-600\">Sin conexión</span>\n            </span>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className={`relative ${className}`}>\n      <MapContainer\n        center={[center.lat, center.lng]}\n        zoom={13}\n        className=\"w-full h-full rounded-2xl\"\n        style={{ background: '#f5f5f5' }}\n      >\n        <TileLayer\n          attribution='&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a>'\n          url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\n        />\n\n        {membersWithLocation.map((member) => {\n          if (!member.location) return null;\n\n          return (\n            <Marker\n              key={member.id}\n              position={[member.location.lat, member.location.lng]}\n              icon={createCustomIcon(member.status, selectedMemberId === member.id)}\n              eventHandlers={{\n                click: () => onMemberSelect(member.id),\n              }}\n            >\n              <Popup>\n                <div className=\"text-center min-w-[150px]\">\n                  <div className=\"w-12 h-12 mx-auto mb-2 rounded-full bg-gradient-to-br from-primary-400 to-secondary-400 flex items-center justify-center text-white font-bold text-lg\">\n                    {member.name.split(' ').map(n => n[0]).join('').slice(0, 2)}\n                  </div>\n                  <p className=\"font-semibold text-neutral-800\">{member.name}</p>\n                  <p className=\"text-xs text-neutral-500 mt-1\">{member.location.address}</p>\n                  <div className=\"flex items-center justify-center gap-1 mt-2\">\n                    <span className={`w-2 h-2 rounded-full ${member.status === 'online' ? 'bg-green-500' : member.status === 'away' ? 'bg-amber-500' : 'bg-neutral-400'\n                      }`} />\n                    <span className=\"text-xs text-neutral-600 capitalize\">\n                      {member.status === 'online' ? 'En línea' : member.status === 'away' ? 'Ausente' : 'Sin conexión'}\n                    </span>\n                  </div>\n                </div>\n              </Popup>\n            </Marker>\n          );\n        })}\n      </MapContainer>\n\n      {/* Legend overlay */}\n      <div className=\"absolute bottom-4 left-4 z-[1000] flex items-center gap-4 px-4 py-2 rounded-xl bg-white/90 backdrop-blur-sm border border-neutral-100 shadow-lg text-xs\">\n        <span className=\"flex items-center gap-1.5\">\n          <span className=\"w-2.5 h-2.5 rounded-full bg-gradient-to-br from-green-400 to-emerald-500\" />\n          <span className=\"text-neutral-600\">En línea</span>\n        </span>\n        <span className=\"flex items-center gap-1.5\">\n          <span className=\"w-2.5 h-2.5 rounded-full bg-gradient-to-br from-amber-400 to-orange-500\" />\n          <span className=\"text-neutral-600\">Ausente</span>\n        </span>\n        <span className=\"flex items-center gap-1.5\">\n          <span className=\"w-2.5 h-2.5 rounded-full bg-neutral-300\" />\n          <span className=\"text-neutral-600\">Offline</span>\n        </span>\n      </div>\n\n      {/* Zoom controls style override */}\n      <style jsx global>{`\n        .leaflet-control-zoom {\n          border: none !important;\n          box-shadow: 0 4px 12px rgba(0,0,0,0.1) !important;\n          border-radius: 12px !important;\n          overflow: hidden;\n        }\n        .leaflet-control-zoom a {\n          background: white !important;\n          color: #374151 !important;\n          border: none !important;\n          width: 36px !important;\n          height: 36px !important;\n          line-height: 36px !important;\n          font-size: 18px !important;\n        }\n        .leaflet-control-zoom a:hover {\n          background: #f3f4f6 !important;\n        }\n      `}</style>\n    </div>\n  );\n}\n\nfunction MapPinIcon({ className }: { className?: string }) {\n  return (\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.5\">\n      <path d=\"M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0118 0z\" />\n      <circle cx=\"12\" cy=\"10\" r=\"3\" />\n    </svg>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}