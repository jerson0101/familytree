{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/smsm/Desktop/Portafolio%20IA/arbol-genealogico-digital%202/apps/web/src/hooks/useFamilyTree.ts"],"sourcesContent":["'use client';\n\nimport { useEffect, useCallback, useState, useMemo } from 'react';\nimport { useFamilyStore } from '@/stores/familyStore';\nimport { createClient } from '@/lib/supabase';\nimport type { GraphData, GraphPerson, GraphUnion, GraphRelationship } from '@kintree/graph-engine';\nimport type { Gender } from '@kintree/shared';\n\nexport interface Person {\n  id: string;\n  familyId: string;\n  firstName: string;\n  middleNames?: string[];\n  lastName?: string;\n  maidenName?: string;\n  nicknames?: string[];\n  birthDate?: string;\n  birthDateApproximate?: boolean;\n  birthPlace?: string;\n  deathDate?: string;\n  deathDateApproximate?: boolean;\n  deathPlace?: string;\n  gender: Gender;\n  isLiving: boolean;\n  biography?: string;\n  photoUrl?: string;\n  medicalConditions?: any[];\n  linkedUserId?: string;\n  createdAt: string;\n}\n\nexport interface Union {\n  id: string;\n  familyId: string;\n  partner1Id: string;\n  partner2Id?: string;\n  unionType: string;\n  startDate?: string;\n  endDate?: string;\n  location?: string;\n  children: string[];\n}\n\nexport interface Relationship {\n  id: string;\n  familyId: string;\n  person1Id: string;\n  person2Id: string;\n  relationshipType: string;\n  isBiological: boolean;\n}\n\nexport interface MedicalCondition {\n  id: string;\n  name: string;\n  severity?: 'mild' | 'moderate' | 'severe';\n  diagnosed?: string; // Date of diagnosis\n  notes?: string;\n}\n\nexport interface CreatePersonInput {\n  firstName: string;\n  lastName?: string;\n  gender: Gender;\n  birthDate?: string;\n  isLiving?: boolean;\n  photoUrl?: string;\n  medicalConditions?: MedicalCondition[];\n}\n\nexport type RelationshipTypeOption =\n  | 'self'           // Root person (me)\n  | 'father'\n  | 'mother'\n  | 'spouse'\n  | 'son'\n  | 'daughter'\n  | 'brother'\n  | 'sister'\n  | 'grandfather_paternal'\n  | 'grandmother_paternal'\n  | 'grandfather_maternal'\n  | 'grandmother_maternal'\n  | 'uncle'\n  | 'aunt'\n  | 'cousin';\n\nexport interface CreatePersonWithRelationshipInput extends CreatePersonInput {\n  relationshipType: RelationshipTypeOption;\n  relatedToPersonId?: string; // The person this new person is related to\n}\n\nexport function useFamilyTree() {\n  const currentFamily = useFamilyStore((state) => state.currentFamily);\n  const supabase = useMemo(() => createClient(), []);\n  const [persons, setPersons] = useState<Person[]>([]);\n  const [unions, setUnions] = useState<Union[]>([]);\n  const [relationships, setRelationships] = useState<Relationship[]>([]);\n  const [isLoading, setIsLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n\n  // Fetch all data when family changes\n  useEffect(() => {\n    if (currentFamily?.id) {\n      fetchTreeData(currentFamily.id);\n    } else {\n      setPersons([]);\n      setUnions([]);\n      setRelationships([]);\n      setIsLoading(false);\n    }\n  }, [currentFamily?.id]);\n\n  const fetchTreeData = useCallback(async (familyId: string) => {\n    setIsLoading(true);\n    setError(null);\n\n    try {\n      // Fetch persons\n      const { data: personsData, error: personsError } = await supabase\n        .from('persons')\n        .select('*')\n        .eq('family_id', familyId)\n        .order('created_at', { ascending: true });\n\n      if (personsError) throw personsError;\n\n      // Fetch unions\n      const { data: unionsData, error: unionsError } = await supabase\n        .from('unions')\n        .select('*')\n        .eq('family_id', familyId);\n\n      if (unionsError) throw unionsError;\n\n      // Fetch union children\n      const { data: childrenData, error: childrenError } = await supabase\n        .from('union_children')\n        .select('union_id, child_id')\n        .in('union_id', (unionsData || []).map((u: any) => u.id));\n\n      if (childrenError) throw childrenError;\n\n      // Fetch relationships\n      const { data: relationshipsData, error: relError } = await supabase\n        .from('relationships')\n        .select('*')\n        .eq('family_id', familyId);\n\n      if (relError) throw relError;\n\n      // Map data\n      const personsList: Person[] = (personsData || []).map((p: any) => ({\n        id: p.id,\n        familyId: p.family_id,\n        firstName: p.first_name,\n        middleNames: p.middle_names,\n        lastName: p.last_name,\n        maidenName: p.maiden_name,\n        nicknames: p.nicknames,\n        birthDate: p.birth_date,\n        birthDateApproximate: p.birth_date_approximate,\n        birthPlace: p.birth_place,\n        deathDate: p.death_date,\n        deathDateApproximate: p.death_date_approximate,\n        deathPlace: p.death_place,\n        gender: p.gender as Gender,\n        isLiving: p.is_living,\n        biography: p.biography,\n        photoUrl: p.photo_url,\n        medicalConditions: p.medical_conditions,\n        linkedUserId: p.linked_user_id,\n        createdAt: p.created_at,\n      }));\n\n      // Group children by union\n      const childrenByUnion = new Map<string, string[]>();\n      (childrenData || []).forEach((c: any) => {\n        const existing = childrenByUnion.get(c.union_id) || [];\n        existing.push(c.child_id);\n        childrenByUnion.set(c.union_id, existing);\n      });\n\n      const unionsList: Union[] = (unionsData || []).map((u: any) => ({\n        id: u.id,\n        familyId: u.family_id,\n        partner1Id: u.partner1_id,\n        partner2Id: u.partner2_id,\n        unionType: u.union_type,\n        startDate: u.start_date,\n        endDate: u.end_date,\n        location: u.location,\n        children: childrenByUnion.get(u.id) || [],\n      }));\n\n      const relationshipsList: Relationship[] = (relationshipsData || []).map((r: any) => ({\n        id: r.id,\n        familyId: r.family_id,\n        person1Id: r.person1_id,\n        person2Id: r.person2_id,\n        relationshipType: r.relationship_type,\n        isBiological: r.is_biological,\n      }));\n\n      setPersons(personsList);\n      setUnions(unionsList);\n      setRelationships(relationshipsList);\n    } catch (err) {\n      console.error('Error fetching tree data:', err);\n      setError('Error loading family tree');\n    } finally {\n      setIsLoading(false);\n    }\n  }, []);\n\n  // Convert to GraphData format for the layout engine\n  const graphData: GraphData = useMemo(() => {\n    const graphPersons: GraphPerson[] = persons.map(p => ({\n      id: p.id,\n      firstName: p.firstName,\n      lastName: p.lastName || '',\n      gender: p.gender,\n      birthDate: p.birthDate,\n      birthDateApproximate: p.birthDateApproximate,\n      deathDate: p.deathDate,\n      deathDateApproximate: p.deathDateApproximate,\n      photoUrl: p.photoUrl,\n      isLiving: p.isLiving,\n      medicalConditions: p.medicalConditions,\n    }));\n\n    const graphUnions: GraphUnion[] = unions.map(u => ({\n      id: u.id,\n      partner1Id: u.partner1Id,\n      partner2Id: u.partner2Id || '',\n      unionType: u.unionType as any,\n      startDate: u.startDate,\n      endDate: u.endDate,\n      childrenIds: u.children,\n    }));\n\n    const graphRelationships: GraphRelationship[] = relationships.map(r => ({\n      id: r.id,\n      personId: r.person1Id,\n      relatedPersonId: r.person2Id,\n      type: r.relationshipType === 'parent_child' ? 'parent' : r.relationshipType as any,\n    }));\n\n    return {\n      persons: graphPersons,\n      unions: graphUnions,\n      relationships: graphRelationships,\n    };\n  }, [persons, unions, relationships]);\n\n  // CRUD operations\n  const createPerson = useCallback(async (input: CreatePersonInput): Promise<Person | null> => {\n    if (!currentFamily?.id) return null;\n\n    const { data: userData } = await supabase.auth.getUser();\n    if (!userData.user) return null;\n\n    try {\n      const { data, error } = await supabase\n        .from('persons')\n        .insert({\n          family_id: currentFamily.id,\n          first_name: input.firstName,\n          last_name: input.lastName,\n          gender: input.gender,\n          birth_date: input.birthDate,\n          is_living: input.isLiving ?? true,\n          photo_url: input.photoUrl,\n          created_by: userData.user.id,\n        })\n        .select()\n        .single();\n\n      if (error) throw error;\n\n      const newPerson: Person = {\n        id: data.id,\n        familyId: data.family_id,\n        firstName: data.first_name,\n        lastName: data.last_name,\n        gender: data.gender as Gender,\n        birthDate: data.birth_date,\n        isLiving: data.is_living,\n        photoUrl: data.photo_url,\n        createdAt: data.created_at,\n      };\n\n      setPersons(prev => [...prev, newPerson]);\n      return newPerson;\n    } catch (err) {\n      console.error('Error creating person:', err);\n      setError('Error creating person');\n      return null;\n    }\n  }, [currentFamily?.id]);\n\n  const updatePerson = useCallback(async (personId: string, updates: Partial<CreatePersonInput>): Promise<boolean> => {\n    try {\n      const updateData: Record<string, any> = {};\n      if (updates.firstName !== undefined) updateData.first_name = updates.firstName;\n      if (updates.lastName !== undefined) updateData.last_name = updates.lastName;\n      if (updates.gender !== undefined) updateData.gender = updates.gender;\n      if (updates.birthDate !== undefined) updateData.birth_date = updates.birthDate;\n      if (updates.isLiving !== undefined) updateData.is_living = updates.isLiving;\n      if (updates.photoUrl !== undefined) updateData.photo_url = updates.photoUrl;\n\n      const { error } = await supabase\n        .from('persons')\n        .update(updateData)\n        .eq('id', personId);\n\n      if (error) throw error;\n\n      // Refresh data\n      if (currentFamily?.id) {\n        await fetchTreeData(currentFamily.id);\n      }\n\n      return true;\n    } catch (err) {\n      console.error('Error updating person:', err);\n      return false;\n    }\n  }, [currentFamily?.id, fetchTreeData]);\n\n  const deletePerson = useCallback(async (personId: string): Promise<boolean> => {\n    try {\n      const { error } = await supabase\n        .from('persons')\n        .delete()\n        .eq('id', personId);\n\n      if (error) throw error;\n\n      setPersons(prev => prev.filter(p => p.id !== personId));\n      return true;\n    } catch (err) {\n      console.error('Error deleting person:', err);\n      return false;\n    }\n  }, []);\n\n  const createUnion = useCallback(async (\n    partner1Id: string,\n    partner2Id: string | null,\n    type: string = 'marriage'\n  ): Promise<Union | null> => {\n    if (!currentFamily?.id) return null;\n\n    const { data: userData } = await supabase.auth.getUser();\n    if (!userData.user) return null;\n\n    try {\n      const { data, error } = await supabase\n        .from('unions')\n        .insert({\n          family_id: currentFamily.id,\n          partner1_id: partner1Id,\n          partner2_id: partner2Id,\n          union_type: type,\n          created_by: userData.user.id,\n        })\n        .select()\n        .single();\n\n      if (error) throw error;\n\n      const newUnion: Union = {\n        id: data.id,\n        familyId: data.family_id,\n        partner1Id: data.partner1_id,\n        partner2Id: data.partner2_id,\n        unionType: data.union_type,\n        startDate: data.start_date,\n        endDate: data.end_date,\n        location: data.location,\n        children: [],\n      };\n\n      setUnions(prev => [...prev, newUnion]);\n      return newUnion;\n    } catch (err) {\n      console.error('Error creating union:', err);\n      return null;\n    }\n  }, [currentFamily?.id]);\n\n  const addChildToUnion = useCallback(async (unionId: string, childId: string): Promise<boolean> => {\n    try {\n      const { error } = await supabase\n        .from('union_children')\n        .insert({\n          union_id: unionId,\n          child_id: childId,\n        });\n\n      if (error) throw error;\n\n      // Update local state\n      setUnions(prev => prev.map(u =>\n        u.id === unionId\n          ? { ...u, children: [...u.children, childId] }\n          : u\n      ));\n\n      return true;\n    } catch (err) {\n      console.error('Error adding child to union:', err);\n      return false;\n    }\n  }, []);\n\n  const createRelationship = useCallback(async (\n    person1Id: string,\n    person2Id: string,\n    type: string,\n    isBiological: boolean = true\n  ): Promise<boolean> => {\n    if (!currentFamily?.id) return false;\n\n    const { data: userData } = await supabase.auth.getUser();\n    if (!userData.user) return false;\n\n    try {\n      const { error } = await supabase\n        .from('relationships')\n        .insert({\n          family_id: currentFamily.id,\n          person1_id: person1Id,\n          person2_id: person2Id,\n          relationship_type: type,\n          is_biological: isBiological,\n          created_by: userData.user.id,\n        });\n\n      if (error) throw error;\n\n      // Refresh data\n      await fetchTreeData(currentFamily.id);\n      return true;\n    } catch (err) {\n      console.error('Error creating relationship:', err);\n      return false;\n    }\n  }, [currentFamily?.id, fetchTreeData]);\n\n  const getPersonById = useCallback((personId: string): Person | undefined => {\n    return persons.find(p => p.id === personId);\n  }, [persons]);\n\n  const refresh = useCallback(async () => {\n    if (currentFamily?.id) {\n      await fetchTreeData(currentFamily.id);\n    }\n  }, [currentFamily?.id, fetchTreeData]);\n\n  // Get root person (first person added or self-marked person)\n  const getRootPerson = useCallback((): Person | null => {\n    if (persons.length === 0) return null;\n    // For now, return the first person created\n    return persons[0];\n  }, [persons]);\n\n  // Find or create a union between two people\n  const findOrCreateUnion = useCallback(async (\n    partner1Id: string,\n    partner2Id: string | null,\n    type: string = 'marriage'\n  ): Promise<string | null> => {\n    // Look for existing union\n    const existingUnion = unions.find(u =>\n      (u.partner1Id === partner1Id && u.partner2Id === partner2Id) ||\n      (u.partner1Id === partner2Id && u.partner2Id === partner1Id)\n    );\n\n    if (existingUnion) {\n      return existingUnion.id;\n    }\n\n    // Create new union\n    const newUnion = await createUnion(partner1Id, partner2Id, type);\n    return newUnion?.id || null;\n  }, [unions, createUnion]);\n\n  // Get parents of a person\n  const getParentsOfPerson = useCallback((personId: string): { fatherId?: string; motherId?: string; unionId?: string } => {\n    // Find union where this person is a child\n    for (const union of unions) {\n      if (union.children.includes(personId)) {\n        const partner1 = persons.find(p => p.id === union.partner1Id);\n        const partner2 = persons.find(p => p.id === union.partner2Id);\n\n        let fatherId: string | undefined;\n        let motherId: string | undefined;\n\n        if (partner1?.gender === 'male') fatherId = partner1.id;\n        else if (partner1?.gender === 'female') motherId = partner1.id;\n\n        if (partner2?.gender === 'male') fatherId = partner2.id;\n        else if (partner2?.gender === 'female') motherId = partner2.id;\n\n        return { fatherId, motherId, unionId: union.id };\n      }\n    }\n    return {};\n  }, [unions, persons]);\n\n  // Get spouse of a person\n  const getSpouseOfPerson = useCallback((personId: string): Person | null => {\n    for (const union of unions) {\n      if (union.partner1Id === personId && union.partner2Id) {\n        return persons.find(p => p.id === union.partner2Id) || null;\n      }\n      if (union.partner2Id === personId) {\n        return persons.find(p => p.id === union.partner1Id) || null;\n      }\n    }\n    return null;\n  }, [unions, persons]);\n\n  // Create person with relationship - the main function for adding family members\n  const createPersonWithRelationship = useCallback(async (\n    input: CreatePersonWithRelationshipInput\n  ): Promise<Person | null> => {\n    if (!currentFamily?.id) return null;\n\n    const { data: userData } = await supabase.auth.getUser();\n    if (!userData.user) return null;\n\n    try {\n      // First, create the person\n      const { data: personData, error: personError } = await supabase\n        .from('persons')\n        .insert({\n          family_id: currentFamily.id,\n          first_name: input.firstName,\n          last_name: input.lastName,\n          gender: input.gender,\n          birth_date: input.birthDate,\n          is_living: input.isLiving ?? true,\n          photo_url: input.photoUrl,\n          medical_conditions: input.medicalConditions || null,\n          created_by: userData.user.id,\n        })\n        .select()\n        .single();\n\n      if (personError) throw personError;\n\n      const newPersonId = personData.id;\n      const relatedToId = input.relatedToPersonId;\n\n      // Now handle the relationship based on type\n      switch (input.relationshipType) {\n        case 'self':\n          // This is the root person, no relationship needed\n          break;\n\n        case 'father':\n        case 'mother': {\n          // Adding a parent to the related person\n          if (!relatedToId) break;\n\n          // Get existing parents of the related person\n          const existingParents = getParentsOfPerson(relatedToId);\n\n          if (existingParents.unionId) {\n            // Union exists, update it to add this parent as the second partner\n            if (input.relationshipType === 'father' && !existingParents.fatherId) {\n              // If partner1 is already the mother, add father as partner2\n              // Otherwise update partner1\n              const currentUnion = unions.find(u => u.id === existingParents.unionId);\n              if (currentUnion?.partner1Id && !currentUnion?.partner2Id) {\n                await supabase.from('unions').update({ partner2_id: newPersonId }).eq('id', existingParents.unionId);\n              } else {\n                await supabase.from('unions').update({ partner1_id: newPersonId }).eq('id', existingParents.unionId);\n              }\n            } else if (input.relationshipType === 'mother' && !existingParents.motherId) {\n              const currentUnion = unions.find(u => u.id === existingParents.unionId);\n              if (currentUnion?.partner1Id && !currentUnion?.partner2Id) {\n                await supabase.from('unions').update({ partner2_id: newPersonId }).eq('id', existingParents.unionId);\n              } else {\n                await supabase.from('unions').update({ partner1_id: newPersonId }).eq('id', existingParents.unionId);\n              }\n            }\n          } else {\n            // Create new union with new parent and add related person as child\n            // The new parent is always partner1, partner2 will be added later\n            const union = await createUnion(newPersonId, null, 'marriage');\n            if (union) {\n              await addChildToUnion(union.id, relatedToId);\n            }\n          }\n\n          // Create parent-child relationship\n          await createRelationship(newPersonId, relatedToId, 'parent_child', true);\n          break;\n        }\n\n        case 'spouse': {\n          // Adding a spouse to the related person\n          if (!relatedToId) break;\n\n          // Create or find union between them\n          await findOrCreateUnion(relatedToId, newPersonId, 'marriage');\n\n          // Create spouse relationship\n          await createRelationship(relatedToId, newPersonId, 'spouse', false);\n          break;\n        }\n\n        case 'son':\n        case 'daughter': {\n          // Adding a child to the related person\n          if (!relatedToId) break;\n\n          // Find or create union for the parent\n          const spouse = getSpouseOfPerson(relatedToId);\n          let unionId: string | null = null;\n\n          if (spouse) {\n            // Find existing union with spouse\n            unionId = await findOrCreateUnion(relatedToId, spouse.id, 'marriage');\n          } else {\n            // Create single-parent union\n            const union = await createUnion(relatedToId, null, 'other');\n            unionId = union?.id || null;\n          }\n\n          if (unionId) {\n            await addChildToUnion(unionId, newPersonId);\n          }\n\n          // Create parent-child relationship\n          await createRelationship(relatedToId, newPersonId, 'parent_child', true);\n          break;\n        }\n\n        case 'brother':\n        case 'sister': {\n          // Adding a sibling to the related person\n          if (!relatedToId) break;\n\n          // Find the parents union of the related person\n          const existingParents = getParentsOfPerson(relatedToId);\n\n          if (existingParents.unionId) {\n            // Add to same union as sibling (they share the same parents)\n            await addChildToUnion(existingParents.unionId, newPersonId);\n          }\n          // If no parents exist yet, we just create the sibling relationship\n          // Parents can be added later, and both siblings will be linked to them\n\n          // Create sibling relationship\n          await createRelationship(relatedToId, newPersonId, 'sibling', true);\n          break;\n        }\n\n        case 'grandfather_paternal':\n        case 'grandmother_paternal': {\n          // Adding paternal grandparent\n          if (!relatedToId) break;\n\n          const parents = getParentsOfPerson(relatedToId);\n          if (parents.fatherId) {\n            // Add as parent of the father\n            const fatherParents = getParentsOfPerson(parents.fatherId);\n\n            if (fatherParents.unionId) {\n              // Update existing grandparents union - add as second partner\n              const currentUnion = unions.find(u => u.id === fatherParents.unionId);\n              if (currentUnion?.partner1Id && !currentUnion?.partner2Id) {\n                await supabase.from('unions').update({ partner2_id: newPersonId }).eq('id', fatherParents.unionId);\n              } else if (!currentUnion?.partner1Id) {\n                await supabase.from('unions').update({ partner1_id: newPersonId }).eq('id', fatherParents.unionId);\n              }\n            } else {\n              // Create new union and add father as child\n              const union = await createUnion(newPersonId, null, 'marriage');\n              if (union) {\n                await addChildToUnion(union.id, parents.fatherId);\n              }\n            }\n\n            await createRelationship(newPersonId, parents.fatherId, 'parent_child', true);\n          }\n          break;\n        }\n\n        case 'grandfather_maternal':\n        case 'grandmother_maternal': {\n          // Adding maternal grandparent\n          if (!relatedToId) break;\n\n          const parents = getParentsOfPerson(relatedToId);\n          if (parents.motherId) {\n            // Add as parent of the mother\n            const motherParents = getParentsOfPerson(parents.motherId);\n\n            if (motherParents.unionId) {\n              // Update existing grandparents union - add as second partner\n              const currentUnion = unions.find(u => u.id === motherParents.unionId);\n              if (currentUnion?.partner1Id && !currentUnion?.partner2Id) {\n                await supabase.from('unions').update({ partner2_id: newPersonId }).eq('id', motherParents.unionId);\n              } else if (!currentUnion?.partner1Id) {\n                await supabase.from('unions').update({ partner1_id: newPersonId }).eq('id', motherParents.unionId);\n              }\n            } else {\n              // Create new union and add mother as child\n              const union = await createUnion(newPersonId, null, 'marriage');\n              if (union) {\n                await addChildToUnion(union.id, parents.motherId);\n              }\n            }\n\n            await createRelationship(newPersonId, parents.motherId, 'parent_child', true);\n          }\n          break;\n        }\n\n        case 'uncle':\n        case 'aunt': {\n          // Adding uncle/aunt (sibling of parent)\n          if (!relatedToId) break;\n\n          const parents = getParentsOfPerson(relatedToId);\n          const parentId = input.gender === 'male'\n            ? (parents.fatherId || parents.motherId)\n            : (parents.motherId || parents.fatherId);\n\n          if (parentId) {\n            // Find grandparents union\n            const grandparents = getParentsOfPerson(parentId);\n\n            if (grandparents.unionId) {\n              // Add new person as child of grandparents\n              await addChildToUnion(grandparents.unionId, newPersonId);\n              await createRelationship(parentId, newPersonId, 'sibling', true);\n            }\n          }\n          break;\n        }\n\n        case 'cousin': {\n          // Adding a cousin is complex - need to find uncle/aunt first\n          // For now, just add as a person without automatic relationship\n          console.log('Cousin relationship requires manual setup');\n          break;\n        }\n      }\n\n      // Refresh all data\n      await fetchTreeData(currentFamily.id);\n\n      // Return the created person (constructed from the insert response)\n      const createdPerson: Person = {\n        id: personData.id,\n        familyId: personData.family_id,\n        firstName: personData.first_name,\n        lastName: personData.last_name,\n        gender: personData.gender as Gender,\n        birthDate: personData.birth_date,\n        isLiving: personData.is_living,\n        photoUrl: personData.photo_url,\n        medicalConditions: personData.medical_conditions,\n        createdAt: personData.created_at,\n      };\n\n      return createdPerson;\n    } catch (err) {\n      console.error('Error creating person with relationship:', err);\n      setError('Error creating person');\n      return null;\n    }\n  }, [\n    currentFamily?.id,\n    supabase,\n    createUnion,\n    addChildToUnion,\n    createRelationship,\n    getParentsOfPerson,\n    getSpouseOfPerson,\n    findOrCreateUnion,\n    fetchTreeData,\n    persons,\n  ]);\n\n  // Calculate the relationship role of a person relative to the root person\n  const getPersonRole = useCallback((personId: string): string | null => {\n    const root = getRootPerson();\n    if (!root) return null;\n    if (personId === root.id) return 'Me';\n\n    const person = persons.find(p => p.id === personId);\n    if (!person) return null;\n\n    // Get parents of root person\n    const rootParents = getParentsOfPerson(root.id);\n\n    // Check if person is parent of root\n    if (rootParents.fatherId === personId) return 'Father';\n    if (rootParents.motherId === personId) return 'Mother';\n\n    // Check if person is spouse of root\n    const rootSpouse = getSpouseOfPerson(root.id);\n    if (rootSpouse?.id === personId) {\n      return person.gender === 'male' ? 'Husband' : 'Wife';\n    }\n\n    // Check if person is child of root (root is parent in a union)\n    for (const union of unions) {\n      if (union.partner1Id === root.id || union.partner2Id === root.id) {\n        if (union.children.includes(personId)) {\n          return person.gender === 'male' ? 'Son' : 'Daughter';\n        }\n      }\n    }\n\n    // Check if person is sibling (shares same parents as root)\n    if (rootParents.unionId) {\n      const rootUnion = unions.find(u => u.id === rootParents.unionId);\n      if (rootUnion && rootUnion.children.includes(personId)) {\n        return person.gender === 'male' ? 'Brother' : 'Sister';\n      }\n    }\n\n    // Also check sibling relationship in relationships table\n    const siblingRelationship = relationships.find(r =>\n    (r.relationshipType === 'sibling' &&\n      ((r.person1Id === root.id && r.person2Id === personId) ||\n        (r.person1Id === personId && r.person2Id === root.id)))\n    );\n    if (siblingRelationship) {\n      return person.gender === 'male' ? 'Brother' : 'Sister';\n    }\n\n    // Check if they share at least one parent (alternative sibling check)\n    const personParents = getParentsOfPerson(personId);\n    if ((rootParents.fatherId && rootParents.fatherId === personParents.fatherId) ||\n      (rootParents.motherId && rootParents.motherId === personParents.motherId)) {\n      return person.gender === 'male' ? 'Brother' : 'Sister';\n    }\n\n    // Check if person is grandparent\n    if (rootParents.fatherId) {\n      const fatherParents = getParentsOfPerson(rootParents.fatherId);\n      if (fatherParents.fatherId === personId) return 'Paternal Grandfather';\n      if (fatherParents.motherId === personId) return 'Paternal Grandmother';\n    }\n    if (rootParents.motherId) {\n      const motherParents = getParentsOfPerson(rootParents.motherId);\n      if (motherParents.fatherId === personId) return 'Maternal Grandfather';\n      if (motherParents.motherId === personId) return 'Maternal Grandmother';\n    }\n\n    // Check if person is uncle/aunt (sibling of root's parents)\n    if (rootParents.fatherId) {\n      const fatherParents = getParentsOfPerson(rootParents.fatherId);\n      if (fatherParents.unionId) {\n        const fatherSiblingsUnion = unions.find(u => u.id === fatherParents.unionId);\n        if (fatherSiblingsUnion) {\n          // Filter out the root's father himself from the siblings\n          const siblingsOfFather = fatherSiblingsUnion.children.filter(id => id !== rootParents.fatherId);\n          if (siblingsOfFather.includes(personId)) {\n            return person.gender === 'male' ? 'Uncle' : 'Aunt';\n          }\n        }\n      }\n    }\n    if (rootParents.motherId) {\n      const motherParents = getParentsOfPerson(rootParents.motherId);\n      if (motherParents.unionId) {\n        const motherSiblingsUnion = unions.find(u => u.id === motherParents.unionId);\n        if (motherSiblingsUnion) {\n          // Filter out the root's mother herself from the siblings\n          const siblingsOfMother = motherSiblingsUnion.children.filter(id => id !== rootParents.motherId);\n          if (siblingsOfMother.includes(personId)) {\n            return person.gender === 'male' ? 'Uncle' : 'Aunt';\n          }\n        }\n      }\n    }\n\n    // Check if person is grandchild\n    for (const union of unions) {\n      if (union.partner1Id === root.id || union.partner2Id === root.id) {\n        for (const childId of union.children) {\n          // Check if this child has children that include the person\n          for (const childUnion of unions) {\n            if (childUnion.partner1Id === childId || childUnion.partner2Id === childId) {\n              if (childUnion.children.includes(personId)) {\n                return person.gender === 'male' ? 'Grandson' : 'Granddaughter';\n              }\n            }\n          }\n        }\n      }\n    }\n\n    // Check if person is nephew/niece (child of sibling)\n    if (rootParents.unionId) {\n      const rootUnion = unions.find(u => u.id === rootParents.unionId);\n      if (rootUnion) {\n        for (const siblingId of rootUnion.children) {\n          if (siblingId === root.id) continue; // Skip the root person themselves\n          // Check if person is child of this sibling\n          for (const siblingUnion of unions) {\n            if (siblingUnion.partner1Id === siblingId || siblingUnion.partner2Id === siblingId) {\n              if (siblingUnion.children.includes(personId)) {\n                return person.gender === 'male' ? 'Nephew' : 'Niece';\n              }\n            }\n          }\n        }\n      }\n    }\n\n    // Check if person is cousin (child of uncle/aunt)\n    // First get uncles/aunts\n    const unclesAunts: string[] = [];\n    if (rootParents.fatherId) {\n      const fatherParents = getParentsOfPerson(rootParents.fatherId);\n      if (fatherParents.unionId) {\n        const fatherSiblingsUnion = unions.find(u => u.id === fatherParents.unionId);\n        if (fatherSiblingsUnion) {\n          unclesAunts.push(...fatherSiblingsUnion.children.filter(id => id !== rootParents.fatherId));\n        }\n      }\n    }\n    if (rootParents.motherId) {\n      const motherParents = getParentsOfPerson(rootParents.motherId);\n      if (motherParents.unionId) {\n        const motherSiblingsUnion = unions.find(u => u.id === motherParents.unionId);\n        if (motherSiblingsUnion) {\n          unclesAunts.push(...motherSiblingsUnion.children.filter(id => id !== rootParents.motherId));\n        }\n      }\n    }\n\n    // Check if person is child of any uncle/aunt\n    for (const uncleAuntId of unclesAunts) {\n      for (const uncleAuntUnion of unions) {\n        if (uncleAuntUnion.partner1Id === uncleAuntId || uncleAuntUnion.partner2Id === uncleAuntId) {\n          if (uncleAuntUnion.children.includes(personId)) {\n            return 'Cousin';\n          }\n        }\n      }\n    }\n\n    return 'Relative';\n  }, [persons, unions, relationships, getRootPerson, getParentsOfPerson, getSpouseOfPerson]);\n\n  return {\n    persons,\n    unions,\n    relationships,\n    graphData,\n    isLoading,\n    error,\n    createPerson,\n    createPersonWithRelationship,\n    updatePerson,\n    deletePerson,\n    createUnion,\n    addChildToUnion,\n    createRelationship,\n    getPersonById,\n    getRootPerson,\n    getParentsOfPerson,\n    getSpouseOfPerson,\n    getPersonRole,\n    refresh,\n  };\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 928, "column": 0}, "map": {"version":3,"sources":["file:///Users/smsm/Desktop/Portafolio%20IA/arbol-genealogico-digital%202/apps/web/src/app/%28dashboard%29/tree/%5BpersonId%5D/page.tsx"],"sourcesContent":["'use client';\n\nimport { useState, useEffect, useMemo } from 'react';\nimport { useParams, useRouter } from 'next/navigation';\nimport Link from 'next/link';\nimport {\n  Container,\n  Card,\n  CardHeader,\n  CardContent,\n  Button,\n  Avatar,\n  Badge,\n  Tabs,\n  TabList,\n  TabTrigger,\n  TabContent,\n  Timeline,\n  TimelineItem,\n  Skeleton,\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  Input,\n} from '@kintree/ui';\nimport { createClient } from '@/lib/supabase';\nimport { useFamily } from '@/hooks/useFamily';\nimport { useAuthStore } from '@/stores/authStore';\nimport { useFamilyTree } from '@/hooks/useFamilyTree';\nimport type { Gender } from '@kintree/shared';\n\ninterface Person {\n  id: string;\n  firstName: string;\n  lastName?: string;\n  gender: 'male' | 'female' | 'other' | 'unknown';\n  birthDate?: string;\n  birthPlace?: string;\n  deathDate?: string;\n  isLiving: boolean;\n  biography?: string;\n  photoUrl?: string;\n  linkedUserId?: string;\n}\n\ninterface SocialAccount {\n  id: string;\n  platform: 'instagram' | 'facebook';\n  username: string;\n  displayName?: string;\n  profilePictureUrl?: string;\n  isActive: boolean;\n}\n\ninterface SocialPost {\n  id: string;\n  platform: string;\n  postType: string;\n  content?: string;\n  mediaUrls: string[];\n  thumbnailUrl?: string;\n  permalink?: string;\n  likesCount: number;\n  commentsCount: number;\n  postedAt: string;\n}\n\nexport default function PersonDetailPage() {\n  const params = useParams();\n  const router = useRouter();\n  const personId = params.personId as string;\n  const supabase = useMemo(() => createClient(), []);\n  const { currentFamily } = useFamily();\n  const currentUser = useAuthStore((state) => state.user);\n\n  const [person, setPerson] = useState<Person | null>(null);\n  const [relatives, setRelatives] = useState<{\n    parents: Person[];\n    spouse?: Person;\n    children: Person[];\n    siblings: Person[];\n  }>({ parents: [], children: [], siblings: [] });\n  const [socialAccounts, setSocialAccounts] = useState<SocialAccount[]>([]);\n  const [socialPosts, setSocialPosts] = useState<SocialPost[]>([]);\n  const [isLoading, setIsLoading] = useState(true);\n  const [activeTab, setActiveTab] = useState('info');\n  const [isSyncing, setIsSyncing] = useState(false);\n\n  // Edit/Delete state\n  const [isEditModalOpen, setIsEditModalOpen] = useState(false);\n  const [isDeleteDialogOpen, setIsDeleteDialogOpen] = useState(false);\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const [editForm, setEditForm] = useState({\n    firstName: '',\n    lastName: '',\n    gender: 'male' as Gender,\n    birthDate: '',\n    birthPlace: '',\n    isLiving: true,\n  });\n\n  // Get update/delete functions from hook\n  const { updatePerson, deletePerson } = useFamilyTree();\n\n  // Check if current user is the linked user for this person\n  const isOwner = person?.linkedUserId && currentUser?.id === person.linkedUserId;\n\n  // Fetch person data with retry logic\n  useEffect(() => {\n    let retryCount = 0;\n    const maxRetries = 3;\n\n    async function fetchData() {\n      if (!personId) return;\n      setIsLoading(true);\n\n      try {\n        // Fetch person\n        const { data: personData, error: personError } = await supabase\n          .from('persons')\n          .select('*')\n          .eq('id', personId)\n          .single();\n\n        if (personError) {\n          // If access denied, might be due to family context not being set yet\n          // Retry a few times with delay\n          if (retryCount < maxRetries && (personError.code === 'PGRST116' || personError.code === '42501')) {\n            retryCount++;\n            console.log(`Retrying fetch person (${retryCount}/${maxRetries})...`);\n            setTimeout(fetchData, 500 * retryCount);\n            return;\n          }\n          console.error('Error fetching person:', personError);\n          setIsLoading(false);\n          return;\n        }\n\n        const mappedPerson: Person = {\n          id: personData.id,\n          firstName: personData.first_name,\n          lastName: personData.last_name,\n          gender: personData.gender,\n          birthDate: personData.birth_date,\n          birthPlace: personData.birth_place,\n          deathDate: personData.death_date,\n          isLiving: personData.is_living,\n          biography: personData.biography,\n          photoUrl: personData.photo_url,\n          linkedUserId: personData.linked_user_id,\n        };\n        setPerson(mappedPerson);\n\n        // Fetch relatives (simplified - would need more complex queries for full relationship mapping)\n        const { data: unions } = await supabase\n          .from('unions')\n          .select('*, partner1:partner1_id(*), partner2:partner2_id(*)')\n          .or(`partner1_id.eq.${personId},partner2_id.eq.${personId}`);\n\n        if (unions && unions.length > 0) {\n          const union = unions[0];\n          const spouse = union.partner1_id === personId ? union.partner2 : union.partner1;\n          if (spouse) {\n            setRelatives(prev => ({\n              ...prev,\n              spouse: {\n                id: spouse.id,\n                firstName: spouse.first_name,\n                lastName: spouse.last_name,\n                gender: spouse.gender,\n                isLiving: spouse.is_living,\n              },\n            }));\n          }\n        }\n\n        // Fetch social accounts\n        const { data: accounts } = await supabase\n          .from('social_media_accounts')\n          .select('*')\n          .eq('person_id', personId)\n          .eq('is_active', true);\n\n        if (accounts) {\n          setSocialAccounts(accounts.map((a: any) => ({\n            id: a.id,\n            platform: a.platform,\n            username: a.username,\n            displayName: a.display_name,\n            profilePictureUrl: a.profile_picture_url,\n            isActive: a.is_active,\n          })));\n        }\n\n        // Fetch social posts\n        const { data: posts } = await supabase\n          .from('social_posts')\n          .select('*')\n          .eq('person_id', personId)\n          .order('posted_at', { ascending: false })\n          .limit(20);\n\n        if (posts) {\n          setSocialPosts(posts.map((p: any) => ({\n            id: p.id,\n            platform: p.account_id, // We'd need to join to get platform\n            postType: p.post_type,\n            content: p.content,\n            mediaUrls: p.media_urls || [],\n            thumbnailUrl: p.thumbnail_url,\n            permalink: p.permalink,\n            likesCount: p.likes_count,\n            commentsCount: p.comments_count,\n            postedAt: p.posted_at,\n          })));\n        }\n      } catch (err) {\n        console.error('Error:', err);\n      } finally {\n        setIsLoading(false);\n      }\n    }\n\n    fetchData();\n  }, [personId, supabase]);\n\n  // Initialize edit form when person data loads\n  useEffect(() => {\n    if (person) {\n      setEditForm({\n        firstName: person.firstName,\n        lastName: person.lastName || '',\n        gender: person.gender,\n        birthDate: person.birthDate || '',\n        birthPlace: person.birthPlace || '',\n        isLiving: person.isLiving,\n      });\n    }\n  }, [person]);\n\n  const handleOpenEdit = () => {\n    if (person) {\n      setEditForm({\n        firstName: person.firstName,\n        lastName: person.lastName || '',\n        gender: person.gender,\n        birthDate: person.birthDate || '',\n        birthPlace: person.birthPlace || '',\n        isLiving: person.isLiving,\n      });\n      setIsEditModalOpen(true);\n    }\n  };\n\n  const handleSaveEdit = async () => {\n    if (!person) return;\n    setIsSubmitting(true);\n    try {\n      const success = await updatePerson(person.id, {\n        firstName: editForm.firstName,\n        lastName: editForm.lastName || undefined,\n        gender: editForm.gender,\n        birthDate: editForm.birthDate || undefined,\n        isLiving: editForm.isLiving,\n      });\n      if (success) {\n        // Update local state\n        setPerson({\n          ...person,\n          firstName: editForm.firstName,\n          lastName: editForm.lastName,\n          gender: editForm.gender,\n          birthDate: editForm.birthDate,\n          isLiving: editForm.isLiving,\n        });\n        setIsEditModalOpen(false);\n      }\n    } catch (err) {\n      console.error('Error updating person:', err);\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n\n  const handleDelete = async () => {\n    if (!person) return;\n    setIsSubmitting(true);\n    try {\n      const success = await deletePerson(person.id);\n      if (success) {\n        router.push('/tree');\n      }\n    } catch (err) {\n      console.error('Error deleting person:', err);\n    } finally {\n      setIsSubmitting(false);\n      setIsDeleteDialogOpen(false);\n    }\n  };\n\n  const calculateAge = (birthDate: string) => {\n    const birth = new Date(birthDate);\n    const today = new Date();\n    let age = today.getFullYear() - birth.getFullYear();\n    const monthDiff = today.getMonth() - birth.getMonth();\n    if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < birth.getDate())) {\n      age--;\n    }\n    return age;\n  };\n\n  const handleConnectSocial = (platform: 'instagram' | 'facebook') => {\n    // Store personId in sessionStorage to link account after OAuth\n    sessionStorage.setItem('linkToPersonId', personId);\n    router.push(`/api/social/${platform}/connect`);\n  };\n\n  const handleSyncPosts = async (accountId: string) => {\n    setIsSyncing(true);\n    try {\n      const response = await fetch(`/api/social/sync?accountId=${accountId}`, {\n        method: 'POST',\n      });\n      const result = await response.json();\n\n      if (result.success) {\n        // Refresh posts\n        const { data: posts } = await supabase\n          .from('social_posts')\n          .select('*')\n          .eq('person_id', personId)\n          .order('posted_at', { ascending: false })\n          .limit(20);\n\n        if (posts) {\n          setSocialPosts(posts.map((p: any) => ({\n            id: p.id,\n            platform: p.account_id,\n            postType: p.post_type,\n            content: p.content,\n            mediaUrls: p.media_urls || [],\n            thumbnailUrl: p.thumbnail_url,\n            permalink: p.permalink,\n            likesCount: p.likes_count,\n            commentsCount: p.comments_count,\n            postedAt: p.posted_at,\n          })));\n        }\n      }\n    } catch (err) {\n      console.error('Sync error:', err);\n    } finally {\n      setIsSyncing(false);\n    }\n  };\n\n  if (isLoading) {\n    return (\n      <Container size=\"md\" padding={false}>\n        <div className=\"flex items-center gap-4 mb-6\">\n          <Skeleton width={40} height={40} />\n          <Skeleton width={200} height={32} />\n        </div>\n        <Skeleton height={200} className=\"mb-6\" />\n        <Skeleton height={300} />\n      </Container>\n    );\n  }\n\n  if (!person) {\n    return (\n      <Container size=\"md\" padding={false}>\n        <Card padding=\"lg\" className=\"text-center\">\n          <h2 className=\"text-xl font-semibold text-neutral-900 mb-2\">Persona no encontrada</h2>\n          <p className=\"text-neutral-500 mb-4\">No se pudo encontrar la persona solicitada.</p>\n          <Button onClick={() => router.push('/tree')}>Volver al rbol</Button>\n        </Card>\n      </Container>\n    );\n  }\n\n  return (\n    <Container size=\"md\" padding={false}>\n      <div className=\"flex items-center gap-4 mb-6\">\n        <Button variant=\"ghost\" size=\"sm\" onClick={() => router.back()}>\n          <ArrowLeftIcon className=\"w-5 h-5\" />\n        </Button>\n        <h1 className=\"text-2xl font-bold text-neutral-900\">Detalle de Persona</h1>\n      </div>\n\n      {/* Person Card */}\n      <Card className=\"mb-6\">\n        <CardContent className=\"p-6\">\n          <div className=\"flex flex-col md:flex-row gap-6\">\n            <div className=\"flex flex-col items-center\">\n              <Avatar\n                name={`${person.firstName} ${person.lastName || ''}`}\n                size=\"xl\"\n                src={person.photoUrl}\n              />\n              <div className=\"mt-3 flex gap-2\">\n                {person.isLiving ? (\n                  <Badge variant=\"success\">Vivo</Badge>\n                ) : (\n                  <Badge variant=\"secondary\">Fallecido</Badge>\n                )}\n                <Badge variant=\"secondary\">\n                  {person.gender === 'male' ? 'Hombre' : person.gender === 'female' ? 'Mujer' : 'Otro'}\n                </Badge>\n              </div>\n              {isOwner && (\n                <Badge variant=\"primary\" className=\"mt-2\">Tu perfil</Badge>\n              )}\n            </div>\n\n            <div className=\"flex-1 space-y-4\">\n              <div>\n                <h2 className=\"text-2xl font-bold text-neutral-900\">\n                  {person.firstName} {person.lastName || ''}\n                </h2>\n              </div>\n\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm\">\n                {person.birthDate && (\n                  <>\n                    <InfoItem label=\"Fecha de Nacimiento\" value={new Date(person.birthDate).toLocaleDateString('es')} />\n                    <InfoItem label=\"Edad\" value={`${calculateAge(person.birthDate)} aos`} />\n                  </>\n                )}\n                {person.birthPlace && (\n                  <InfoItem label=\"Lugar de Nacimiento\" value={person.birthPlace} />\n                )}\n              </div>\n\n              {person.biography && (\n                <p className=\"text-neutral-600 text-sm italic\">{person.biography}</p>\n              )}\n\n              <div className=\"flex gap-2\">\n                <Button size=\"sm\" onClick={handleOpenEdit}>Editar</Button>\n                <Button variant=\"outline\" size=\"sm\" onClick={() => router.push('/tree')}>\n                  Ver en rbol\n                </Button>\n                <Button variant=\"ghost\" size=\"sm\" onClick={() => setIsDeleteDialogOpen(true)} className=\"text-red-600 hover:text-red-700 hover:bg-red-50\">\n                  Eliminar\n                </Button>\n              </div>\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Tabs */}\n      <Tabs value={activeTab} onChange={setActiveTab}>\n        <TabList>\n          <TabTrigger value=\"info\">Informacin</TabTrigger>\n          <TabTrigger value=\"family\">Familia</TabTrigger>\n          <TabTrigger value=\"social\">\n            Redes Sociales\n            {socialAccounts.length > 0 && (\n              <span className=\"ml-1 px-1.5 py-0.5 text-xs bg-primary-100 text-primary-700 rounded-full\">\n                {socialAccounts.length}\n              </span>\n            )}\n          </TabTrigger>\n        </TabList>\n\n        <TabContent value=\"info\">\n          <Card>\n            <CardHeader>\n              <h3 className=\"font-semibold text-neutral-900\">Informacin Personal</h3>\n            </CardHeader>\n            <CardContent>\n              <div className=\"space-y-3\">\n                {person.birthDate && (\n                  <div className=\"flex items-center gap-3\">\n                    <CalendarIcon className=\"w-5 h-5 text-neutral-400\" />\n                    <span className=\"text-neutral-700\">\n                      Nacido el {new Date(person.birthDate).toLocaleDateString('es', {\n                        year: 'numeric',\n                        month: 'long',\n                        day: 'numeric',\n                      })}\n                    </span>\n                  </div>\n                )}\n                {person.birthPlace && (\n                  <div className=\"flex items-center gap-3\">\n                    <MapPinIcon className=\"w-5 h-5 text-neutral-400\" />\n                    <span className=\"text-neutral-700\">{person.birthPlace}</span>\n                  </div>\n                )}\n              </div>\n            </CardContent>\n          </Card>\n        </TabContent>\n\n        <TabContent value=\"family\">\n          <div className=\"space-y-4\">\n            {relatives.spouse && (\n              <Card>\n                <CardHeader>\n                  <h3 className=\"font-semibold text-neutral-900\">Cnyuge</h3>\n                </CardHeader>\n                <CardContent>\n                  <RelativeCard\n                    person={relatives.spouse}\n                    relationship=\"Esposo/a\"\n                    onClick={() => router.push(`/tree/${relatives.spouse!.id}`)}\n                  />\n                </CardContent>\n              </Card>\n            )}\n\n            {relatives.parents.length > 0 && (\n              <Card>\n                <CardHeader>\n                  <h3 className=\"font-semibold text-neutral-900\">Padres</h3>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"space-y-2\">\n                    {relatives.parents.map((parent) => (\n                      <RelativeCard\n                        key={parent.id}\n                        person={parent}\n                        relationship={parent.gender === 'male' ? 'Padre' : 'Madre'}\n                        onClick={() => router.push(`/tree/${parent.id}`)}\n                      />\n                    ))}\n                  </div>\n                </CardContent>\n              </Card>\n            )}\n\n            {relatives.children.length > 0 && (\n              <Card>\n                <CardHeader>\n                  <h3 className=\"font-semibold text-neutral-900\">Hijos</h3>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"space-y-2\">\n                    {relatives.children.map((child) => (\n                      <RelativeCard\n                        key={child.id}\n                        person={child}\n                        relationship={child.gender === 'male' ? 'Hijo' : 'Hija'}\n                        onClick={() => router.push(`/tree/${child.id}`)}\n                      />\n                    ))}\n                  </div>\n                </CardContent>\n              </Card>\n            )}\n          </div>\n        </TabContent>\n\n        <TabContent value=\"social\">\n          <div className=\"space-y-6\">\n            {/* Connected Accounts */}\n            <Card>\n              <CardHeader\n                title=\"Cuentas Conectadas\"\n                subtitle={isOwner ? 'Conecta tus redes sociales para compartir publicaciones' : 'Redes sociales vinculadas'}\n              />\n              <CardContent>\n                {socialAccounts.length === 0 ? (\n                  <div className=\"text-center py-6\">\n                    <SocialIcon className=\"w-12 h-12 text-neutral-300 mx-auto mb-3\" />\n                    <p className=\"text-neutral-500 mb-4\">\n                      {isOwner\n                        ? 'Conecta tus redes sociales para mostrar tus publicaciones en el rbol familiar'\n                        : 'Este familiar an no ha conectado sus redes sociales'}\n                    </p>\n                    {isOwner && (\n                      <div className=\"flex gap-2 justify-center\">\n                        <Button\n                          variant=\"outline\"\n                          size=\"sm\"\n                          onClick={() => handleConnectSocial('instagram')}\n                        >\n                          <InstagramIcon className=\"w-4 h-4 mr-2\" />\n                          Conectar Instagram\n                        </Button>\n                        <Button\n                          variant=\"outline\"\n                          size=\"sm\"\n                          onClick={() => handleConnectSocial('facebook')}\n                        >\n                          <FacebookIcon className=\"w-4 h-4 mr-2\" />\n                          Conectar Facebook\n                        </Button>\n                      </div>\n                    )}\n                  </div>\n                ) : (\n                  <div className=\"space-y-3\">\n                    {socialAccounts.map((account) => (\n                      <div\n                        key={account.id}\n                        className=\"flex items-center justify-between p-3 rounded-xl border border-neutral-200\"\n                      >\n                        <div className=\"flex items-center gap-3\">\n                          {account.platform === 'instagram' ? (\n                            <div className=\"w-10 h-10 rounded-full bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center\">\n                              <InstagramIcon className=\"w-5 h-5 text-white\" />\n                            </div>\n                          ) : (\n                            <div className=\"w-10 h-10 rounded-full bg-blue-600 flex items-center justify-center\">\n                              <FacebookIcon className=\"w-5 h-5 text-white\" />\n                            </div>\n                          )}\n                          <div>\n                            <p className=\"font-medium text-neutral-900\">\n                              {account.displayName || account.username}\n                            </p>\n                            <p className=\"text-sm text-neutral-500\">@{account.username}</p>\n                          </div>\n                        </div>\n                        {isOwner && (\n                          <Button\n                            variant=\"ghost\"\n                            size=\"sm\"\n                            onClick={() => handleSyncPosts(account.id)}\n                            loading={isSyncing}\n                          >\n                            <RefreshIcon className=\"w-4 h-4 mr-1\" />\n                            Sincronizar\n                          </Button>\n                        )}\n                      </div>\n                    ))}\n\n                    {isOwner && (\n                      <div className=\"flex gap-2 pt-2\">\n                        {!socialAccounts.find(a => a.platform === 'instagram') && (\n                          <Button\n                            variant=\"outline\"\n                            size=\"sm\"\n                            onClick={() => handleConnectSocial('instagram')}\n                          >\n                            <InstagramIcon className=\"w-4 h-4 mr-2\" />\n                            Agregar Instagram\n                          </Button>\n                        )}\n                        {!socialAccounts.find(a => a.platform === 'facebook') && (\n                          <Button\n                            variant=\"outline\"\n                            size=\"sm\"\n                            onClick={() => handleConnectSocial('facebook')}\n                          >\n                            <FacebookIcon className=\"w-4 h-4 mr-2\" />\n                            Agregar Facebook\n                          </Button>\n                        )}\n                      </div>\n                    )}\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n\n            {/* Recent Posts */}\n            {socialPosts.length > 0 && (\n              <Card>\n                <CardHeader title=\"Publicaciones Recientes\" />\n                <CardContent>\n                  <div className=\"grid grid-cols-2 md:grid-cols-3 gap-3\">\n                    {socialPosts.map((post) => (\n                      <a\n                        key={post.id}\n                        href={post.permalink || '#'}\n                        target=\"_blank\"\n                        rel=\"noopener noreferrer\"\n                        className=\"block aspect-square rounded-xl overflow-hidden bg-neutral-100 hover:opacity-90 transition-opacity relative group\"\n                      >\n                        {post.thumbnailUrl || (post.mediaUrls && post.mediaUrls[0]) ? (\n                          <img\n                            src={post.thumbnailUrl || post.mediaUrls[0]}\n                            alt={post.content?.slice(0, 50) || 'Post'}\n                            className=\"w-full h-full object-cover\"\n                          />\n                        ) : (\n                          <div className=\"w-full h-full flex items-center justify-center p-3\">\n                            <p className=\"text-xs text-neutral-500 line-clamp-4\">{post.content}</p>\n                          </div>\n                        )}\n                        <div className=\"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center gap-4 text-white text-sm\">\n                          <span className=\"flex items-center gap-1\">\n                            <HeartIcon className=\"w-4 h-4\" />\n                            {post.likesCount}\n                          </span>\n                          <span className=\"flex items-center gap-1\">\n                            <CommentIcon className=\"w-4 h-4\" />\n                            {post.commentsCount}\n                          </span>\n                        </div>\n                      </a>\n                    ))}\n                  </div>\n                </CardContent>\n              </Card>\n            )}\n          </div>\n        </TabContent>\n      </Tabs>\n\n      {/* Edit Modal */}\n      <Dialog open={isEditModalOpen} onClose={() => setIsEditModalOpen(false)}>\n        <DialogHeader title=\"Editar Persona\" onClose={() => setIsEditModalOpen(false)} />\n        <DialogContent>\n          <div className=\"space-y-4\">\n            <div className=\"grid grid-cols-2 gap-3\">\n              <Input\n                label=\"Nombre\"\n                value={editForm.firstName}\n                onChange={(e) => setEditForm({ ...editForm, firstName: e.target.value })}\n                required\n                fullWidth\n              />\n              <Input\n                label=\"Apellido\"\n                value={editForm.lastName}\n                onChange={(e) => setEditForm({ ...editForm, lastName: e.target.value })}\n                fullWidth\n              />\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-medium text-neutral-700 mb-1.5\">\n                Gnero\n              </label>\n              <select\n                value={editForm.gender}\n                onChange={(e) => setEditForm({ ...editForm, gender: e.target.value as Gender })}\n                className=\"w-full px-4 py-2.5 rounded-xl border border-neutral-200 bg-white text-neutral-900 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all\"\n              >\n                <option value=\"male\">Masculino</option>\n                <option value=\"female\">Femenino</option>\n                <option value=\"other\">Otro</option>\n              </select>\n            </div>\n\n            <Input\n              label=\"Fecha de nacimiento\"\n              type=\"date\"\n              value={editForm.birthDate}\n              onChange={(e) => setEditForm({ ...editForm, birthDate: e.target.value })}\n              fullWidth\n            />\n\n            <label className=\"flex items-center gap-2 cursor-pointer\">\n              <input\n                type=\"checkbox\"\n                checked={editForm.isLiving}\n                onChange={(e) => setEditForm({ ...editForm, isLiving: e.target.checked })}\n                className=\"w-4 h-4 rounded border-neutral-300 text-primary-600 focus:ring-primary-500\"\n              />\n              <span className=\"text-sm text-neutral-700\">Persona viva</span>\n            </label>\n\n            <div className=\"flex gap-3 pt-4\">\n              <Button\n                variant=\"outline\"\n                fullWidth\n                onClick={() => setIsEditModalOpen(false)}\n                disabled={isSubmitting}\n              >\n                Cancelar\n              </Button>\n              <Button\n                fullWidth\n                onClick={handleSaveEdit}\n                loading={isSubmitting}\n                disabled={!editForm.firstName.trim()}\n              >\n                Guardar\n              </Button>\n            </div>\n          </div>\n        </DialogContent>\n      </Dialog>\n\n      {/* Delete Confirmation Dialog */}\n      <Dialog open={isDeleteDialogOpen} onClose={() => setIsDeleteDialogOpen(false)}>\n        <DialogHeader title=\"Eliminar Persona\" onClose={() => setIsDeleteDialogOpen(false)} />\n        <DialogContent>\n          <div className=\"space-y-4\">\n            <p className=\"text-neutral-600\">\n              Ests seguro de que deseas eliminar a <strong>{person?.firstName} {person?.lastName}</strong>?\n              Esta accin no se puede deshacer.\n            </p>\n            <div className=\"flex gap-3 pt-2\">\n              <Button\n                variant=\"outline\"\n                fullWidth\n                onClick={() => setIsDeleteDialogOpen(false)}\n                disabled={isSubmitting}\n              >\n                Cancelar\n              </Button>\n              <Button\n                fullWidth\n                onClick={handleDelete}\n                loading={isSubmitting}\n                className=\"bg-red-600 hover:bg-red-700 text-white\"\n              >\n                Eliminar\n              </Button>\n            </div>\n          </div>\n        </DialogContent>\n      </Dialog>\n    </Container>\n  );\n}\n\nfunction InfoItem({ label, value }: { label: string; value: string }) {\n  return (\n    <div>\n      <p className=\"text-neutral-500 text-xs uppercase tracking-wide\">{label}</p>\n      <p className=\"text-neutral-900 font-medium\">{value}</p>\n    </div>\n  );\n}\n\nfunction RelativeCard({\n  person,\n  relationship,\n  onClick,\n}: {\n  person: Person;\n  relationship: string;\n  onClick: () => void;\n}) {\n  return (\n    <button\n      onClick={onClick}\n      className=\"w-full flex items-center gap-3 p-3 rounded-xl hover:bg-neutral-50 transition-colors text-left\"\n    >\n      <Avatar name={`${person.firstName} ${person.lastName || ''}`} size=\"md\" />\n      <div className=\"flex-1\">\n        <p className=\"font-medium text-neutral-900\">\n          {person.firstName} {person.lastName || ''}\n        </p>\n        <p className=\"text-sm text-neutral-500\">{relationship}</p>\n      </div>\n    </button>\n  );\n}\n\n// Icons\nfunction ArrowLeftIcon({ className }: { className?: string }) {\n  return (\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n      <path d=\"M19 12H5M12 19l-7-7 7-7\" />\n    </svg>\n  );\n}\n\nfunction CalendarIcon({ className }: { className?: string }) {\n  return (\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n      <rect x=\"3\" y=\"4\" width=\"18\" height=\"18\" rx=\"2\" />\n      <path d=\"M16 2v4M8 2v4M3 10h18\" />\n    </svg>\n  );\n}\n\nfunction MapPinIcon({ className }: { className?: string }) {\n  return (\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n      <path d=\"M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 1118 0z\" />\n      <circle cx=\"12\" cy=\"10\" r=\"3\" />\n    </svg>\n  );\n}\n\nfunction SocialIcon({ className }: { className?: string }) {\n  return (\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n      <path d=\"M18 2h-3a5 5 0 00-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 011-1h3z\" />\n    </svg>\n  );\n}\n\nfunction InstagramIcon({ className }: { className?: string }) {\n  return (\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n      <rect x=\"2\" y=\"2\" width=\"20\" height=\"20\" rx=\"5\" />\n      <circle cx=\"12\" cy=\"12\" r=\"4\" />\n      <circle cx=\"18\" cy=\"6\" r=\"1\" fill=\"currentColor\" />\n    </svg>\n  );\n}\n\nfunction FacebookIcon({ className }: { className?: string }) {\n  return (\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n      <path d=\"M18 2h-3a5 5 0 00-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 011-1h3z\" />\n    </svg>\n  );\n}\n\nfunction RefreshIcon({ className }: { className?: string }) {\n  return (\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n      <path d=\"M23 4v6h-6M1 20v-6h6\" />\n      <path d=\"M3.51 9a9 9 0 0114.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0020.49 15\" />\n    </svg>\n  );\n}\n\nfunction HeartIcon({ className }: { className?: string }) {\n  return (\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"currentColor\">\n      <path d=\"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z\" />\n    </svg>\n  );\n}\n\nfunction CommentIcon({ className }: { className?: string }) {\n  return (\n    <svg className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n      <path d=\"M21 15a2 2 0 01-2 2H7l-4 4V5a2 2 0 012-2h14a2 2 0 012 2z\" />\n    </svg>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}